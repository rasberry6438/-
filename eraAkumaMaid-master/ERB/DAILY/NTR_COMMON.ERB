@TEST_NTR
	#DIM LCOUNT
	#DIM NEXT_LINE
	#DIM CHOICE
	PRINTFORML 用于测试路人受精
	PRINTFORML 选择授精对象
	STR:選択肢 = 
	STR:選択肢 += "[1]便利店店员/[2]公园厕所中不认识的男人/[3]公园露出中只有一面之缘的男人/[4]教会的孩子/"
	STR:選択肢 += "[5]学校的老师/[6]不认识的同学/[7]高年级的学长/[8]体育课的助教/[9]生理课老师/[10]做爱部的大叔/[11]做爱部的部员/"

	
	CALL SELECT_BAN
		VARSET LOCALS
		SPLIT STR:選択肢, "/", LOCALS
		NEXT_LINE = 0
		FOR LCOUNT, 0, 100
			;まずは色だけチェック
			SELECTCASE LOCALS:LCOUNT
			CASE "灰色", "水色", "爱心粉紅", "青", "緑", "緑色", "黄色"
				;すでに指定色になっている場合は色変換を止める
				IF GETCOLOR() != DEF_COLOR(LOCALS:LCOUNT)
					SETCOLOR DEF_COLOR(LOCALS:LCOUNT)
					CONTINUE
				ENDIF
			ENDSELECT

			SELECTCASE LOCALS:LCOUNT
			CASE ""
				BREAK
			CASE "太字"
				FONTSTYLE 1
				CONTINUE
			CASE "改行"
				SIF NEXT_LINE%5
					PRINTL 
				NEXT_LINE = 0
				CONTINUE
			CASE "DRAWLINE"
				IF NEXT_LINE%5
					NEXT_LINE = 0
					PRINTL 
				ENDIF
				DRAWLINE
				CONTINUE
			ENDSELECT

			;太字にした？
			IF GETBIT(GETSTYLE(), 0)
				SELECTCASE LOCALS:LCOUNT
				CASE "NOBUTTON"
					PRINTPLAINFORM %TEXT_LJ("", 21)%
				CASEELSE
					PRINTFORM %TEXT_LJ(LOCALS:LCOUNT, 21)%
				ENDSELECT
			ELSE
				SELECTCASE LOCALS:LCOUNT
				CASE "NOBUTTON"
					PRINTPLAINFORM %TEXT_LJ("", 24)%
				CASEELSE
					PRINTFORM %TEXT_LJ(LOCALS:LCOUNT, 24)%
				ENDSELECT
			ENDIF
			FONTREGULAR
			RESETCOLOR

			NEXT_LINE += 1
			SIF NEXT_LINE%5 == 0
				PRINTL 
		NEXT
	INPUT
	CHOICE = RESULT
	;PRINTFORM {CHOICE}
	SELECTCASE CHOICE	
		CASE 1
			CALL NTR_NINISHIN, TARGET, "便利店店员"
		CASE 2
			CALL NTR_NINISHIN, TARGET, "公园厕所中不认识的男人"
		CASE 3
			CALL NTR_NINISHIN, TARGET, "公园露出中只有一面之缘的男人"
		CASE 4
			CALL NTR_NINISHIN, TARGET, "教会的孩子"
		CASE 5
			CALL NTR_NINISHIN, TARGET, "学校的老师"
		CASE 6
			CALL NTR_NINISHIN, TARGET, "不认识的同学"
		CASE 7
			CALL NTR_NINISHIN, TARGET, "高年级的学长"
		CASE 8
			CALL NTR_NINISHIN, TARGET, "体育课的助教"
		CASE 9
			CALL NTR_NINISHIN, TARGET, "生理课老师"
		CASE 10
			CALL NTR_NINISHIN, TARGET, "做爱部的大叔"
		CASE 11
			CALL NTR_NINISHIN, TARGET, "做爱部的部员"
	ENDSELECT

@NTR_NINISHIN, ARG, ARGS
	#DIM NUM
	;PRINTFORML %ARGS%
	NUM = 500 + RAND:100
	CALL CHECK_PREGNANT, ARG,NUM,ARGS,
	CALL CHECK_NINSHIN, ARG

@NTR_TRAIN_TEST
	CALL NTR_TRAIN, TARGET

@NTR_TRAIN, ARG
	#DIM LCOUNT
	VARSET LOCALS
	SPLIT NTR_TRAIN_TABLE(), "/", LOCALS
	FOR LCOUNT, 0, 5
		SELECTCASE LOCALS:LCOUNT	
			CASE "拥抱"
				PRINTFORMW 这里是拥抱口上
				PRINTFORMW 这里是拥抱经验增加
			CASE "爱抚"
				PRINTFORMW 这里是爱抚口上
				PRINTFORMW 这里是爱抚经验增加
			CASE "亲吻"
				PRINTFORMW 这里是亲吻口上
				PRINTFORMW 这里是爱抚经验增加
			CASE "侍奉"
				PRINTFORMW 这里是侍奉口上
				PRINTFORMW 这里是侍奉经验增加
			CASE "性交"
				PRINTFORMW 这里是性交口上
				PRINTFORMW 这里是性交经验增加
		ENDSELECT
	NEXT
	PRINTFORMW 
	PRINTFORMW 结束

@NTR_TRAIN_TABLE()
	#FUNCTIONS
	#DIM LCOUNT
	#DIMS NTR_TABLE
	;拥抱/爱抚/亲吻/侍奉/性交
	NTR_TABLE = 爱抚/
	SIF !CEVENT("做爱部成员",TARGET)
		RETURNF NTR_TABLE
	FOR LCOUNT, 1, 5
		SELECTCASE CFLAG:TARGET:做爱部部员等级
			CASE 1
			CASE 2
				IF RAND:5 < 2
					NTR_TABLE += "爱抚/"
					CONTINUE
				ENDIF
				IF RAND:3 < 2
					NTR_TABLE += "亲吻/"
					CONTINUE
				ENDIF
				NTR_TABLE += "拥抱/"
			CASE 3
				IF RAND:3 == 0
					NTR_TABLE += "侍奉/"
					CONTINUE
				ENDIF
				IF RAND:5 < 2
					NTR_TABLE += "爱抚/"
					CONTINUE
				ENDIF
				IF RAND:3 < 2
					NTR_TABLE += "亲吻/"
					CONTINUE
				ENDIF
				NTR_TABLE += "拥抱/"
			CASE 4
				IF RAND:3 == 0
					NTR_TABLE += "性交/"
					CONTINUE
				ENDIF
				IF RAND:2 == 0
					NTR_TABLE += "侍奉/"
					CONTINUE
				ENDIF
				IF RAND:5 < 2
					NTR_TABLE += "爱抚/"
					CONTINUE
				ENDIF
				IF RAND:3 < 2
					NTR_TABLE += "亲吻/"
					CONTINUE
				ENDIF
				NTR_TABLE += "拥抱/"
		ENDSELECT
	NEXT
	RETURNF NTR_TABLE

; NTRS_SYSTEM经验统计与打印
@NTRS_EXP_SUMMARY(ARG:0)
#DIM EXP_VALUE

PRINTFORML
DRAWLINE
PRINTFORML
PRINTFORML
PRINTFORML
PRINTFORML
PRINTFORML
PRINTFORML [%CALLNAME:TARGET%]
A = 0	;精液经验
IF CEVENT("NTRS_露出")
	CALL GET_EXP(ARG:0)
	EXP_VALUE = RESULT:0
	EXP:露出経験 += EXP_VALUE
	PRINTFORML 露出経験 +{EXP_VALUE}
	IF RAND:2 == 0
		CALL GET_EXP(ARG:0)
		EXP_VALUE = RESULT:0
		EXP:羞恥快楽経験 += EXP_VALUE
		PRINTFORML 羞恥快楽経験 +{EXP_VALUE}
	ENDIF
ENDIF
IF CEVENT("NTRS_接吻")
	CALL GET_EXP(ARG:0)
	EXP_VALUE = (RESULT:0)/3
	EXP:接吻経験 += EXP_VALUE
	PRINTFORML 接吻経験 +{EXP_VALUE}
ENDIF
IF CEVENT("NTRS_口交")
	CALL GET_EXP(ARG:0)
	EXP_VALUE = RESULT:0
	EXP:口交経験 += EXP_VALUE
	PRINTFORML 口交経験 +{EXP_VALUE}
	A += RAND:2
ENDIF
IF CEVENT("NTRS_乳交")
	CALL GET_EXP(ARG:0)
	EXP_VALUE = RESULT:0
	EXP:乳交経験 += EXP_VALUE
	PRINTFORML 乳交経験 +{EXP_VALUE}
	A += RAND:2
ENDIF
IF CEVENT("NTRS_性交")
	CALL GET_EXP(ARG:0)
	EXP_VALUE = RESULT:0
	EXP:Ｖ性交経験 += EXP_VALUE
	PRINTFORML Ｖ性交経験 +{EXP_VALUE}
	A += RAND:2
ENDIF
IF CEVENT("NTRS_肛交")
	CALL GET_EXP(ARG:0)
	EXP_VALUE = RESULT:0
	EXP:Ａ性交経験 += EXP_VALUE
	PRINTFORML Ａ性交経験 +{EXP_VALUE}
	A += RAND:2
ENDIF
IF CEVENT("NTRS_绝顶")
	CALL GET_EXP(ARG:0)
	EXP_VALUE = RESULT:0
	EXP:絶頂経験 += EXP_VALUE
	PRINTFORML 絶頂経験 +{EXP_VALUE}
ENDIF
IF CEVENT("NTRS_精飲")
	CALL GET_EXP(ARG:0)
	EXP_VALUE = RESULT:0
	EXP:精飲経験 += EXP_VALUE
	PRINTFORML 精飲経験 +{EXP_VALUE}
	A += 1
ENDIF
IF CEVENT("NTRS_爱抚")
	CALL GET_EXP(ARG:0)
	EXP_VALUE = RESULT:0
	PRINTFORML 爱抚経験 +{EXP_VALUE}
ENDIF
IF CEVENT("NTRS_精液接触")
	CALL GET_EXP(ARG:0)
	EXP_VALUE = RESULT:0
	PRINTFORML 精液接触経験 +{EXP_VALUE}
	A += 1
ENDIF
IF A > 0
	CALL GET_EXP(ARG:0)
	EXP_VALUE = RESULT:0
	EXP:精液経験 += A
	PRINTFORML 精液経験 +{A}
ENDIF
CALL DEL_CEVENT, "NTRS_发生"
CALL DEL_CEVENT, "NTRS_接吻"
CALL DEL_CEVENT, "NTRS_口交"
CALL DEL_CEVENT, "NTRS_乳交"
CALL DEL_CEVENT, "NTRS_性交"
CALL DEL_CEVENT, "NTRS_肛交"
CALL DEL_CEVENT, "NTRS_绝顶"
CALL DEL_CEVENT, "NTRS_精飲"
CALL DEL_CEVENT, "NTRS_露出"
CALL DEL_CEVENT, "NTRS_爱抚"
CALL DEL_CEVENT, "NTRS_精液接触"
PRINTFORMW 

@GET_EXP(ARG:0)
#DIM BASE_EXP
#DIM ABL_LV
#DIM GUST_SKILL
#DIM RESULT_EXP

ABL_LV = 1
BASE_EXP = 1
GUST_SKILL = ARG:0
SIF GUST_SKILL == 0
	GUST_SKILL = 1
IF TALENT:淫乱
	BASE_EXP += 3+RAND:3
	ABL_LV += 1
ENDIF
IF MARK:淫紋
	BASE_EXP += 5+RAND:3
	ABL_LV += 1
ENDIF
IF TALENT:淫壷
	BASE_EXP += 2+RAND:3
	ABL_LV += 1
ENDIF
RESULT_EXP = BASE_EXP + ABL_LV*(GUST_SKILL + 2+RAND:4)
RESULT:0 = RESULT_EXP
RETURN RESULT

@KISS_VOICE,ARG:0
#DIM LOOP_NUM
#DIM LCOUNT
#DIM RAND_BEFORE
#DIM RAND_NOW

RAND_BEFORE = 0 
PRINTFORML
PRINTFORML
LOOP_NUM = ARG:0
FOR LCOUNT, 0, LOOP_NUM
	RAND_NOW = RAND:20
	WHILE (RAND_BEFORE == RAND_NOW)
		RAND_NOW = RAND:20
	WEND
	RAND_BEFORE = RAND_NOW
	IF RAND_NOW == 0
		CALL PRINT_STRW, @"「嗯~啾——啾噜~嗯噗 _HH_　」"
	ELSEIF RAND_NOW == 1
		CALL PRINT_STRW, @"「啾_HH_　嗯……啾嗚、啾_HH_嗯！！—— _HH_」"
	ELSEIF RAND_NOW == 2
		CALL PRINT_STRW, @"「嗯_HH_　哈……嗯嗚 _HH_　」"
	ELSEIF RAND_NOW == 3
		CALL PRINT_STRW, @"「啾啵、啾、咧捋~」"
	ELSEIF RAND_NOW == 4
		CALL PRINT_STRW, @"「嗯呜!?  嗯啾~~啾~」"
	ELSEIF RAND_NOW == 5
		CALL PRINT_STRW, @"「嗯_HH_、啾芙……啾噜、啾卜啾卜~_HH_」"
	ELSEIF RAND_NOW == 6
		CALL PRINT_STRW, @"「嗯_HH_、啾噜~~，啾噜_HH_」"
	ELSEIF RAND_NOW == 7
		CALL PRINT_STRW, @"「唔呣~啊_HH_、唔呣、嗯呜~~」"
	ELSEIF RAND_NOW == 8
		CALL PRINT_STRW, @"「咕噜~~、噗_HH_、咕噜~~、噗呣~~」"
	ELSEIF RAND_NOW == 9
		CALL PRINT_STRW, @"「啊_HH_、嗯~~、啊~~、啾~~、啊~~、嗯_HH_」"
	ELSEIF RAND_NOW == 10
		CALL PRINT_STRW, @"「呜_HH_、啊~~、嗯~~、呜呣~~、啊~~、嗯呜~~」"
	ELSEIF RAND_NOW == 11
		CALL PRINT_STRW, @"「嗯唔……嗯呣」"
	ELSEIF RAND_NOW == 12
		CALL PRINT_STRW, @"「啾_HH_　嗯……啾咕、啾_HH_　」"
	ELSEIF RAND_NOW == 13
		CALL PRINT_STRW, @"「嗯_HH_　哈……嗯咕 _HH_」"
	ELSEIF RAND_NOW == 14
		CALL PRINT_STRW, @"「啾啵、啾_HH_、咧捋~~」"
	ELSEIF RAND_NOW == 15
		CALL PRINT_STRW, @"「嗯呜!? 嗯啾~~嗯~」"
	ELSEIF RAND_NOW == 16
		CALL PRINT_STRW, @"「嗯_HH_、啾芙……啾噜、啾卜啾卜~_HH_」"
	ELSEIF RAND_NOW == 17
		CALL PRINT_STRW, @"「唔……唔啊~」"
	ELSEIF RAND_NOW == 18
		CALL PRINT_STRW, @"「嗯呣呣~　唔呣_HH_……」"
	ELSEIF RAND_NOW == 19
		CALL PRINT_STRW, @"「啾_HH_——啾，嗯啾——」"
	ELSE
		CALL PRINT_STRW, @"「嗯唔、嗯呣_HH_……嗯呜……」"
	ENDIF
NEXT
PRINTFORML
PRINTFORML

@GENBU_DECRIPTION,ARG:0
#FUNCTIONS
#DIM SIZE ;大小	( 0: 短小, 1: 普通, 2: 巨根, 3: 馬根, 4: 腕粗, 5: 规格外 )
#DIMS TEXT_0
SIZE = ARG:0
LOCALS = ""
IF SIZE == 0
	LOCALS = %TEXTR("未成熟/小孩子般")%的
ELSEIF SIZE == 1
	LOCALS = %TEXTR("优秀/立派/看起来很美味")%的
ELSEIF SIZE == 2
	LOCALS = %TEXTR("凶猛/特别长度/格外粗壮")%的
ELSE
	LOCALS = %TEXTR("硕大/如同馬根一般/惊人尺寸")%的
ENDIF
TEXT_0 = %TEXTR("肉棒/阴茎/鸡巴")%
LOCALS += TEXT_0
RETURNF LOCALS




	;-------TEST--------
;@ADD_COUNTCEVENT(ARGS, ARG)
;	#DIM LCOUNT
;	#DIMS TEMP
;	SIF ARG <= 0
;		ARG = TARGET
;	LCOUNT = 1
;	;有CEVENT(ARGS), 说明不是计数 1
;	IF CEVENT(ARGS, ARG)
;		PRINTFORMW IF
;		$LOOP_BEGIN
;			IF CEVENT(TEMP, ARG)
;				PRINTFORMW IF
;				;
;				TEMP = %ARGS%{LCOUNT}
;				PRINTFORMW %TEMP%x
;				CALL DEL_CEVENT(TEMP, ARG;)
;				SIF CEVENT(TEMP, ARG)
;					PRINTFORMW 未删除
;				;PRINTFORMW {LCOUNT}
;				LCOUNT = LCOUNT + 1
;				;PRINTFORMW {LCOUNT}
;				TEMP = %ARGS%{LCOUNT}
;				PRINTFORMW %TEMP%
;				CALL SET_CEVENT(TEMP, ARG)
;				SIF CEVENT(TEMP, ARG)
;					PRINTFORMW 添加
;			ELSE
;				PRINTFORMW ELSE
;				LCOUNT += 1
;				TEMP = %ARGS%{LCOUNT}
;				PRINTFORMW {LCOUNT}
;				GOTO LOOP_BEGIN
;			ENDIF
;	;说明是计数 1
;	ELSE
;		PRINTFORMW ELSE
;		CALL SET_CEVENT(ARGS, ARG)
;		TEMP = %ARGS%1
;		CALL SET_CEVENT(TEMP, ARG)
;	ENDIF
;	PRINTFORMW %TEMP%
;
;@SUB_COUNTCEVENT(ARGS, ARG)
;	#DIM LCOUNT
;	#DIMS TEMP
;	LCOUNT = 1
;	SIF ARG <= 0
;		ARG = TARGET
;	; 说明不是计数 0
;	IF CEVENT(ARGS, ARG)
;		$LOOP_BEGIN
;		TEMP = %ARGS%{LCOUNT}
;		;此时说明计数 1, 减少到0
;		IF CEVENT(TEMP, ARG) && LCOUNT == 1
;			CALL DEL_CEVENT(TEMP, ARG)
;			CALL DEL_CEVENT(ARGS, ARG)
;		;此时不是计数 1, 减少1
;		ELSEIF CEVENT(TEMP, ARG)
;			CALL DEL_CEVENT(TEMP, ARG)
;			LCOUNT -= 1
;			TEMP = %ARGS%{LCOUNT}
;			CALL SET_CEVENT(TEMP, ARG)
;		ELSE
;			LCOUNT += 1
;			GOTO LOOP_BEGIN
;		ENDIF
;	; 说明计数 0
;	ELSE
;	ENDIF
;	PRINTFORMW %TEMP%
;
;@COUNTCEVENT(ARGS, ARG)
;	#FUNCTION
;	#DIM LCOUNT
;	#DIMS TEMP
;	LCOUNT = 1
;	SIF ARG <= 0
;		ARG = TARGET
;	;说明计数不为0
;	IF CEVENT(ARGS, ARG)
;		$LOOP_BEGIN
;		TEMP = %ARGS%{LCOUNT}
;		IF CEVENT(TEMP, ARG)
;			RETURNF LCOUNT
;		ELSE
;			LCOUNT += 1
;			GOTO LOOP_BEGIN
;		ENDIF
;	;说明计数为0
;	ELSE
;		RETURNF 0
;	ENDIF


;@TEST_ADD
;	CALL ADD_COUNTCEVENT("测试countcevent", TARGET)
;
;@TEST_SUB
;	CALL SUB_COUNTCEVENT("测试countcevent", TARGET)
;
;@TEST_COUNT
;	#DIM TEMP
;	TEMP = COUNTCEVENT("测试countcevent", TARGET)
;	PRINTFORMW %TEMP%