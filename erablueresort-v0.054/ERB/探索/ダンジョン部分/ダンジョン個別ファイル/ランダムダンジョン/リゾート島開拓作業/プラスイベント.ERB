
@イベント_リゾート島開拓作業_ランダム_旅の僧侶
#DIM 回復量

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 周围没有异常状况。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%一行正在探索时，遇见了接受岛屿开拓委托的空骑士。
	WSTR:(K++) = 这名空骑士本职是僧侣，似乎是通过接受委托赚取旅费边工作边旅行。
	KSTR:(K++) = 僧侣善意施展了回复魔法，治愈了你们的伤势！
	;HPバーの表示タイミングを調整するためここで一旦メッセージ表示
	CALL メッセージ欄表示用関数()
	CALL 口上変数初期化
	
	回復量 = ダンジョン階層記録 * 50
	WSTR:(K++) = 全体成员的ＨＰ恢复了{回復量, 4}！
	CALL 探索中全体回復_ＨＰ(回復量)
	WSTR:(K++) = %CALLNAME:MASTER%一行向僧侣道谢后，继续投入探索。
	CALL メッセージ欄表示用関数(,,,0)
	
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_修行中の格闘家
#DIMS 素材名

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 周围没有异常状况。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%一行正在探索时，遇见了接受岛屿开拓委托的空骑士。
	WSTR:(K++) = 这名空骑士是格斗家，似乎为了锻炼体魄而承接各种委托。
	KSTR:(K++) = 格斗家嫌猎物太多影响行动，便把多余的魔物素材分给了%CALLNAME:MASTER%一行！_PAGE

	素材名 = %ランダム素材名("怪物素材", RAND(1, 2))%
	WSTR:(K++) = 获得了３个%素材名%！
	WSTR:(K++) = %CALLNAME:MASTER%一行向格斗家道谢后，继续投入探索。
	CALL 素材入手処理(素材名, 3)
	CALL メッセージ欄表示用関数(,,,0)
	
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_見習い戦士
#DIM 経験値量
#DIM レベルアップフラグ

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 周围没有异常状况。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%一行正在探索时，遇见了接受岛屿开拓委托的空骑士。
	WSTR:(K++) = 这名空骑士是见习战士，似乎想通过与魔物战斗来变强。
	WSTR:(K++) = 举手投足间尽显青涩，动作处处显得生涩笨拙……
	KSTR:(K++) = %CALLNAME:MASTER%一行对见习战士进行了战术指导和简单特训。_PAGE

	経験値量 = ダンジョン階層記録 * 100
	WSTR:(K++) = 见习战士欣喜地向%CALLNAME:MASTER%一行道谢后，重新投入探索。
	WSTR:(K++) = %CALLNAME:MASTER%一行通过传授战斗心得，获得了{経験値量, 4}点经验值！
	
	レベルアップフラグ = 0
	FOR LOCAL, 0, 14
		SIF LOCAL > 3 && LOCAL < 10
			CONTINUE
		SIF BATTLE_STATE:LOCAL:キャラ登録番号 < 1
			CONTINUE
		基礎BATTLE_STATE:(BATTLE_STATE:LOCAL:キャラ登録番号):蓄積EXP += 経験値量
		CALL レベルアップ処理(BATTLE_STATE:LOCAL:キャラ登録番号)
		SIF レベルアップフラグ < RESULT
			レベルアップフラグ = RESULT
	NEXT
	IF レベルアップフラグ
		;ステータス代入
		CALL 戦闘初期処理_味方
	ENDIF

	CALL メッセージ欄表示用関数(,,,0)
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_ベテラン吟遊詩人

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 周围没有异常状况。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%一行正在探索时，遇见了接受岛屿开拓委托的空骑士。
	WSTR:(K++) = 这名空骑士是资深吟游诗人，据说为了收集创作素材而兼职空骑士。
	WSTR:(K++) = 诗人说相逢即是缘，当场为你们弹唱了一首原创曲目。
	WNSTR:(K++) = …………
	KSTR:(K++) = 美妙的歌声！%CALLNAME:MASTER%一行体内涌动着澎湃活力！

	;HPバーの表示タイミングを調整するためここで一旦メッセージ表示
	CALL メッセージ欄表示用関数()
	CALL 口上変数初期化
	
	WSTR:(K++) = 全体成员的奥义槽增加了３０％！
	CALL 探索中全体回復_奥義ゲージ(30)
	WSTR:(K++) = %CALLNAME:MASTER%一行向吟游诗人道谢后，继续投入探索。
	CALL メッセージ欄表示用関数(,,,0)
	
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_さすらいの料理人

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 周围没有异常状况。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%一行正在探索时，遇见了接受岛屿开拓委托的空骑士。
	WSTR:(K++) = 这名空骑士是流浪厨师，似乎为了寻求新菜谱而从事空骑士工作。
	KSTR:(K++) = 厨师表示机会难得，便将料理配方传授给了%CALLNAME:MASTER%一行！_PAGE

	CALL レシピランダム取得処理()
	IF RESULT == -1
		;レシピ全部知ってる場合
		WSTR:(K++) = 然而，%CALLNAME:MASTER%一行似乎早已掌握所有配方……
	ELSE
		WSTR:(K++) = 获得了%RESULTS%的配方！
	ENDIF
	WSTR:(K++) = %CALLNAME:MASTER%一行向厨师道谢后，继续投入探索。
	CALL メッセージ欄表示用関数(,,,0)
	
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_休憩出来る地形
#DIM 回復量
#DIM 対象キャラ

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 周围没有异常状况。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%一行正在探索时，来到了一片广场般的开阔地带。
	KSTR:(K++) = 这种地形能第一时间察觉靠近的魔物。机会难得，在此稍作休整吧。
	;HPバーの表示タイミングを調整するためここで一旦メッセージ表示
	CALL メッセージ欄表示用関数()
	CALL 口上変数初期化
	
	回復量 = ダンジョン階層記録 * 25
	WSTR:(K++) = 全体成员的ＨＰ恢复了{回復量, 4}！
	CALL 探索中全体回復_ＨＰ(回復量)
	
	対象キャラ = 味方ランダム選出_陥落済み()

	IF 対象キャラ > -1
		WSTR:(K++) = 顺带，%CALLNAME:MASTER%和%CALLNAME:(BATTLE_STATE:対象キャラ:0)%进行了短暂的『休憩』。
		WSTR:(K++) = 获得了5点ZP！
		FLAG:ZP所持量 += 5
	ENDIF
	WSTR:(K++) = %CALLNAME:MASTER%一行结束休整，继续投入探索。
	CALL メッセージ欄表示用関数(,,,0)
	
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_晶石の採掘場
#DIM 採掘済みフラグ

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 周围没有异常状况。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	採掘済みフラグ = 0
	WSTR:(K++) = %CALLNAME:MASTER%一行正在探索时，发现了裸露晶石的岩层。
	WSTR:(K++) = 在此处采掘或许能获得晶石，但动静可能会引来魔物袭击。
	$採掘ループ
	KSTR:(K++) = 该怎么办呢？
	KSTR:(K++) = BUTTON_[进行采掘]
	KSTR:(K++) = BUTTON_[离开此地]
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[进行采掘]"
			WSTR:(K++) = 些许风险不成问题，开始采掘吧。
			WSTR:(K++) = …………
			SELECTCASE RAND:(5 - 採掘済みフラグ)
				CASE 0
					KSTR:(K++) = …………采掘的声响引来了魔物，它们向你们发起了袭击！
					CALL メッセージ欄表示用関数()
					CALL 口上変数初期化
					
					CALL ランダムエネミーセット関数(4, ダンジョン階層記録)
					SIF ランダムダンジョン中加護 != ""
						戦闘時_特殊処理フラグ '= ランダムダンジョン中加護
					CALL 雑魚敵遭遇汎用処理
					
					IF RESULT == 0
						WSTR:(K++) = 虽然成功讨伐了魔物，但战斗余波震碎了周围的晶石。
						WSTR:(K++) = 继续深挖或许还有收获，但已没有时间进行大规模采掘。
						WSTR:(K++) = 虽感遗憾，还是继续探索吧。
					ELSEIF RESULT == -1
						WSTR:(K++) = 成功从魔物追击中脱身。
						WSTR:(K++) = 短时间内那片区域都会有魔物徘徊。
						WSTR:(K++) = 虽感遗憾但折返太危险，还是继续探索吧。
					ENDIF
				CASEELSE
					WSTR:(K++) = …………成功采掘到优质晶石！%CALLNAME:PLAYER%一行获得了1块星晶块。
					WSTR:(K++) = 不过周围岩层还残留着晶石……
					採掘済みフラグ ++
					GOTO 採掘ループ
			ENDSELECT
		CASE "[离开此地]"
			IF 採掘済みフラグ
				WSTR:(K++) = 继续采掘恐怕会有危险。
			ELSE
				WSTR:(K++) = 没必要为此冒生命危险。
			ENDIF
			WSTR:(K++) = %CALLNAME:PLAYER%一行离开此地，继续投入探索。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	CALL メッセージ欄表示用関数(,,,0)
	
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画
