
@COMNAME321
#FUNCTIONS
IF 月算出() == "冬の月" && ITEM:被炉 != 0 && GETPLACENAME(CFLAG:MASTER:現在マップ種別, CFLAG:MASTER:現在位置) == "和室" && CFLAG:TARGET:睡眠
	TSTR:コマンド名受渡 = 偷偷抚摸胸部
ELSE
	TSTR:コマンド名受渡 = 揉捏胸部
ENDIF

;===================================================
;コマンドタイプ
;===================================================
@COMTYPE_321
#FUNCTION
TFLAG:コマンドタイプ受渡 = COMTYPE("セクハラ")
弱点コマンドカテゴリ = B_女
睡眠中許可 = 1

@COM_TOOLTIP_321
LOCALS = <br>■揉捏胸部<br>
LOCALS += "轻触对方胸部的指令。<br>目标上半身着甲时不可执行。"
LOCALS += "<br>指令类型：性骚扰<br>获取来源：接触・暴露・快Ｂ・欢乐(特定条件)・不快(特定条件)・反感(特定条件)"
LOCALS += "<br>专属经验值：无<br>"
TSTR:ツールチップ受渡 = %LOCALS%


@COM321
;尻を揉む


SIF 同性愛性癖判定(PLAYER,TARGET)
	EXP:PLAYER:同性愛経験 += 1
;発生する快楽は受け手の状態に依存しない
CALL SOURCE_CALC_快Ｂ(TARGET, PLAYER, 80)
SIF TALENT:PLAYER:器用な指
	CALL SOURCE_CALC_快Ｂ(TARGET, PLAYER, 40)

TIME += 10

SIF CFLAG:TARGET:睡眠
	RETURN 1

SIF 同性愛性癖判定(TARGET,PLAYER)
	EXP:TARGET:同性愛経験 += 1

CALL セクハラ反応タイプ判定(TARGET)
;RFLAG:コマンド結果受渡し変数
;1:拒絶  2:受け入れ  3:喜び
;RFLAG:コマンド結果受渡し変数２
;1:無知  2:無反応  3:嫌悪  4:拒否  5:余裕  6:羞恥  7:愉悦  8:汎用

SELECTCASE RFLAG:コマンド結果受渡し変数２
	CASE 1
		;無知
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1 TO 2
				;拒絶と受け入れに違い無し
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 50)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
			CASE 3
				;喜び時は喜ぶ
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 150)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 10)
		ENDSELECT
	CASE 2
		;無反応
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1 TO 2
				;拒絶と受け入れ時は反応なし
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
			CASE 3
				;喜び時はちょっと喜ぶ
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 50)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 10)
		ENDSELECT
	CASE 3
		;嫌悪
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1
				;拒絶
				CALL SOURCE_CALC_不快(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_反感(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
			CASE 2
				;受け入れ
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 10)
			CASE 3
				;喜び
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 150)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 100)
		ENDSELECT
	CASE 4
		;拒否
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1
				;拒絶
				CALL SOURCE_CALC_不快(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_反感(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
			CASE 2
				;受け入れ
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 100)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 10)
			CASE 3
				;喜び
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 100)
		ENDSELECT
	CASE 5
		;余裕
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1
				;拒絶
				CALL SOURCE_CALC_不快(TARGET, PLAYER, 50)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
			CASE 2
				;受け入れ
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 100)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 20)
			CASE 3
				;喜び
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 100)
		ENDSELECT
	CASE 6
		;羞恥
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1
				;拒絶
				CALL SOURCE_CALC_不快(TARGET, PLAYER, 100)
				CALL SOURCE_CALC_反感(TARGET, PLAYER, 100)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
			CASE 2
				;受け入れ
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 50)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 20)
			CASE 3
				;喜び
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 150)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 120)
		ENDSELECT
	CASE 7
		;愉悦
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1
				;拒絶
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 50)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
			CASE 2
				;受け入れ
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 100)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 30)
			CASE 3
				;喜び
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 100)
		ENDSELECT
	CASE 8
		;汎用
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1
				;拒絶
				CALL SOURCE_CALC_不快(TARGET, PLAYER, 100)
				CALL SOURCE_CALC_反感(TARGET, PLAYER, 100)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
			CASE 2
				;受け入れ
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 50)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 10)
			CASE 3
				;喜び
				CALL SOURCE_CALC_歓楽(TARGET, PLAYER, 150)
				CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
				CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
				CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 100)
		ENDSELECT
ENDSELECT

RETURN 1

;-------------------------------------------------
;実行判定
;-------------------------------------------------
@COM_ABLE321
;揉捏胸部実行判定
SIF SAVESTR:ゲームフェイズ管理 != "通常モード"
	RETURN 0
;一括管理
SIF GLOBAL_COMABLE(321) && !RFLAG:罰ゲーム中
	RETURN RESULT
SIF TEQUIP:上半身鎧あり
	RETURN 0
RETURN 1

;-------------------------------------------------
;実行時メッセージ
;-------------------------------------------------
@MESSAGE_COM321
IF 月算出() == "冬の月" && ITEM:被炉 != 0 && GETPLACENAME(CFLAG:MASTER:現在マップ種別, CFLAG:MASTER:現在位置) == "和室" && CFLAG:TARGET:睡眠
	PRINTFORML %CALLNAME:PLAYER%朝着%TEXTR("发出安稳鼾声的/在被炉旁睡着的")%%CALLNAME:TARGET%的%TEXTR("毫无防备的/")%胸口悄悄伸出手，
ELSEIF CFLAG:TARGET:睡眠
	PRINTFORM %CALLNAME:PLAYER%接近酣睡的%CALLNAME:TARGET%，
ELSE
	PRINTFORM %CALLNAME:PLAYER%接近%CALLNAME:TARGET%，
	IF RAND:2 == 0
		PRINT 从正面
	ELSE
		PRINT 从背后
	ENDIF
ENDIF
IF 月算出() == "冬の月" && ITEM:被炉 != 0 && GETPLACENAME(CFLAG:MASTER:現在マップ種別, CFLAG:MASTER:現在位置) == "和室" && CFLAG:TARGET:睡眠
	PRINTFORM 为了不吵醒对方而轻手轻脚地
	SELECTCASE TALENT:TARGET:バストサイズ
		CASE -2
			PRINTFORM 几乎没有任何隆起的平坦
		CASE -1
			PRINTFORM 柔软的小巧
		CASE 0
			PRINTFORM 刚好能被手掌包裹的
		CASE 1 TO 2
			PRINTFORM 饱满而柔软的
		CASE 3
			PRINTFORM 几乎要从指缝溢出的丰满
	ENDSELECT
	IF 固有素質チェック(TARGET, "アイドル", "スクールアイドル", "ショロトルの巫女")
		PRINTFORM 偶像美乳
	ELSE
		PRINTFORM 胸部
	ENDIF
	PRINTFORML %TEXTR("揉捏着/抚弄着/尽情享受着触感")%
ELSE
	SELECTCASE TALENT:TARGET:バストサイズ
		CASE -2
			PRINTL 将手伸向几乎无起伏的平坦胸部勉强揉捏
		CASE -1
			PRINTL 轻柔抚弄微微隆起的青涩酥胸
		CASE 0
			PRINTL 伸手揉捏胸部的柔软轮廓
		CASE 1 TO 2
			PRINTL 把玩着饱满丰盈的浑圆双峰
		CASE 3
			PRINTL 贪婪揉捏着双手难以掌握的丰硕乳肉
	ENDSELECT
ENDIF
IF CUP:TARGET:快Ｂ > 1000
	;一定以上の快楽が発生した時にちょっと声が出る
	IF CFLAG:TARGET:睡眠
		PRINTFORML 突如其来的快感让%CALLNAME:TARGET%在睡梦中发出细微呻吟…
	ELSE
		PRINTFORML 突如其来的快感让%CALLNAME:TARGET%不禁漏出些许声音…
	ENDIF
	PRINTL
ENDIF


@MESSAGE_COM321_非口上時

IF CFLAG:TARGET:睡眠
	PRINTFORML %CALLNAME:TARGET%仍在安稳沉睡……
	RETURN 0
ENDIF

SELECTCASE RFLAG:コマンド結果受渡し変数２
	CASE 1
		;無知
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1 TO 2
				;拒絶と受け入れに違い無し
				PRINTFORML %CALLNAME:TARGET%露出不解神情，似乎在想做这种事有什么乐趣…
			CASE 3
				;喜び時は喜ぶ
				PRINTFORML %CALLNAME:TARGET%虽不明所以却因%CALLNAME:PLAYER%的愉悦而展露笑颜
		ENDSELECT
	CASE 2
		;無反応
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1 TO 2
				;拒絶と受け入れ時は反応なし
				PRINTFORML %CALLNAME:TARGET%毫无反应地保持平静
			CASE 3
				;喜び時はちょっと喜ぶ
				PRINTFORML %CALLNAME:TARGET%看似镇定，却红着脸将身体贴近%CALLNAME:PLAYER%…
		ENDSELECT
	CASE 3
		;嫌悪
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1
				;拒絶
				PRINTFORML %CALLNAME:TARGET%面露嫌恶地瞪着%CALLNAME:PLAYER%…
			CASE 2
				;受け入れ
				PRINTFORML %CALLNAME:TARGET%叹息着拍开了%CALLNAME:PLAYER%的手
			CASE 3
				;喜び
				PRINTFORML %CALLNAME:TARGET%露出[真拿你没办法]的表情任由%CALLNAME:PLAYER%摆布…
		ENDSELECT
	CASE 4
		;拒否
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1
				;拒絶
				PRINTFORML %CALLNAME:TARGET%明确告知%CALLNAME:PLAYER%希望停止这种行为
			CASE 2
				;受け入れ
				PRINTFORML %CALLNAME:TARGET%用无奈的眼神看着%CALLNAME:PLAYER%
			CASE 3
				;喜び
				PRINTFORML %CALLNAME:TARGET%似乎并不讨厌，放任%CALLNAME:PLAYER%继续动作…
		ENDSELECT
	CASE 5
		;余裕
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1
				;拒絶
				PRINTFORML %CALLNAME:TARGET%规劝%CALLNAME:PLAYER%不该做这种事
			CASE 2
				;受け入れ
				PRINTFORML %CALLNAME:TARGET%苦笑着对%CALLNAME:PLAYER%进行口头警告
			CASE 3
				;喜び
				PRINTFORML %CALLNAME:TARGET%悄悄提醒%CALLNAME:PLAYER%注意避开旁人视线…
		ENDSELECT
	CASE 6
		;羞恥
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1
				;拒絶
				PRINTFORML %CALLNAME:TARGET%涨红着脸用泪眼向%CALLNAME:PLAYER%抗议…
			CASE 2
				;受け入れ
				PRINTFORML %CALLNAME:TARGET%扭捏着红脸默许%CALLNAME:PLAYER%继续
			CASE 3
				;喜び
				PRINTFORML %CALLNAME:TARGET%红着脸凝视%CALLNAME:PLAYER%，轻轻依偎过来…
		ENDSELECT
	CASE 7
		;愉悦
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1
				;拒絶
				PRINTFORML %CALLNAME:TARGET%有趣地微笑着，并告诉%CALLNAME:PLAYER%触摸的方式不对
			CASE 2
				;受け入れ
				PRINTFORML %CALLNAME:TARGET%戏谑地问%CALLNAME:PLAYER%要不要换个部位
			CASE 3
				;喜び
				PRINTFORML %CALLNAME:TARGET%用妩媚神情暗示%CALLNAME:PLAYER%触碰更多部位…
		ENDSELECT
	CASE 8
		;汎用
		SELECTCASE RFLAG:コマンド結果受渡し変数
			CASE 1
				;拒絶
				PRINTFORML %CALLNAME:TARGET%明显抗拒%CALLNAME:PLAYER%的骚扰
			CASE 2
				;受け入れ
				PRINTFORML %CALLNAME:TARGET%默许了%CALLNAME:PLAYER%的触碰
			CASE 3
				;喜び
				PRINTFORML %CALLNAME:TARGET%似乎对%CALLNAME:PLAYER%的触碰感到欣喜…
		ENDSELECT
ENDSELECT

