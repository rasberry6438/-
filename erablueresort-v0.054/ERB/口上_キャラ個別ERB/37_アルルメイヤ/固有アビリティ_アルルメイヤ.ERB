
@固有アビ_37_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 80
	アビ名 = 月天++
	消費ＭＰ = 75
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 30
	アビ名 = 月天+
	消費ＭＰ = 75
ELSE
	アビ名 = 月天
	消費ＭＰ = 75
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 80
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵全体に［攻撃力✕700％］の土属性ダメージを与える。
			詳細文文字列受け渡し変数 += @"<br>［累積10％最大40％］（累積枠・6ターン）の攻撃力減少効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>［20％］（通常枠・6ターン）の水属性攻撃減少効果を与える。"
		ELSE
			詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵全体に［攻撃力✕200～250％］の土属性ダメージを与える。
			詳細文文字列受け渡し変数 += @"<br>［累積10％最大40％］（累積枠・6ターン）の攻撃力減少効果を与える。"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_敵全体_生者のみ
		IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 80
			アビ汎用変数:効果割合 = 700
		ELSE
			アビ汎用変数:効果割合 = RAND(200, 250)
		ENDIF
		CALL アビテンプレート_ダメージ処理_土属性
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 攻撃力累積
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用変数:効果割合 = 10
		アビ汎用変数:累積上限_割合 = 40
		アビ汎用変数:持続ターン = 6
		CALL アビテンプレート_不利効果_累積デバフ効果セット
		
		IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 80
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 属性与ダメージ_水
			アビ汎用文字列:バフ・デバフ対象能力 = 属性与ダメージ_水
			アビ汎用変数:効果割合 = 20
			アビ汎用変数:持続ターン = 6
			CALL アビテンプレート_不利効果_デバフ効果セット
		ENDIF
ENDSELECT



@固有アビ_37_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 75
	アビ名 = タブラ・ラーサ++
	消費ＭＰ = 100
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 60
	アビ名 =タブラ・ラーサ+
	消費ＭＰ = 100
ELSE
	アビ名 = タブラ・ラーサ
	消費ＭＰ = 100
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>味方全体に（1回）の弱体無効効果を与える
		IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 75
			詳細文文字列受け渡し変数 += @"<br>［600］のバリア効果を与える。"
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 30
			詳細文文字列受け渡し変数 += @"<br>［300］のバリア効果を与える。"
		ELSE
			詳細文文字列受け渡し変数 += @"<br>［100］のバリア効果を与える。"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_味方全体_生者のみ
		アビ汎用文字列:バフ・デバフ枠 = 弱体無効
		アビ汎用文字列:バフ・デバフ対象能力 = 弱体無効
		アビ汎用変数:持続回数 = 1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = バリア
		アビ汎用文字列:バフ・デバフ対象能力 = バリア
		IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 75
			アビ汎用変数:効果量 = 600
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 30
			アビ汎用変数:効果量 = 300
		ELSE
			アビ汎用変数:効果量 = 100
		ENDIF
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_バフ効果セット
ENDSELECT



@固有アビ_37_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 45
	アビ名 = ナクシャトラ
	消費ＭＰ = 50
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に［攻撃力✕250~300％］の土属性ダメージを与える。
		詳細文文字列受け渡し変数 += @"<br>［1］のスロウ効果を与える。"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_敵単体
		アビ汎用変数:効果割合 = RAND(250, 300)
		CALL アビテンプレート_ダメージ処理_土属性
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果量 = 1
		CALL アビテンプレート_不利効果_スロウ
ENDSELECT



@固有アビ_37_4(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70
	アビ名 = 事象投影
	消費ＭＰ = 200
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>水晶に投影された事象を解放する。
		詳細文文字列受け渡し変数 += @"<br>味方全体にランダムな強化効果を付与する。"
		詳細文文字列受け渡し変数 += @"<br>アビリティの使用回数に応じて付与する効果数が増加する。"
		RETURN 消費ＭＰ
	CASE "アビ説明文_詳細"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>味方全体に以下の４種のうちランダムな強化効果を付与する。
		詳細文文字列受け渡し変数 += @"<br>アビリティの使用回数に応じて付与する効果数が増加する。"
		詳細文文字列受け渡し変数 += @"<br>（１："
		詳細文文字列受け渡し変数 += @"<br>　［30％］（Ａ枠・4ターン）の追撃効果を与える。）"
		詳細文文字列受け渡し変数 += @"<br>（２："
		詳細文文字列受け渡し変数 += @"<br>　［100％］（Ａ枠・4ターン）のDA率上昇効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>　［50％］（Ａ枠・4ターン）のTA率上昇効果を与える。）"
		詳細文文字列受け渡し変数 += @"<br>（３："
		詳細文文字列受け渡し変数 += @"<br>　［100％］（Ａ枠・4ターン）のクリティカル率上昇効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>　［30％］（Ａ枠・4ターン）のクリティカルダメージ率上昇効果を与える。）"
		詳細文文字列受け渡し変数 += @"<br>（４："
		詳細文文字列受け渡し変数 += @"<br>　［10％］（Ａ枠・4ターン）の与ダメージ上昇効果を与える。）"
	CASE "アビ効果"
		;0…追撃　1…連撃　2…クリティカル　3…与ダメ
		
		IF !(戦闘中カウント:戦闘行動キャラ:0 == 1 && 戦闘中カウント:戦闘行動キャラ:1 == 1 && 戦闘中カウント:戦闘行動キャラ:2 == 1 && 戦闘中カウント:戦闘行動キャラ:3 == 1)
			SELECTCASE RAND:4
				CASE 0
					IF 戦闘中カウント:戦闘行動キャラ:0 == 1
						RESTART
					ENDIF
					戦闘中カウント:戦闘行動キャラ:0 = 1
				CASE 1
					IF 戦闘中カウント:戦闘行動キャラ:1 == 1
						RESTART
					ENDIF
					戦闘中カウント:戦闘行動キャラ:1 = 1
				CASE 2
					IF 戦闘中カウント:戦闘行動キャラ:2 == 1
						RESTART
					ENDIF
					戦闘中カウント:戦闘行動キャラ:2 = 1
				CASE 3
					IF 戦闘中カウント:戦闘行動キャラ:3 == 1
						RESTART
					ENDIF
					戦闘中カウント:戦闘行動キャラ:3 = 1
			ENDSELECT
		ENDIF
		
		IF 戦闘中カウント:戦闘行動キャラ:0 == 1
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_味方全体_生者のみ
			アビ汎用文字列:バフ・デバフ枠 = 追撃A
			アビ汎用文字列:バフ・デバフ対象能力 = 追撃
			アビ汎用変数:効果割合 = 30
			アビ汎用変数:持続ターン = 4
			CALL アビテンプレート_有利効果_バフ効果セット
		ENDIF
		
		IF 戦闘中カウント:戦闘行動キャラ:1 == 1
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_味方全体_生者のみ
			アビ汎用文字列:バフ・デバフ枠 = DA率A
			アビ汎用文字列:バフ・デバフ対象能力 = DA率
			アビ汎用変数:効果量 = 100
			アビ汎用変数:持続ターン = 4
			CALL アビテンプレート_有利効果_バフ効果セット
		
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = TA率A
			アビ汎用文字列:バフ・デバフ対象能力 = TA率
			アビ汎用変数:効果量 = 50
			アビ汎用変数:持続ターン = 4
			CALL アビテンプレート_有利効果_バフ効果セット
		ENDIF
		
		IF 戦闘中カウント:戦闘行動キャラ:2 == 1
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_味方全体_生者のみ
			アビ汎用文字列:バフ・デバフ枠 = クリティカル率A
			アビ汎用文字列:バフ・デバフ対象能力 = クリティカル率
			アビ汎用変数:効果量 = 100
			アビ汎用変数:持続ターン = 4
			CALL アビテンプレート_有利効果_バフ効果セット
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = クリティカルダメージ率A
			アビ汎用文字列:バフ・デバフ対象能力 = クリティカルダメージ率
			アビ汎用変数:効果量 = 30
			アビ汎用変数:持続ターン = 4
			CALL アビテンプレート_有利効果_バフ効果セット
		ENDIF
		
		IF 戦闘中カウント:戦闘行動キャラ:3 == 1
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_味方全体_生者のみ
			アビ汎用文字列:バフ・デバフ枠 = 与ダメ増加A
			アビ汎用文字列:バフ・デバフ対象能力 = 与ダメージ
			アビ汎用変数:効果割合 = 10
			アビ汎用変数:持続ターン = 4
			CALL アビテンプレート_有利効果_バフ効果セット
		ENDIF
ENDSELECT



@固有ターン終了時処理_キャラ_37
;ターン終了時処理関数から呼び出し
#DIM CTMAX判定
#DIM 大技判定
大技判定 = 0

FOR LOCAL, 0, 9
	IF 敵BATTLE_STATE:LOCAL:チャージターン == 敵BATTLE_STATE:LOCAL:最大チャージターン && 敵BATTLE_STATE:LOCAL:最大チャージターン != 0 && 敵BATTLE_STATE:LOCAL:ＨＰ != 0
		CTMAX判定 = 1
		BREAK
	ENDIF
NEXT

IF CTMAX判定 == 1
	アビテンプレート用_アビ名 = 未来幻視
	
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_味方全体_生者のみ
	アビ汎用文字列:バフ・デバフ枠 = 被ダメ軽減
	アビ汎用文字列:バフ・デバフ対象能力 = 被ダメージ
	アビ汎用変数:効果割合 = 70
	アビ汎用変数:持続ターン = 2
	CALL アビテンプレート_有利効果_バフ効果セット
	
	CTMAX判定 = 0
ENDIF

FOR LOCAL, 10, 20
	IF 行動種別フラグ:LOCAL:大技発動
		大技判定 = 1
		BREAK
	ENDIF
NEXT

IF 大技判定
	アビテンプレート用_アビ名 = 信託
	
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_味方全体_生者のみ
	CALL アビテンプレート_有利効果_デバフ消去()
ENDIF

;--------------------------------------------------
;戦闘能力画面に表示されるキャラごとの固有処理説明
;--------------------------------------------------
;・使い方
;「XXXX」をキャラクター番号に置換し、それぞれの関数に処理を入れる
;　口上と同じ感覚で使う為に書式を統一しているが、ステータス画面で表示されるので
;　基本的にWAIT系列は使わないことを推奨
;--------------------------------------------------
@口上_ステータス画面_固有特性解説_37(対象キャラ)
#DIM 対象キャラ
CALL 口上変数初期化

KSTR:(K++) = □ 特性：『神託』 □---------------------------------------------------------------------
KSTR:(K++) = 　敵が大技を発動したターンの終了時、味方全体の弱体効果を1つ消去する
KSTR:(K++) = 　
KSTR:(K++) = □ 特性：『未来幻視』 □-----------------------------------------------------------------
KSTR:(K++) = 　ターン終了時にCTMAXの敵がいる時、味方全体に被ダメージ70％軽減効果［3ターン］

CALL 口上変数表示(対象キャラ, 1)



