
@固有奥義_6(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 奥義威力
#DIMS 奥義名
#DIM 対象番号
#DIM バフ行数
#DIM テンション判定
#DIM テンション割合

IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70
	奥義名 = 百子夜行
	奥義威力 = 550
ELSE
	奥義名 = 金牙神然
	奥義威力 = 500
ENDIF

SELECTCASE ARGS
	CASE "奥義名"
		TSTR:コマンド名受渡 = %奥義名%
	CASE "奥義説明文"
		IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70
			詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>2番目のアビリティが発動/自身に絶対回避効果［1回］
		ELSE
			詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>自身に絶対回避効果［1回］
		ENDIF
		RETURN 奥義威力
	CASE "奥義前効果"
	CASE "奥義追加効果"
		IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70 && 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 75
			IF 展開中フィールド名格納 == "ゆ～とぴあ"
				CALL アビ汎用変数文字列リセット
				CALL アビ対象選択テンプレート_味方全体_生者のみ
				アビ汎用文字列:バフ・デバフ枠 = 追撃C
				アビ汎用文字列:バフ・デバフ対象能力 = 追撃
				アビ汎用変数:効果割合 = 20
				アビ汎用変数:持続回数 = 1
				CALL アビテンプレート_有利効果_バフ効果セット
				
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = 被ダメージ減少
				アビ汎用文字列:バフ・デバフ対象能力 = 被ダメージ
				アビ汎用変数:効果量 = 220
				アビ汎用変数:持続ターン = 1
				CALL アビテンプレート_有利効果_バフ効果セット
				
				CALL アビ汎用変数文字列リセット
				アビ汎用変数:効果量 = 220
				CALL アビテンプレート_回復処理_MAXでも回復
			ELSE
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:フィールド枠 = ゆ～とぴあ
				アビ汎用変数:持続ターン = 5
				CALL アビテンプレート_フィールド効果セット
			ENDIF
		ENDIF
		
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 完全回避
		アビ汎用文字列:バフ・デバフ対象能力 = 回避率
		アビ汎用変数:効果量 = 1000
		アビ汎用変数:持続回数 = 1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		IF 展開中フィールド名格納 == "ゆ～とぴあ"
			CALL アビ対象選択テンプレート_味方全体_生者のみ
			CALL アビ汎用変数文字列リセット
			アビ汎用変数:効果量 = 4
			アビ汎用変数:持続ターン = 2
			CALL アビテンプレート_有利効果_テンション
			; FOR 対象番号, 0, 4
			; 	SIF BATTLE_STATE:対象番号:キャラ登録番号 < 1
			; 		CONTINUE
			; 	SIF BATTLE_STATE:対象番号:ＨＰ < 1
			; 		CONTINUE
				
			; 	バフ行数 = バフ番号取得_枠("テンション", 対象番号)
				
			; 	IF バフ行数 < 0
			; 		テンション判定 = RAND:100 + 1
			; 		IF テンション判定 < 6
			; 			テンション割合 = 100
			; 		ELSEIF テンション判定 < 21
			; 			テンション割合 = 60
			; 		ELSEIF テンション判定 < 51
			; 			テンション割合 = 30
			; 		ELSE
			; 			テンション割合 = 10
			; 		ENDIF
					
			; 		CALL アビ汎用変数文字列リセット
			; 		CALL アビ対象選択テンプレート_指定(対象番号)
			; 		アビ汎用文字列:バフ・デバフ枠 = テンション
			; 		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
			; 		アビ汎用変数:効果割合 = テンション割合
			; 		アビ汎用変数:持続ターン = 2
			; 		アビ汎用変数:特殊表示オプション = 1
			; 		CALL アビテンプレート_有利効果_バフ効果セット
			; 	ELSE
			; 		テンション割合 = DT_CELL_GET("戦闘効果データベース", バフ行数, "効果量_割合")
					
			; 		IF テンション割合 == 60
			; 			テンション割合 = 100
			; 		ELSEIF テンション割合 == 30
			; 			テンション割合 = 60
			; 		ELSEIF テンション割合 == 10
			; 			テンション割合 = 30
			; 		ENDIF
					
			; 		DT_CELL_SET "戦闘効果データベース", バフ行数, "効果量_割合", テンション割合
			; 		SIF DT_CELL_GET("戦闘効果データベース", バフ行数, "持続ターン") < 2
			; 			DT_CELL_SET "戦闘効果データベース", バフ行数, "持続ターン", 2
			; 	ENDIF
			; NEXT
			
			IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70
				CALL アビ汎用変数文字列リセット
				CALL アビ対象選択テンプレート_味方全体_生者のみ
				アビ汎用文字列:バフ・デバフ枠 = ディスペルガード
				アビ汎用文字列:バフ・デバフ対象能力 = ディスペルガード
				アビ汎用変数:持続回数 = 1
				CALL アビテンプレート_有利効果_バフ効果セット
			ENDIF
		ENDIF
ENDSELECT

