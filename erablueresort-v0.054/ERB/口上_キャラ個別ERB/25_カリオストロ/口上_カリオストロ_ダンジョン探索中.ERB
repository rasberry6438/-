;--------------------------------------------------
;ダンジョン探索中に条件を満たしていた時表示される文章
;--------------------------------------------------
;・使い方
;「25」をキャラクター番号に置換し、それぞれの関数に処理を入れる
;--------------------------------------------------

;--------------------------------------------------
;「仲間と会話」ボタン押下時
;--------------------------------------------------
@KOJO_DUNGEON_仲間と会話_25(対象キャラ)
#DIM 対象キャラ
;簡単に何度も見られるので、条件分岐やランダム化で複数パターンの登録を推奨
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

SELECTCASE RAND:3 + RAND:3
	CASE 0
		WSTR:(K++) = 「_I_喂喂，别光顾着盯着本大爷看，也注意下周围啊_CALL_カリオストロ本性開示_」
		KSTR:(K++) = %CALLNAME:対象キャラ%露出了不怀好意的笑容
	CASE 1
		WSTR:(K++) = %CALLNAME:対象キャラ%正在环顾四周……
		KSTR:(K++) = 「_I_让我看看，有没有什么可以利用的材料……」
	CASE 2
		WSTR:(K++) = 「嗯ー？ %CSTR:対象キャラ:二人称%，怎么了吗？」
		KSTR:(K++) = %CALLNAME:対象キャラ%歪着头露出疑惑的表情
	CASE 3
		WSTR:(K++) = _CALLNAME_带着忧郁的表情叹了口气……
		KSTR:(K++) = 「啊，_2nd_桑，刚才怎么样？我那个表情是不是有种特别的可爱感♪」
	CASE 4
		WSTR:(K++) = 「_I_喂%CSTR:対象キャラ:二人称%，别离本大爷太远_」
		KSTR:(K++) = 「_I_要是本大爷在场的情况下你还受伤，那可有损我的名声_CALL_カリオストロ本性開示_」
ENDSELECT

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ,,0,,対象キャラ)



;--------------------------------------------------
;固有スキル発動時
;--------------------------------------------------
;「（キャラ名）の（アビ名）！」よりも前に表示される
;汎用アビや衣装アビだと発動しないので注意

;YYYYを固有アビ関数の「@固有アビ_25_YYYY」のYYYYと同じに変更する
;使用したアビリティの名前は「使用アビ名」に入ってくる
@KOJO_DUNGEON_固有アビ発動時_25_1(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;コラプス→ニュークリアシンサシス

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「气呼呼☆」
	DATA 「要做恶作剧了哦☆」
	DATA 「这是奖励哦☆」
	DATA 「要惩罚你了哦☆」
	DATA 「_I_陪你玩玩_」
	DATA 「_I_一口气解决掉！_」
	DATA 「_I_很开心吧？被可爱的女孩子戏弄什么的！_」
	DATA 「_I_看好了！这就是可爱的定义！_」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_2(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;ファンタスマゴリア→アルケイナ・エボリューション

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「卡莉奥斯特萝，明白了♪」
	DATA 「好想再多看看你帅气的地方呢_H_」
	DATA 「不许看别处哦_H_」
	DATA 「支援就交给我吧☆」
	DATA 「_I_你喜欢的对吧？ 像我这样的女孩子啦~_」
	DATA 「_I_你呀，是不是对本大爷心动了？_」
	DATA 「_I_这种东西只是最基础的啦_」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_3(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;リーンフォース→ネフシュタン

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「辛苦啦☆」
	DATA 「还不能倒下哦～☆」
	DATA 「手把手帮你治疗好♪」
	DATA 「加油_H_　加油_H_」
	DATA 「Fight☆　Fight☆」
	DATA 「_I_让世界第一美少女来治愈你吧_」
	DATA 「_I_还能继续对吧？_」
	DATA 「_I_不管怎么说，看起来还能再撑一会儿嘛_」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_11(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;アルス・グローリア

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

KSTR:(K++) = 「_I_让你见识炼金术的极致吧！_」

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_12(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;エンデュミオン

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

KSTR:(K++) = 「为了卡莉奥斯特萝要加油哦_H_」

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

@KOJO_DUNGEON_固有アビ発動時_25_13(対象キャラ, 使用アビ名)
#DIMS 使用アビ名
#DIM 対象キャラ
;ロード・トゥ・ジオメトリ

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

KSTR:(K++) = 「反对暴力☆」

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;奥義発動時
;--------------------------------------------------
@KOJO_DUNGEON_奥義発動時_25(対象キャラ, 使用奥義名)
#DIMS 使用奥義名
#DIM 対象キャラ
;「（キャラ名）の奥義：（奥義名）！」よりも前に表示される

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

IF 基礎BATTLE_STATE:LOCAL:Lv >= 35
	IF !RAND:4 && 陥落チェック(LOCAL)
		KSTR:(K++) = 「_I_再见啦！你就在这被判无期徒刑吧！！_」
	ELSEIF !RAND:3
		KSTR:(K++) = 「_I_这就是炼金术的极致！_」
	ELSE
		KSTR:(K++) = 「_I_在真理面前跪下吧！_」
	ENDIF
ELSE
	KSTR:(K++) = 「这就是真理的…_I_一击！_」
ENDIF

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ,,0,,対象キャラ)

;--------------------------------------------------
;チェンバースト発動時
;--------------------------------------------------
@KOJO_DUNGEON_チェンバ発動時_25(対象キャラ)
#DIM 対象キャラ
VARSET LOCAL
;「チェインバースト！」（フルチェイン！）よりも前に表示される
;該当キャラが起点になった時（＝ターンで最初に奥義を撃ったキャラ）しか呼ばれないので注意

CALL 口上変数初期化
VARSET LOCAL
LOCAL = キャラ隊列検索(対象キャラ)
LOCALS '= ""
LOCAL:2 = キャラ検索("[稚嫩的炼金术师]克拉莉丝")
LOCAL:3 = キャラ検索("[希求的炼金术师]米蕾耶")
LOCAL:4 = キャラ検索("[米蕾耶的随从]莉赛特")
LOCAL:12 = キャラ隊列検索(LOCAL:2) > -1 && FINDELEMENT(チェンバ基準キャラ保存, キャラ隊列検索(LOCAL:2))
LOCAL:13 = キャラ隊列検索(LOCAL:3) > -1 && FINDELEMENT(チェンバ基準キャラ保存, キャラ隊列検索(LOCAL:3))
LOCAL:14 = キャラ隊列検索(LOCAL:4) > -1 && FINDELEMENT(チェンバ基準キャラ保存, キャラ隊列検索(LOCAL:4))
IF LOCAL:12 || LOCAL:13 || LOCAL:14
	SIF LOCAL:12
		LOCALS += "克拉莉丝，"
	SIF LOCAL:13
		LOCALS += "米蕾耶，"
	SIF LOCAL:14
		LOCALS += "莉赛特，"
	KSTR:(K++) = 「_I_%LOCALS%跟我同步呼吸！一口气全力进攻！！_」
	IF LOCAL:12
		NSTR:(K++) = ++++
		切り替え名前:(LOCAL:1) = %CALLNAME:(LOCAL:2)%
		切り替え顔グラリソース:(LOCAL:1) = 探索用_{キャラ隊列検索(LOCAL:2)}_顔
		KSTR:(K++) = 「好、好的！明白了老师！！」
		LOCAL:1 ++
	ENDIF
	IF LOCAL:13
		NSTR:(K++) = ++++
		切り替え名前:(LOCAL:1) = %CALLNAME:(LOCAL:3)%
		切り替え顔グラリソース:(LOCAL:1) = 探索用_{キャラ隊列検索(LOCAL:3)}_顔
		KSTR:(K++) = 「知道了老师！」
		LOCAL:1 ++
	ENDIF
	IF LOCAL:14
		NSTR:(K++) = ++++
		切り替え名前:(LOCAL:1) = %CALLNAME:(LOCAL:4)%
		切り替え顔グラリソース:(LOCAL:1) = 探索用_{キャラ隊列検索(LOCAL:4)}_顔
		KSTR:(K++) = 「遵命！」
		LOCAL:1 ++
	ENDIF
ELSE
	KSTR:(K++) = 「_I_在过剩魔力消散之前，重新汇聚起来全力输出！！_」
ENDIF

;掛け合いの作り方
;ZZZZ = 掛け合い相手のCSVに記載してあるキャラ番号とする
;
; LOCAL:2 = GETCHARA(ZZZZ)
; IF キャラ隊列検索(LOCAL:2) > -1
; 	KSTR:(K++) = （口上キャラのセリフ）
;
; 	NSTR:(K++) = ++++
;	切り替え名前:0 = %CALLNAME:(LOCAL:2)%
; 	切り替え顔グラリソース:0 = 探索用_{キャラ隊列検索(LOCAL:2)}_顔
;
; 	KSTR:(K++) = （掛け合い相手のセリフ）
; ENDIF
;と記述すると下に一個、掛け合い相手の顔グラと名前が表示されたメッセージ欄を増やせるので、そこで掛け合いを行う
;複数個メッセージ欄を増やす場合、切り替え顔グラリソース:1、切り替え名前:1のように配列番号を１つずつ増やすこと

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;トドメ時
;--------------------------------------------------
@KOJO_DUNGEON_トドメ時_25(対象キャラ)
#DIM 対象キャラ

;行動の結果（◯◯は倒れた！など）の後に表示される
;複数攻撃時は一人でも倒していれば表示される

;口上用トドメフラグ には倒した敵の数が入っている
;口上用技名保存 には奥義名・アビ名が入っている
;       通常攻撃の場合は「通常攻撃」、チェンバの場合は「チェインバースト」が入っている

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「太好啦☆」
	DATA 「对不起呢？」
	DATA 「真是的…和杂鱼对手打太无聊了☆」
	DATA 「_I_切…杂鱼根本不配当对手！_」
	DATA 「_I_配角就快点从舞台上下去吧_」
	DATA 「_I_杂鱼就给我乖乖退场吧！_」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

; ;--------------------------------------------------
; ;味方から回復を受けた時
; ;「（キャラ名）のＨＰが」の直後に表示される
; ;複数人回復した場合、ランダムで一人の分が表示される
; ;--------------------------------------------------
; ;（現在未実装）
; @KOJO_DUNGEON_被回復時_25(対象キャラ)
; #DIM 対象キャラ
; CALL 口上変数初期化
; LOCAL = GETCHARA(25)
; LOCAL:1 = キャラ隊列検索(LOCAL)

; ;回復した側のキャラは「BATTLE_STATE:戦闘行動キャラ:キャラ登録番号」でキャラ番号が
; ;「戦闘行動キャラ」で隊列番号が取れる

; KSTR:(K++) = 

; CALL メッセージ欄表示用関数(@"探索用_{LOCAL:1}_顔", CALLNAME:対象キャラ)

;--------------------------------------------------
;戦闘勝利時
;--------------------------------------------------
@KOJO_DUNGEON_戦闘勝利時_25(対象キャラ)
#DIM 対象キャラ

;ルピやEXPの取得よりも前に表示される

CALL メッセージ欄表示用関数(,,,0)
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATAFORM 「卡莉奥斯特萝很努力了对吧？%CSTR:対象キャラ:二人称%桑，快夸夸我_H_」
	DATA 「呀，卡莉奥斯特萝赢啦_H_」
	DATA 「嘿嘿，是卡莉奥斯特萝的胜利_H_」
	DATA 「抱歉呢…卡莉奥斯特萝是无敌的☆」
	DATA 「哎呀呀～？这就结束了吗？」
	DATA 「_I_比嘴上说的还要不堪一击呢_」
	DATA 「_I_哈～炼金术真是炉火纯青啊！_」
	DATA 「_I_想赢本大爷还早了一千年呢_」
	DATA 「_I_轻松获胜！_」
	DATA 「_I_敢挑战本大爷就是你失败的原因_」
ENDDATA

CALL カリオストロ本性開示()

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;全滅時
;--------------------------------------------------
@KOJO_DUNGEON_全滅時_25(対象キャラ)
#DIM 対象キャラ
CALL メッセージ欄表示用関数(,,,0)
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)


STRDATA KSTR:(K++)
	DATA 「呜诶，卡莉奥斯特萝们输掉了啦」
	DATA 「反对暴力～」
	DATA 「_I_骗人的吧，怎么可能…_」
	DATA 「_I_本大爷居然会……_」
	DATA 「_I_挺能干的嘛…_」
ENDDATA

CALL カリオストロ本性開示()

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;逃走時
;--------------------------------------------------
@KOJO_DUNGEON_逃走時_25(対象キャラ)
#DIM 対象キャラ
CALL メッセージ欄表示用関数(,,,0)
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「拜拜～☆」
	DATA 「人家不能再陪你玩啦，抱歉呢？」
	DATA 「_I_啧，暂时撤退！_」
	DATA 「_I_暂时撤退，重整态势！_」
	DATA 「_I_这样打下去太吃亏了，我们重新开始吧_」
ENDDATA

CALL カリオストロ本性開示()

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)
