
@固有奥義_1749(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 奥義威力
#DIMS 奥義名
#DIM バフ・デバフ行数
#DIM 連撃数
#DIM リーダー特性
#DIM 贖罪の獅子奥義
#DIM 贖罪の獅子攻撃
#DIM マグノス隊列

マグノス隊列 = キャラ隊列検索(GETCHARA(1749))

リーダー特性 = 0
IF マグノス隊列 >= 0
	戦闘中カウント:マグノス隊列:0 = 0
	IF マグノス隊列 == 0
		FOR LOCAL, 0, 4
			SIF BATTLE_STATE:LOCAL:キャラ登録番号 < 1
				CONTINUE
			;対象属性（今回は火）かどうか
			IF BATTLE_STATE:LOCAL:属性 == 0
				;現在属性の値
				;　0：火　1：水
				;　2：風　3：土
				;　4：光　5：闇
				戦闘中カウント:マグノス隊列:0 += 1
			ENDIF
		NEXT
	ENDIF
	SIF 戦闘中カウント:マグノス隊列:0 >= 4
		リーダー特性 = 120
ENDIF

IF 装備ステータス補正保存:キャラ番号:属性 == 0 || 装備ステータス補正保存:キャラ番号:属性 == 10
	IF 基礎BATTLE_STATE:キャラ番号:Lv >= 60
		贖罪の獅子奥義 = 175
	ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 35
		贖罪の獅子奥義 = 125
	ENDIF
ENDIF

IF 装備ステータス補正保存:キャラ番号:属性 == 0 || 装備ステータス補正保存:キャラ番号:属性 == 10
	IF 基礎BATTLE_STATE:キャラ番号:Lv >= 80
		贖罪の獅子攻撃 = 375
	ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 60
		贖罪の獅子攻撃 = 175
	ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 35
		贖罪の獅子攻撃 = 125
	ENDIF
ENDIF

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
	奥義名 = アンガー・スクリーム +
	奥義威力 = 500 * (リーダー特性 + 贖罪の獅子奥義 + 100) / 100
ELSE
	奥義名 = アンガー・スクリーム 
	奥義威力 = 300 * (リーダー特性 + 贖罪の獅子奥義 + 100) / 100
ENDIF

;奥義威力を0にした場合、通常の奥義処理は行われず奥義追加効果のみが行われる。
;全体攻撃にしたい時や、攻撃しない奥義を作る場合は0に設定のこと

SELECTCASE ARGS
	CASE "奥義名"
		TSTR:コマンド名受渡 = %奥義名%
	CASE "奥義説明文"
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
			詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>
			詳細文文字列受け渡し変数 += @"<br>火属性キャラの攻撃力を７５％/３Ｔ上昇させる。"
		ELSE
			詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>
			詳細文文字列受け渡し変数 += @"<br>火属性キャラの攻撃力を７５％/３Ｔ上昇させる。"
		ENDIF
		RETURN 奥義威力
	CASE "奥義前効果"
		;対象決定の後、ダメージよりも前に発生する効果。基本の奥義ダメージ部分は記載する必要はない。
		;奥義威力が0だとここの部分もスキップされる
	CASE "奥義追加効果"
		;ここに奥義効果を記述する。基本の奥義ダメージ部分は記載する必要はない。
		;基本的にアビテンプレートの関数を使用すること
		;テンプレート使用の例は固有アビリティ_キャラ名.ERBに記載
		
		アビテンプレート用_アビ名表示済フラグ = 0

	IF マグノス隊列 == 0
		FOR LOCAL, 0, 4
			SIF BATTLE_STATE:LOCAL:キャラ登録番号 < 1
				CONTINUE
			;生者のみ
			SIF BATTLE_STATE:LOCAL:ＨＰ < 1
				CONTINUE
			;対象属性（今回は光）かどうか
			IF BATTLE_STATE:LOCAL:属性 == 0
				;現在属性の値
				;　0：火　1：水
				;　2：風　3：土
				;　4：光　5：闇
				CALL アビ対象選択テンプレート_指定(LOCAL, 0)
				アビ汎用文字列:バフ・デバフ枠 = 報われぬ者の叫び
				アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
				アビ汎用変数:効果割合 = 75
				アビ汎用変数:持続ターン = 3
				アビ汎用変数:消去不可オプション = 1
				CALL アビテンプレート_有利効果_バフ効果セット
			ENDIF
		NEXT
	ENDIF

	IF 戦闘中カウント:マグノス隊列:0 >= 4
	CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 再起の焔火
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用変数:効果割合 = 120
		アビ汎用変数:持続ターン = 2
		アビ汎用変数:消去不可オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット
	ENDIF


	IF BATTLE_STATE:マグノス隊列:属性 == 0
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 贖罪の獅子
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用変数:効果割合 = 贖罪の獅子攻撃
		アビ汎用変数:持続ターン = 2
		アビ汎用変数:消去不可オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット
	ENDIF
ENDSELECT
