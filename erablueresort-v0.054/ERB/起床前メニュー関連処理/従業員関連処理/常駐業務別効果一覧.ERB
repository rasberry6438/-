;----------------------------------------------------
;常駐業務ごとの効果を処理する
;----------------------------------------------------

@常駐業務効果_ロビー受付(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "経験値取得"
		業務別報告文字列:2 += @"由于该功能正在修改，前台接待的效果暂时被封印。<br>"
		;経験値取得とレベル上昇
		LOCALS = ロビー受付
		LOCAL = GETNUM(常駐業務レベル, "ロビー受付")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:LOCALS < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:ロビー受付 + 1)
				常駐業務レベル:対象キャラ:LOCALS += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%的%LOCALS%等级提升至Lv{常駐業務レベル:対象キャラ:LOCALS}！<br>"
				IF 常駐業務レベル:対象キャラ:LOCALS >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"常驻职务：%LOCALS%等级达到Lv5","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_バーテンダー(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "経験値取得"
		業務別報告文字列:2 += @"由于该功能正在修改，调酒师的效果暂时被封印。<br>"
		;経験値取得とレベル上昇
		LOCALS = バーテンダー
		LOCAL = GETNUM(常駐業務レベル, "バーテンダー")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:LOCALS < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:バーテンダー + 1)
				常駐業務レベル:対象キャラ:LOCALS += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%的%LOCALS%等级提升至Lv{常駐業務レベル:対象キャラ:LOCALS}！<br>"
				IF 常駐業務レベル:対象キャラ:LOCALS >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"常驻职务：%LOCALS%等级达到Lv5","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_司書(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "経験値取得"
		業務別報告文字列:2 += @"由于该功能正在修改，图书管理员效果暂时被封印。<br>"
		;経験値取得とレベル上昇
		LOCALS = 司書
		LOCAL = GETNUM(常駐業務レベル, "司書")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:LOCALS < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:司書 + 1)
				常駐業務レベル:対象キャラ:LOCALS += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%的%LOCALS%等级提升至Lv{常駐業務レベル:対象キャラ:LOCALS}！<br>"
				IF 常駐業務レベル:対象キャラ:LOCALS >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"常驻职务：%LOCALS%等级达到Lv5","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_プール監視員(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "経験値取得"
		業務別報告文字列:2 += @"由于该功能正在修改，泳池救生员效果暂时被封印。<br>"
		;経験値取得とレベル上昇
		LOCALS = プール監視員
		LOCAL = GETNUM(常駐業務レベル, "プール監視員")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:LOCALS < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:プール監視員 + 1)
				常駐業務レベル:対象キャラ:LOCALS += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%的%LOCALS%等级提升至Lv{常駐業務レベル:対象キャラ:LOCALS}！<br>"
				IF 常駐業務レベル:対象キャラ:LOCALS >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"常驻职务：%LOCALS%等级达到Lv5","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_漁師(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIMS 入手名
#DIM 候補数
#DIM 改行カウント
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "経験値取得"
		SELECTCASE RAND:3
			CASE 0
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ%正努力进行渔夫工作。（转至其他报告）<br>"
			CASE 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ%正悠闲地随船摇晃。（转至其他报告）<br>"
			CASE 2
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ%似乎钓到了某种鱼类。（转至其他报告）<br>"
		ENDSELECT
		候補数 = DT_SELECT("所持素材データベース", "素材カテゴリ = '食物素材' And 食材分類 = '魚'")
		RSTR:漁師結果一時保存 += @"<br>%CALLNAME:対象キャラ%又钓上了"
		改行カウント = STRLENS(@"%CALLNAME:対象キャラ%又钓上了")
		FOR LOCAL, 0, 常駐業務レベル:対象キャラ:漁師 + 1
			;とりあえず完全ランダム
			入手名 '= DT_CELL_GETS("所持素材データベース", RESULT:(RAND:候補数 + 1), "素材アイテム名", 1)
			CALL 素材入手処理(入手名, 1)
			IF LOCAL > 0
				RSTR:その他報告_記録文字列 += "，"
				改行カウント += STRLENS(入手名) + 2
			ELSE
				改行カウント += STRLENS(入手名)
			ENDIF
			IF 改行カウント >= 55
				改行カウント = 0
				RSTR:その他報告_記録文字列 += "<br>"
			ENDIF
			RSTR:漁師結果一時保存 += @"%入手名%"
		NEXT
		RSTR:漁師結果一時保存 += "！"
		;経験値取得とレベル上昇
		LOCALS = 漁師
		LOCAL = GETNUM(常駐業務レベル, "漁師")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:LOCALS < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:漁師 + 1)
				常駐業務レベル:対象キャラ:LOCALS += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%的%LOCALS%等级提升至Lv{常駐業務レベル:対象キャラ:LOCALS}！<br>"
				IF 常駐業務レベル:対象キャラ:LOCALS >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"常驻职务：%LOCALS%等级达到Lv5","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_シーガイド(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "経験値取得"
		SELECTCASE RAND:3
			CASE 0
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ%正努力进行海洋向导工作（路人游客增加）<br>"
			CASE 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ%正在讲解海洋生物知识（路人游客增加）<br>"
			CASE 2
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ%的海洋向导服务深受游客好评（路人游客增加）<br>"
		ENDSELECT
		;補正記録
		FLAG:シーガイド補正記録 += 常駐業務レベル:対象キャラ:シーガイド + 1
		;経験値取得とレベル上昇
		LOCALS = シーガイド
		LOCAL = GETNUM(常駐業務レベル, "シーガイド")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:LOCALS < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:シーガイド + 1)
				常駐業務レベル:対象キャラ:LOCALS += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%的%LOCALS%等级提升至Lv{常駐業務レベル:対象キャラ:LOCALS}！<br>"
				IF 常駐業務レベル:対象キャラ:LOCALS >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"常驻职务：%LOCALS%等级达到Lv5","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_道具屋(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM 業務量
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "ルピ補正"
		業務量 = (常駐業務レベル:対象キャラ:道具屋 + 1) * (常駐業務レベル:対象キャラ:道具屋 + 1) * (常駐業務レベル:対象キャラ:道具屋 + 1) * 滞在キャラ数算出関数() * RAND(95, 106) / 100
		;従業員業務のレポートと、リゾート収支レポートの施設分に書き込む用に文字列保存に入れ込む
		業務別報告文字列:2 += @"%GETPLACENAME(現在仕事:対象キャラ:1 / 10000, 現在仕事:対象キャラ:1 % 10000), 24, LEFT%常驻的%CALLNAME:対象キャラ, 16, LEFT%通过工作创造了%NUM_FORMAT(業務量), 6%卢比收益。<br>"
		RESULTS = 　%@"常驻员工「%CALLNAME:対象キャラ%」", 32, LEFT%：%NUM_FORMAT(業務量), 6%卢比<br>
		施設ルピ補正保存 += 業務量

		RETURN 業務量
	CASE "経験値取得"
		;経験値取得とレベル上昇
		LOCAL = GETNUM(常駐業務レベル, "道具屋")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:道具屋 < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:道具屋 + 1)
				常駐業務レベル:対象キャラ:道具屋 += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%的道具店等级提升至Lv{常駐業務レベル:対象キャラ:道具屋}！<br>"
				IF 常駐業務レベル:対象キャラ:道具屋 >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"常驻职务：道具店等级达到Lv5","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_土産物屋(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM 業務量
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "ルピ補正"
		業務量 = (常駐業務レベル:対象キャラ:土産物屋 + 1) * (常駐業務レベル:対象キャラ:土産物屋 + 1) * (常駐業務レベル:対象キャラ:土産物屋 + 1) * 滞在キャラ数算出関数() * RAND(95, 106) / 100
		;従業員業務のレポートと、リゾート収支レポートの施設分に書き込む用に文字列保存に入れ込む
		業務別報告文字列:2 += @"%GETPLACENAME(現在仕事:対象キャラ:1 / 10000, 現在仕事:対象キャラ:1 % 10000)%常驻的%CALLNAME:対象キャラ, 18, LEFT%通过工作创造了%NUM_FORMAT(業務量), 6%卢比收益。<br>"
		RESULTS = 　常驻员工「%CALLNAME:対象キャラ, 18, LEFT%」：%NUM_FORMAT(業務量), 6%卢比
		施設ルピ補正保存 += 業務量

		RETURN 業務量
	CASE "経験値取得"
		;経験値取得とレベル上昇
		LOCAL = GETNUM(常駐業務レベル, "土産物屋")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:土産物屋 < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:土産物屋 + 1)
				常駐業務レベル:対象キャラ:土産物屋 += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%的特产店等级提升至Lv{常駐業務レベル:対象キャラ:土産物屋}！<br>"
				IF 常駐業務レベル:対象キャラ:土産物屋 >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"常驻职务：特产店等级达到Lv5","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT


@常駐業務効果_食事処(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM 業務量
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "ルピ補正"
		業務量 = (常駐業務レベル:対象キャラ:食事処 + 1) * (常駐業務レベル:対象キャラ:食事処 + 1) * (常駐業務レベル:対象キャラ:食事処 + 1) * 滞在キャラ数算出関数() * RAND(95, 106) / 100
		;従業員業務のレポートと、リゾート収支レポートの施設分に書き込む用に文字列保存に入れ込む
		業務別報告文字列:2 += @"%GETPLACENAME(現在仕事:対象キャラ:1 / 10000, 現在仕事:対象キャラ:1 % 10000)%常驻的%CALLNAME:対象キャラ, 18, LEFT%通过工作创造了%NUM_FORMAT(業務量), 6%卢比收益。<br>"
		RESULTS = 　常驻员工「%CALLNAME:対象キャラ, 18, LEFT%」：%NUM_FORMAT(業務量), 6%卢比
		施設ルピ補正保存 += 業務量

		RETURN 業務量
	CASE "経験値取得"
		;経験値取得とレベル上昇
		LOCAL = GETNUM(常駐業務レベル, "食事処")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:食事処 < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:食事処 + 1)
				常駐業務レベル:対象キャラ:食事処 += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%的餐馆等级提升至Lv{常駐業務レベル:対象キャラ:食事処}！<br>"
				IF 常駐業務レベル:対象キャラ:食事処 >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"常驻职务：餐馆等级达到Lv5","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_装飾品店(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM 業務量
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "ルピ補正"
		業務量 = (常駐業務レベル:対象キャラ:装飾品店 + 1) * (常駐業務レベル:対象キャラ:装飾品店 + 1) * (常駐業務レベル:対象キャラ:装飾品店 + 1) * 滞在キャラ数算出関数() * RAND(95, 106) / 100
		;従業員業務のレポートと、リゾート収支レポートの施設分に書き込む用に文字列保存に入れ込む
		業務別報告文字列:2 += @"%GETPLACENAME(現在仕事:対象キャラ:1 / 10000, 現在仕事:対象キャラ:1 % 10000)%常驻的%CALLNAME:対象キャラ, 18, LEFT%通过工作创造了%NUM_FORMAT(業務量), 6%卢比收益。<br>"
		RESULTS = 　常驻员工「%CALLNAME:対象キャラ, 18, LEFT%」：%NUM_FORMAT(業務量), 6%卢比
		施設ルピ補正保存 += 業務量

		RETURN 業務量
	CASE "経験値取得"
		;経験値取得とレベル上昇
		LOCAL = GETNUM(常駐業務レベル, "装飾品店")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:装飾品店 < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:装飾品店 + 1)
				常駐業務レベル:対象キャラ:装飾品店 += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%的饰品店等级提升至Lv{常駐業務レベル:対象キャラ:装飾品店}！<br>"
				IF 常駐業務レベル:対象キャラ:装飾品店 >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"常驻职务：饰品店等级达到Lv5","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT
