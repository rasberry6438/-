@おさわりアイテム画像(アイテム画像更新タイプ, 有効アロマフラグ, 所持アロマ数配列, 最大アロマ数, 表示位置, メイン画像表示位置, メイン画像サイズ, 表示レイヤー層)
#DIM レイヤー番号 = 50
#DIMS REF アイテム画像更新タイプ
#DIM 表示レイヤー層
#DIM UI位置基準 = 1000, 700
#DIM REF 表示位置,0
#DIM REF メイン画像表示位置,0
#DIM REF メイン画像サイズ,0
#DIM カラーマトリクス,5,5
#DIM REF 所持アロマ数配列,0
#DIM 最大アロマ数
#DIM REF 有効アロマフラグ,0

SELECTCASE アイテム画像更新タイプ
CASE "初期化"
CASE "更新"
	GOTO 更新
CASE "描画"
	GOTO 描画
ENDSELECT


;リソース
GDISPOSE レイヤー番号 + 6 
CALL GCREATE_拡張子(レイヤー番号 + 6 , "カットイン素材/アロマボトル")
GDISPOSE レイヤー番号 + 8 
CALL GCREATE_拡張子(レイヤー番号 + 8 , "カットイン素材/もやもや")

GDISPOSE レイヤー番号 + 7 
GDISPOSE レイヤー番号 + 9 
GCREATE レイヤー番号 + 7 , GWIDTH(レイヤー番号 + 6 ) * 3, GHEIGHT(レイヤー番号 + 6 ) * 3
GCREATE レイヤー番号 + 9 , メイン画像サイズ:0, メイン画像サイズ:1 * 3
;orange
カラーマトリクス:0:0 = 256,   0,   0,   0,   0
カラーマトリクス:1:0 =   0, 128,   0,   0,   0
カラーマトリクス:2:0 =   0,   0,   0,   0,   0
カラーマトリクス:3:0 =   0,   0,   0, 256,   0
カラーマトリクス:4:0 =   0,   0,   0,   0, 256
GDRAWG レイヤー番号 + 7 , レイヤー番号 + 6 , 0, GHEIGHT(レイヤー番号 + 6 ) * 0, GWIDTH(レイヤー番号 + 6 ), GHEIGHT(レイヤー番号 + 6 ), 0, 0, GWIDTH(レイヤー番号 + 6 ), GHEIGHT(レイヤー番号 + 6 ), カラーマトリクス:0:0
GDRAWG レイヤー番号 + 9 , レイヤー番号 + 8 , 0, メイン画像サイズ:1 * 0, メイン画像サイズ:0, メイン画像サイズ:1, 0, 0, GWIDTH(レイヤー番号 + 8 ), GHEIGHT(レイヤー番号 + 8 ), カラーマトリクス:0:0
;blue
カラーマトリクス:0:0 =   0,   0,   0,   0,   0
カラーマトリクス:1:0 =   0, 128,   0,   0,   0
カラーマトリクス:2:0 =   0,   0, 256,   0,   0
カラーマトリクス:3:0 =   0,   0,   0, 256,   0
カラーマトリクス:4:0 =   0,   0,   0,   0, 256
GDRAWG レイヤー番号 + 7 , レイヤー番号 + 6 , 0, GHEIGHT(レイヤー番号 + 6 ) * 1, GWIDTH(レイヤー番号 + 6 ), GHEIGHT(レイヤー番号 + 6 ), 0, 0, GWIDTH(レイヤー番号 + 6 ), GHEIGHT(レイヤー番号 + 6 ), カラーマトリクス:0:0
GDRAWG レイヤー番号 + 9 , レイヤー番号 + 8 , 0, メイン画像サイズ:1 * 1, メイン画像サイズ:0, メイン画像サイズ:1, 0, 0, GWIDTH(レイヤー番号 + 8 ), GHEIGHT(レイヤー番号 + 8 ), カラーマトリクス:0:0
;pink
カラーマトリクス:0:0 = 256,   0,   0,   0,   0
カラーマトリクス:1:0 =   0, 128,   0,   0,   0
カラーマトリクス:2:0 =   0,   0, 256,   0,   0
カラーマトリクス:3:0 =   0,   0,   0, 256,   0
カラーマトリクス:4:0 =   0,   0,   0,   0, 256
GDRAWG レイヤー番号 + 7 , レイヤー番号 + 6 , 0, GHEIGHT(レイヤー番号 + 6 ) * 2, GWIDTH(レイヤー番号 + 6 ), GHEIGHT(レイヤー番号 + 6 ), 0, 0, GWIDTH(レイヤー番号 + 6 ), GHEIGHT(レイヤー番号 + 6 ), カラーマトリクス:0:0
GDRAWG レイヤー番号 + 9 , レイヤー番号 + 8 , 0, メイン画像サイズ:1 * 2, メイン画像サイズ:0, メイン画像サイズ:1, 0, 0, GWIDTH(レイヤー番号 + 8 ), GHEIGHT(レイヤー番号 + 8 ), カラーマトリクス:0:0

;選択時
カラーマトリクス:0:0 = 256,   0,   0,   0,   0
カラーマトリクス:1:0 =   0, 256,   0,   0,   0
カラーマトリクス:2:0 =   0,   0, 256,   0,   0
カラーマトリクス:3:0 =   0,   0,   0, 256,   0
カラーマトリクス:4:0 = 100, 100, 100,   0, 256
GDRAWG レイヤー番号 + 7 , レイヤー番号 + 7 , GWIDTH(レイヤー番号 + 6 ) * 1, 0, GWIDTH(レイヤー番号 + 6 ), GHEIGHT(レイヤー番号 + 6 ) * 3, 0, 0, GWIDTH(レイヤー番号 + 6 ), GHEIGHT(レイヤー番号 + 6 ) * 3, カラーマトリクス:0:0
;空瓶
カラーマトリクス:0:0 =  64,   0,   0,   0,   0
カラーマトリクス:1:0 =   0,  64,   0,   0,   0
カラーマトリクス:2:0 =   0,   0,  64,   0,   0
カラーマトリクス:3:0 =   0,   0,   0, 192,   0
カラーマトリクス:4:0 =   0,   0,   0,   0, 256
GDRAWG レイヤー番号 + 7 , レイヤー番号 + 7 , GWIDTH(レイヤー番号 + 6 ) * 2, 0, GWIDTH(レイヤー番号 + 6 ), GHEIGHT(レイヤー番号 + 6 ) * 3, 0, 0, GWIDTH(レイヤー番号 + 6 ), GHEIGHT(レイヤー番号 + 6 ) * 3, カラーマトリクス:0:0

$更新
$描画

CBGREMOVERANGE 表示レイヤー層 - 3, 表示レイヤー層

; GDISPOSE レイヤー番号 + 8 
; GCREATE レイヤー番号 + 8 , 400, 200
; GSETFONT レイヤー番号 + 8 , GETFONT(), 18
; GSETBRUSH レイヤー番号 + 8 , 0xFFC0C0C0
; GSETPEN レイヤー番号 + 8 , 0xFFC0C0C0, 0
; SIF BASE:理性 < 100
;     GSETBRUSH レイヤー番号 + 8 , 0xFFFFFF00
; LOCAL = MAX(BASE:理性 / 200,1)
; GDRAWTEXT レイヤー番号 + 8 , "理性:" + "★" * LOCAL, 0, 0 

; GSETBRUSH レイヤー番号 + 8 , 0xFFC0C0C0
; GDRAWTEXT レイヤー番号 + 8 , "警戒:" + TOSTR(BASE:TARGET:警戒) + "/" + TOSTR(MAXBASE:TARGET:警戒), 0, 20 
; CBGSETG レイヤー番号 + 8 , UI位置基準:0, 0, 表示レイヤー層

GDISPOSE レイヤー番号 + 25 
GCREATE レイヤー番号 + 25 , CLIENTWIDTH(), CLIENTHEIGHT()
FOR LOCAL, 0, 3
	FOR LOCAL:1, 0, 3
		SPRITEDISPOSE @"アロマボトル{LOCAL}_{LOCAL:1}"
		SPRITECREATE @"アロマボトル{LOCAL}_{LOCAL:1}", レイヤー番号 + 7 , GWIDTH(レイヤー番号 + 6 ) * LOCAL:1, GHEIGHT(レイヤー番号 + 6 ) * LOCAL, GWIDTH(レイヤー番号 + 6 ), GHEIGHT(レイヤー番号 + 6 )
	NEXT
NEXT
;アロマ種類数だけループする
LOCAL = 0
DO
	;持っている場合判定付きの描画
	IF 所持アロマ数配列:LOCAL
		GSETBRUSH レイヤー番号 + 25 , 0xFF020000 + LOCAL
		GFILLRECTANGLE レイヤー番号 + 25 , 表示位置:0 + GWIDTH(レイヤー番号 + 6 ) * LOCAL, 表示位置:1, GWIDTH(レイヤー番号 + 6 ), GHEIGHT(レイヤー番号 + 6 )
		CBGSETBUTTONSPRITE 0x020000 + LOCAL, @"アロマボトル{LOCAL}_0", @"アロマボトル{LOCAL}_1", 表示位置:0 + GWIDTH(レイヤー番号 + 6 ) * LOCAL, 表示位置:1 + GHEIGHT(レイヤー番号 + 6 ) - CLIENTHEIGHT(), 表示レイヤー層
	ELSE
		CBGSETSPRITE @"アロマボトル{LOCAL}_2", 表示位置:0 + GWIDTH(レイヤー番号 + 6 ) * LOCAL, 表示位置:1 + GHEIGHT(レイヤー番号 + 6 ) - CLIENTHEIGHT(), 表示レイヤー層
	ENDIF
	LOCAL ++
LOOP LOCAL < 最大アロマ数

FOR LOCAL, 0, 3
	IF 有効アロマフラグ:LOCAL
		SPRITEDISPOSE @"アロマエフェクト{LOCAL}"
		SPRITECREATE @"アロマエフェクト{LOCAL}", レイヤー番号 + 9 , 0, メイン画像サイズ:1 * LOCAL, メイン画像サイズ:0, メイン画像サイズ:1
		CBGSETSPRITE @"アロマエフェクト{LOCAL}", メイン画像表示位置:0, メイン画像表示位置:1 + メイン画像サイズ:1 - CLIENTHEIGHT(), 表示レイヤー層 - LOCAL - 1
	ENDIF
NEXT


アイテム画像更新タイプ '= "描画"
RETURN

@おさわりアイテムメッセージ(アイテム種別, アイテムID, プリントメッセージ保存)
#DIMS アイテム種別
#DIM アイテムID
#DIMS REF プリントメッセージ保存

SELECTCASE アイテム種別
CASE "アロマオイル"
	GOTO アロマオイル
ENDSELECT

$アロマオイル
プリントメッセージ保存 += @"<br>%CALLNAME:PLAYER%取出了香薰精油"
SELECTCASE アイテムID
CASE 0
	プリントメッセージ保存 += @"<br>甘甜的橙香弥漫开来……"
CASE 1
	プリントメッセージ保存 += @"<br>薰衣草的芬芳扩散开来……"
CASE 2
	プリントメッセージ保存 += @"<br>依兰的浓郁香气萦绕四周……"
ENDSELECT

HTML_PRINT プリントメッセージ保存
プリントメッセージ保存 = 
