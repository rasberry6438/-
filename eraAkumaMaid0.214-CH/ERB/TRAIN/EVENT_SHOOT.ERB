;---------------------------------------------------------
;射精処理
;---------------------------------------------------------
;3PとＷ口交は、COMFに直接記述します。
;助手を犯すって間違って無い？
@SAMEN_CHECK, ARG
SELECTCASE ARG
;减少の値が入っているときには中止
CASE IS < 0
	BASE:PLAYER:絶頂 -= TCVAR:PLAYER:絶頂増加
	TCVAR:PLAYER:絶頂増加 = 0
	TCVAR:PLAYER:絶頂度 = 0
	IF COND("３Ｐ")
		CALL SETFLAG, "調教者交代"
		BASE:PLAYER:絶頂 -= TCVAR:PLAYER:絶頂増加
		TCVAR:PLAYER:絶頂増加 = 0
		TCVAR:PLAYER:絶頂度 = 0
		CALL SETFLAG, "調教者交代"
	ENDIF
CASEELSE
	CALL SAMEN_CHECK_PLAYER, ARG
	IF COND("３Ｐ")
		CALL SETFLAG, "調教者交代"
		CALL SAMEN_CHECK_PLAYER, ARG
		CALL SETFLAG, "調教者交代"
	ENDIF
ENDSELECT

@SAMEN_CHECK_PLAYER, ARG
#DIM ABL_TECHNIC
;-------------------------------------------------
;射精・絶頂ゲージ格子
;-------------------------------------------------
TFLAG:増加量 = 0
TFLAG:倍率補正 = 1000

;技巧が高すぎる時への対策
SELECTCASE ABL:技巧 - ABL:PLAYER:技巧
CASE IS <= 2
	ABL_TECHNIC = 200
CASE IS <= 5
	ABL_TECHNIC = (ABL:技巧 - ABL:PLAYER:技巧) * 100
CASE IS <= 10
	ABL_TECHNIC = 500 + (ABL:技巧 - ABL:PLAYER:技巧) * 20
CASEELSE
	ABL_TECHNIC = 600 + (ABL:技巧 - ABL:PLAYER:技巧) * 5
ENDSELECT

;指令に対する基礎快楽を設定する
;面部騎乗などは発生していない場合にはそもそもここの値が０なので、以下の分岐でTEQUIP:推倒などは無視しても問題ない
SELECTCASE SELECTCOM
;接吻（深吻は威力減）
CASE 6
	TFLAG:増加量 = 100 + ABL_TECHNIC*2
CASE 10
	SIF INSERT("尿道挿入", TARGET, PLAYER)
		TFLAG:増加量 = ABL:PLAYER:技巧*100 + ABL_U(TARGET)*50
;给对方乳交
CASE 11
	TFLAG:増加量 = 100 + ABL_TECHNIC*3
;兜合わせ
CASE 16
	TFLAG:増加量 = 300 + ABL_TECHNIC*2
;Ｖ挿入
CASE 60 TO 69
	TFLAG:増加量 = ABL_TECHNIC + ABL_V(TARGET)*100

	;阴茎を全部受け入れられないと快感低め
	SELECTCASE SIZE("阴茎", PLAYER) - ABL:Ｖ拡張
	CASE IS >= 3
		TIMES TFLAG:増加量, 0.10
	CASE 2
		TIMES TFLAG:増加量, 0.30
	CASE 1
		TIMES TFLAG:増加量, 0.70
	ENDSELECT

	SELECTCASE SELECTCOM
	CASE 60
		TFLAG:増加量 += MIN(ABL:信頼, 10)*100
	CASE 61
		TFLAG:増加量 += MIN(ABL:受虐属性, 5)*100
	CASE 62
		TFLAG:増加量 += MIN(ABL:露出癖, 10)*100
	CASE 63
		TIMES TFLAG:増加量, 0.50
		TFLAG:増加量 += 50 + ABL_TECHNIC
	CASE 64
		TIMES TFLAG:増加量, 0.60
	CASE 65

	ENDSELECT

	;挿入失敗
	SIF COND("挿入前暴発フラグ", PLAYER)
		TFLAG:増加量 = 0
;Ａ挿入
CASE 70 TO 79
	TFLAG:増加量 = ABL_TECHNIC + ABL_A(TARGET)*100

	SELECTCASE SELECTCOM
	CASE 60
		TFLAG:増加量 += MIN(ABL:信頼, 10)*100
	CASE 61
		TFLAG:増加量 += MIN(ABL:受虐属性, 5)*100
	CASE 62
		TFLAG:増加量 += MIN(ABL:露出癖, 10)*100
	CASE 63
		TIMES TFLAG:増加量, 0.50
		TFLAG:増加量 += 50 + ABL_TECHNIC
	CASE 64
		TIMES TFLAG:増加量, 0.60
	CASE 65

	ENDSELECT
;磨鏡
CASE 80
	IF CHECK_COM("双頭振動棒PLAY")
		TFLAG:増加量 = 500 + ABL_TECHNIC*2
		;締まり対決。値が大きいほど快楽が少なくなる（TARGETに与える快楽は増える）
		SELECTCASE ABL:Ｖ技術 - ABL:Ｖ拡張 - (ABL:PLAYER:Ｖ技術 - ABL:PLAYER:Ｖ拡張)
		CASE IS >= 3
			TIMES TFLAG:増加量, 2.00
		CASE 2
			TIMES TFLAG:増加量, 1.50
		CASE 1
			TIMES TFLAG:増加量, 1.20
		CASE -1
			TIMES TFLAG:増加量, 0.80
		CASE -2
			TIMES TFLAG:増加量, 0.50
		CASE IS <= -3
			TIMES TFLAG:増加量, 0.30
		ENDSELECT
	ELSE
		TFLAG:増加量 = 500 + ABL_TECHNIC*2
		;陰毛の生え具合補正
		SIF COND("陰毛", PLAYER) <= 5 && COND("陰毛") >= 5
			TIMES TFLAG:増加量, 1.20
	ENDIF
;雙乳間抽插
CASE 81
	;罩杯の尺寸で強化
	TFLAG:増加量 = 500 + ABL_TECHNIC*2 + BASE:罩杯*100
;乳頭奸
CASE 82
	;罩杯の尺寸で強化
	TFLAG:増加量 = 500 + ABL_TECHNIC*2 + BASE:罩杯*200
;尿道挿入
CASE 83 TO 88
	TFLAG:増加量 = ABL_TECHNIC + ABL_U(TARGET)*100

	SELECTCASE SELECTCOM
	CASE 83
		TFLAG:増加量 += MIN(ABL:信頼, 10)*100
	CASE 84
		TFLAG:増加量 += MIN(ABL:受虐属性, 5)*100
	CASE 85
		TFLAG:増加量 += MIN(ABL:露出癖, 10)*100
	CASE 86
		TIMES TFLAG:増加量, 0.50
		TFLAG:増加量 += 50 + ABL_TECHNIC
	CASE 87
		TIMES TFLAG:増加量, 0.60
	CASE 88

	ENDSELECT

;奉仕系
CASE 90 TO 119
	TFLAG:増加量 = 500 + ABL_TECHNIC*6
	SELECTCASE SELECTCOM
	CASE 91, 99
		TFLAG:増加量 += MIN(ABL:精液中毒, 5)*100
		SIF TEQUIP:深喉
			TFLAG:増加量 += ABL_T(TARGET)*50
	CASE 93
		IF CHECK_COM("展示肉棒")
			TFLAG:増加量 = 0
		ELSE
			TFLAG:増加量 += ABL_TECHNIC
		ENDIF
	CASE 95, 96
		TFLAG:増加量 += MIN(ABL:施虐属性, 5)*100
	;舔足奉仕では絶頂しない
	CASE 100
		TFLAG:増加量 = 0
	;飞机杯
	CASE 105
		TFLAG:増加量 /= 2
		TFLAG:増加量 += 3000
	CASEELSE
		TFLAG:増加量 += ABL_TECHNIC
	ENDSELECT
;調教者挿入
CASE 120 TO 129
	TFLAG:増加量 = 1000 + ABL_TECHNIC*4
;強制口交
CASE 140
	IF TEQUIP:深喉
		TFLAG:増加量 = ABL_T(TARGET)*100
	ELSE
		TFLAG:増加量 = ABL_T(TARGET)*30
	ENDIF

	;阴茎を全部受け入れられないと快感低め
	SELECTCASE SIZE("阴茎", PLAYER) - ABL:喉拡張
	CASE IS >= 3
		TIMES TFLAG:増加量, 0.10
	CASE 2
		TIMES TFLAG:増加量, 0.30
	CASE 1
		TIMES TFLAG:増加量, 0.70
	ENDSELECT
;深喉
CASE 150
	IF TEQUIP:深喉
		TFLAG:増加量 = ABL_T(TARGET)*50
	ELSE
		TFLAG:増加量 = ABL_T(TARGET)*10
	ENDIF

	;阴茎を全部受け入れられないと快感低め
	SELECTCASE SIZE("阴茎", PLAYER) - ABL:喉拡張
	CASE IS >= 3
		TIMES TFLAG:増加量, 0.10
	CASE 2
		TIMES TFLAG:増加量, 0.30
	CASE 1
		TIMES TFLAG:増加量, 0.70
	ENDSELECT
;自慰
CASE 282
	TFLAG:増加量 = MAXBASE:PLAYER:絶頂/2
	SIF SELECTCOM == PREVCOM
		TFLAG:増加量 += MAXBASE:PLAYER:絶頂/2
	;オカズによってBOUNS有
	SELECTCASE TEQUIP:PLAYER:自慰
	;舐陰
	CASE 1
		SIF COND("♀弱点", PLAYER)
			TFLAG:増加量 += MAXBASE:PLAYER:絶頂/2
	;自慰
	CASE 3
		TFLAG:増加量 += MAXBASE:PLAYER:絶頂/4
	;舐陰莖
	CASE 4
		SIF COND("♂弱点", PLAYER)
			TFLAG:増加量 += MAXBASE:PLAYER:絶頂/2
	;舐肛
	CASE 9
		SIF COND("肛門弱点", PLAYER)
			TFLAG:増加量 += MAXBASE:PLAYER:絶頂/2
	;扒開阴道
	CASE 13
		SIF COND("♀弱点", PLAYER)
			TFLAG:増加量 += MAXBASE:PLAYER:絶頂/2
	;扒開菊穴
	CASE 14
		SIF COND("肛門弱点", PLAYER)
			TFLAG:増加量 += MAXBASE:PLAYER:絶頂/2
	ENDSELECT

;被逆推
CASEELSE
	IF TEQUIP:推倒
		;舐陰莖
		SELECTCASE SELECTCOM
		CASE 4
			TFLAG:増加量 = 10 + ABL_TECHNIC
		;面部騎乗
		CASE 1
			TFLAG:増加量 = 300 + ABL_TECHNIC*4
		CASE 9
			TFLAG:増加量 = 300 + ABL_TECHNIC*4
		ENDSELECT
	ENDIF
ENDSELECT

;調教知識によるBOUNS
SELECTCASE CONDS("調教知識")
CASE "愛撫・奉仕知識"
	SIF SERVICE_PLAY()
		TFLAG:増加量 = MAX(MULTIPLY(TFLAG:増加量, 150), TFLAG:増加量 + 500)
CASE "Ａ調教知識"
	SELECTCASE SELECTCOM
	CASE 96, 125 TO 129
		TFLAG:増加量 = MAX(MULTIPLY(TFLAG:増加量, 150), TFLAG:増加量 + 1000)
	ENDSELECT
CASE "道具使"
	SELECTCASE SELECTCOM
	CASE 105 TO 107
		TFLAG:増加量 = MAX(MULTIPLY(TFLAG:増加量, 150), TFLAG:増加量 + 1000)
	ENDSELECT
ENDSELECT

;挿入指令
IF INSERT_PLAY(SELECTCOM)
	;挿入している人が假阳具使用してる時
	IF PENIS(PLAYER) == 0
		TFLAG:増加量 = 0
	;戴上套套
	ELSEIF TEQUIP:PLAYER:避孕套
		IF CONFIG("極厚避孕套")
			TIMES TFLAG:増加量, 0.25
		ELSE
			TIMES TFLAG:増加量, 0.50
		ENDIF
	ENDIF
ENDIF

SIF TFLAG:増加量 == 0
	RETURN 0

;TCVAR:PLAYER:絶頂許可でこのターンにPLAYERに射精絶頂するような刺激があったかを調べる。女は接吻でもイく事にしてみる。
;TCVAR:PLAYER:絶頂許可が0でも、快感が射精絶頂ゲージの最大値の2倍以上あれば耐え切れず射精絶頂する。
;また、カウンターがあった場合にもTCVAR:PLAYER:絶頂許可はONとなる。
SELECTCASE SELECTCOM
CASE 4, 6
	SIF TALENT:PLAYER:女性 || TALENT:PLAYER:扶她
		TCVAR:PLAYER:絶頂許可 = 1
CASE 10, 16, 60 TO 79, 81 TO 88, 140, 150
	SIF PENIS(PLAYER)
		TCVAR:PLAYER:絶頂許可 = 1
CASE 80, 90 TO 129, 282
	TCVAR:PLAYER:絶頂許可 = 1
;胸奉仕系は扶她でない女性のみ絶頂しやすくしてみる。
CASE 11, 102
	SIF TALENT:PLAYER:女性 && TALENT:PLAYER:扶她 == 0
		TCVAR:PLAYER:絶頂許可 = 1
ENDSELECT

;PALAM:Ｖ潤、PALAM:Ａ潤をみる
SELECTCASE SELECTCOM
;例外的に潤滑が関係ないもの
CASE 82, 83 TO 88
;面部騎乗系
CASE 1, 9
	TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, MIN(80 + GET_PALAMLV(PALAM:Ｖ潤)*10, 120) )
;騎乗位系
CASE 65, 75
	TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, MIN(20 + GET_PALAMLV(PALAM:Ｖ潤)*30, 120) )
;Ｖ挿入
CASE 60 TO 69
	TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, MIN(60 + GET_PALAMLV(PALAM:Ｖ潤)*20, 120) )
;Ａ挿入
CASE 70 TO 79
	TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, MIN(40 + GET_PALAMLV(PALAM:Ａ潤)*20, 120) )
;摩擦挿入
CASE 80
	TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, MIN(10 + GET_PALAMLV(PALAM:Ｖ潤)*40, 120) )
CASE 16, 81 TO 89, 93, 94, TNUM("尻素股")
	TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, MIN(10 + GET_PALAMLV(PALAM:PLAYER:Ｐ潤)*40, 120) )
ENDSELECT

;主に技能による補正
CALL SAMEN_CHECK_EX

;連続絶頂コンボ数による補正
IF PALAM:補正値
	;奉仕指令は影響很强
	SELECTCASE SELECTCOM
	CASE 6, 90 TO 119, 140
		TFLAG:倍率補正 = DIVIDE(TFLAG:倍率補正, 100 + PALAM:補正値*20)
	CASEELSE
		TFLAG:倍率補正 = DIVIDE(TFLAG:倍率補正, 100 + PALAM:補正値*5)
	ENDSELECT
ENDIF

;２倍以上の場合には、２のn乗 < 補正倍率 < ２の(n+1)乗 →　(n+1)倍 < 補正倍率 < (n+2)倍
;効果が上がりすぎると上がり幅の減少著しい対数関数的な補正
TFLAG:倍率補正 = CALCF("快楽補正", TFLAG:倍率補正)

TFLAG:増加量 = MULTIPLY(TFLAG:増加量, TFLAG:倍率補正/10)

;技巧やお気に入りや弱点など絶対にかかる補正
;非常に効果が高い
TFLAG:増加量 = CALCF("基礎補正", TFLAG:増加量)

;推倒orＷ推倒or３Ｐの時の補正
SIF TEQUIP:Ｗ推倒 || SELECTCOM:1 >= 0 || COND("３Ｐ")
	TIMES TFLAG:増加量, 0.70

;かなり強めの減少補正（調教中のみ）
IF COND("調教中")
	SELECTCASE SELECTCOM
	CASE 1
		SIF CHECK_COM("万謝的亲吻", 1)
			TIMES TFLAG:増加量, 0.10
	CASE 6
		;深吻
		SIF CHECK_COM("テンダー接吻", 6)
			TIMES TFLAG:増加量, 0.10
	CASE 91
		SIF CHECK_COM("清洁口交", 91)
			TIMES TFLAG:増加量, 0.20
		SIF CHECK_COM("阴茎接吻", 91)
			TIMES TFLAG:増加量, 0.10
	CASE 93
		SIF CHECK_COM("展示肉棒", 93)
			TIMES TFLAG:増加量, 0.10
	CASE 98
		SIF CHECK_COM("清洁舔阴", 98)
			TIMES TFLAG:増加量, 0.20
	CASE 99
		SIF CHECK_COM("清洁口交", 91) + CHECK_COM("清洁舔阴", 98) && CHECK_COM("清洁口交", 4) + CHECK_COM("清洁舔阴", 1)
			TIMES TFLAG:増加量, 0.20
	CASEELSE
		SIF INSERT_PLAY(SELECTCOM) && TEQUIP:手下留情
			TIMES TFLAG:増加量, 0.50
	ENDSELECT
ENDIF

;PLAYヤーが自己やっていない場合にはオミット
SELECTCASE SELECTCOM
;自慰
CASE 282

CASEELSE
	;媚薬を使われてると、技巧減少
	SIF TEQUIP:媚薬
		TFLAG:増加量 = DIVIDE(TFLAG:増加量, 100 + TEQUIP:媚薬)
	;打屁股性交
	SIF COND("打屁股性交フラグ") && COND("打屁股性交フラグ", PLAYER)
		TIMES TFLAG:増加量, 1.10
ENDSELECT

;呼び出し時の補正
SIF ARG > 0
	TFLAG:増加量 = MULTIPLY(TFLAG:増加量, ARG)

;PRINTFORML PLAYヤーの射精ゲージ増加 = {TFLAG:増加量}
BASE:PLAYER:絶頂 += TFLAG:増加量

;射精ゲージ増加の一時保存
TCVAR:PLAYER:絶頂増加 += TFLAG:増加量

;射精ＬＶの計算
TCVAR:PLAYER:絶頂度 = CALCF("絶頂", PLAYER)

;PRINTFORML PLAYヤーの射精ゲージ = {BASE:PLAYER:絶頂}


;技巧以外のABLの値による射精ゲージ増加補正
@SAMEN_CHECK_EX
SELECTCASE SELECTCOM
CASE 6
	;ABL:Ｍ感覚をみる
	SELECTCASE ABL:PLAYER:Ｍ感覚
	CASE 0
		TIMES TFLAG:倍率補正, 0.50
	CASE 1, 2
		TIMES TFLAG:倍率補正, 0.70
	CASE 3, 4
		TIMES TFLAG:倍率補正, 1.00
	CASE 5, 6
		TIMES TFLAG:倍率補正, 1.20
	CASE 7, 8
		TIMES TFLAG:倍率補正, 1.50
	CASEELSE
		TIMES TFLAG:倍率補正, 2.00
	ENDSELECT
	;敏感具合
	IF TALENT:PLAYER:蕩唇
		TIMES TFLAG:倍率補正, 2.00
	ELSEIF TALENT:PLAYER:Ｍ性向
		TIMES TFLAG:倍率補正, 1.50
	ENDIF
;挿入指令
CASE 60 TO 69
	;挿入中愛撫で締め付け増加
	SIF COND("締め付けフラグ")
		TIMES TFLAG:倍率補正, 1.20
	;絶頂すると、締め付け増加
	SIF NOWEX:絶頂数合計
		TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, 100 + NOWEX:絶頂数合計*20)
	SIF INSERT("狂野摇摆")
		TIMES TFLAG:倍率補正, 1.50
	;PLAYERが童貞
	SIF EXP:PLAYER:Ｖ挿入経験 + EXP:PLAYER:Ａ挿入経験 == 0
		TIMES TFLAG:倍率補正, 3.00
	;EXP:Ｖ性交経験をみる。経験が多くなると少し上がる
	IF TALENT:処女 == 1
		TIMES TFLAG:倍率補正, 1.50
	ELSE
		TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, 100 + GET_EXP_LV(EXP:Ｖ性交経験) )
	ENDIF
	;阴茎の尺寸との差でBOUNS
	SELECTCASE ABL:Ｖ拡張 - SIZE("阴茎", PLAYER)
	CASE IS <= 0
		TIMES TFLAG:倍率補正, 1.20
	CASE IS <= ABL:Ｖ技術
		LOCAL = LIMIT(150 * BASE:体力 / MAXBASE:体力, 25, 100)
		TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, LOCAL)
	CASEELSE
		LOCAL = LIMIT(120 * BASE:体力 / MAXBASE:体力, 10, 100)
		TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, LOCAL)
	ENDSELECT

	SIF CHECK("Ｖ完美契合")
		TIMES TFLAG:倍率補正, 1.10
CASE 70 TO 79
	;挿入中愛撫で締め付け増加
	SIF COND("締め付けフラグ")
		TIMES TFLAG:倍率補正, 1.20
	;絶頂すると、締め付け増加
	SIF NOWEX:絶頂数合計
		TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, 100 + NOWEX:絶頂数合計*20)
	SIF INSERT("狂野摇摆")
		TIMES TFLAG:倍率補正, 1.50
	;PLAYERが童貞
	SIF EXP:PLAYER:Ｖ挿入経験 + EXP:PLAYER:Ａ挿入経験 == 0
		TIMES TFLAG:倍率補正, 3.00
	;EXP:Ａ性交経験をみる。経験が多くなると少し上がる
	IF TALENT:Ａ処女
		TIMES TFLAG:倍率補正, 1.50
	ELSE
		TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, 100 + GET_EXP_LV(EXP:Ａ性交経験) )
	ENDIF
	;阴茎の尺寸との差でBOUNS
	SELECTCASE ABL:Ａ拡張 - SIZE("阴茎", PLAYER)
	CASE IS <= 0
		TIMES TFLAG:倍率補正, 1.20
	CASE IS <= ABL:Ａ技術
		LOCAL = LIMIT(150 * BASE:体力 / MAXBASE:体力, 25, 100)
		TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, LOCAL)
	CASEELSE
		LOCAL = LIMIT(120 * BASE:体力 / MAXBASE:体力, 10, 100)
		TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, LOCAL)
	ENDSELECT

	SIF CHECK("Ａ完美契合")
		TIMES TFLAG:倍率補正, 1.10
CASE 83 TO 88
	;挿入中愛撫で締め付け増加
	SIF COND("締め付けフラグ")
		TIMES TFLAG:倍率補正, 1.20
	;絶頂すると、締め付け増加
	SIF NOWEX:絶頂数合計
		TFLAG:倍率補正 = MULTIPLY(TFLAG:倍率補正, 100 + NOWEX:絶頂数合計*20)
	SIF INSERT("狂野摇摆")
		TIMES TFLAG:倍率補正, 1.50
	;PLAYERが童貞
	SIF EXP:PLAYER:Ｖ挿入経験 + EXP:PLAYER:尿道挿入経験 == 0
		TIMES TFLAG:倍率補正, 3.00

	SIF CHECK("尿道完美契合")
		TIMES TFLAG:倍率補正, 1.10
;PLAYERのＡを刺激
CASE 96, 107, 109, 110, 125 TO 129
	;ABL:Ａ感覚をみる
	SELECTCASE ABL:PLAYER:Ａ感覚
	CASE 0
		TIMES TFLAG:倍率補正, 0.50
	CASE 1, 2
		TIMES TFLAG:倍率補正, 0.70
	CASE 3, 4
		TIMES TFLAG:倍率補正, 1.00
	CASE 5, 6
		TIMES TFLAG:倍率補正, 1.20
	CASE 7, 8
		TIMES TFLAG:倍率補正, 1.50
	CASEELSE
		TIMES TFLAG:倍率補正, 2.00
	ENDSELECT
	;PLAYヤーのEXP:Ａ経験をみる
	SELECTCASE EXP:PLAYER:Ａ経験
	CASE IS < 5
		TIMES TFLAG:倍率補正, 0.10
	CASE IS < 20
		TIMES TFLAG:倍率補正, 0.30
	CASE IS < 50
		TIMES TFLAG:倍率補正, 0.50
	CASE IS < 150
		TIMES TFLAG:倍率補正, 0.80
	ENDSELECT
	;敏感具合
	IF TALENT:PLAYER:尻穴狂い
		TIMES TFLAG:倍率補正, 2.00
	ELSEIF TALENT:PLAYER:Ａ性向
		TIMES TFLAG:倍率補正, 1.50
	ENDIF
	;PLAYヤーが男性
	SIF TALENT:PLAYER:男性
		TIMES TFLAG:倍率補正, 1.50
	;Ａ拡張具合による補正
	IF SELECTCOM == 107
		LOCAL = SIZE("Ａ振動棒", PLAYER) - ABL:PLAYER:Ａ拡張
		;緩い
		IF LOCAL <= -2
			TIMES TFLAG:倍率補正, 0.80
		;余裕有
		ELSEIF LOCAL == -1
			TIMES TFLAG:倍率補正, 1.20
		;余裕没有
		ELSE
			TFLAG:倍率補正 /= MAX(LOCAL*2, 1)
		ENDIF
	ENDIF
;PLAYERのＣを刺激
CASE 95, 98, 99
	IF TALENT:PLAYER:男性 == 0
		;ABL:Ｃ感覚をみる
		SELECTCASE ABL:PLAYER:Ｃ感覚
		CASE 0
			TIMES TFLAG:倍率補正, 0.50
		CASE 1, 2
			TIMES TFLAG:倍率補正, 0.70
		CASE 3, 4
			TIMES TFLAG:倍率補正, 1.00
		CASE 5, 6
			TIMES TFLAG:倍率補正, 1.20
		CASE 7, 8
			TIMES TFLAG:倍率補正, 1.50
		CASEELSE
			TIMES TFLAG:倍率補正, 2.00
		ENDSELECT
		;敏感具合
		IF TALENT:PLAYER:淫核
			TIMES TFLAG:倍率補正, 2.00
		ELSEIF TALENT:PLAYER:Ｃ性向
			TIMES TFLAG:倍率補正, 1.50
		ENDIF
	ENDIF
;PLAYERのＶを刺激
CASE 106, 108, 110, 120 TO 124
	;ABL:V感覚をみる
	SELECTCASE ABL:PLAYER:Ｖ感覚
	CASE 0
		TIMES TFLAG:倍率補正, 0.50
	CASE 1, 2
		TIMES TFLAG:倍率補正, 0.70
	CASE 3, 4
		TIMES TFLAG:倍率補正, 1.00
	CASE 5, 6
		TIMES TFLAG:倍率補正, 1.20
	CASE 7, 8
		TIMES TFLAG:倍率補正, 1.50
	CASEELSE
		TIMES TFLAG:倍率補正, 2.00
	ENDSELECT
	;PLAYヤーのEXP:Ｖ経験をみる
	SELECTCASE EXP:PLAYER:Ｖ経験
	CASE IS < 5
		TIMES TFLAG:倍率補正, 0.20
	CASE IS < 20
		TIMES TFLAG:倍率補正, 0.40
	CASE IS < 50
		TIMES TFLAG:倍率補正, 0.60
	CASE IS < 150
		TIMES TFLAG:倍率補正, 0.80
	ENDSELECT
	;敏感具合
	IF TALENT:PLAYER:淫壷
		TIMES TFLAG:倍率補正, 2.00
	ELSEIF TALENT:PLAYER:Ｖ性向
		TIMES TFLAG:倍率補正, 1.50
	ENDIF
	;Ｖ拡張具合による補正
	IF SELECTCOM == 106
		LOCAL = SIZE("振動棒", PLAYER) - ABL:PLAYER:Ｖ拡張
		;緩い
		IF LOCAL <= -2
			TIMES TFLAG:倍率補正, 0.80
		;余裕有
		ELSEIF LOCAL == -1
			TIMES TFLAG:倍率補正, 1.20
		;余裕没有
		ELSE
			TFLAG:倍率補正 /= MAX(LOCAL*2, 1)
		ENDIF
	ENDIF
;PLAYERのBを刺激
CASE 11, 102
	SELECTCASE ABL:PLAYER:Ｂ感覚
	CASE 0
		TIMES TFLAG:倍率補正, 0.50
	CASE 1, 2
		TIMES TFLAG:倍率補正, 0.70
	CASE 3, 4
		TIMES TFLAG:倍率補正, 1.00
	CASE 5, 6
		TIMES TFLAG:倍率補正, 1.20
	CASE 7, 8
		TIMES TFLAG:倍率補正, 1.50
	CASEELSE
		TIMES TFLAG:倍率補正, 2.00
	ENDSELECT
	;敏感具合
	IF TALENT:PLAYER:淫乳
		TIMES TFLAG:倍率補正, 2.00
	ELSEIF TALENT:PLAYER:Ｂ性向
		TIMES TFLAG:倍率補正, 1.50
	ENDIF
ENDSELECT



;部位特化能力。
SELECTCASE SELECTCOM
;舌を使う指令
CASE 6, 63, 73, 91, 96, 98, 99, 140, 150
	;蕩唇
	SIF TALENT:蕩唇
		TIMES TFLAG:倍率補正, 1.50
	;ABL:舌靈活をみる
	TFLAG:倍率補正 = SOURCE_EXABL(TFLAG:倍率補正, "舌靈活", TARGET)
;指を使う指令
CASE 90, 97
	;ABL:指靈活
	TFLAG:倍率補正 = SOURCE_EXABL(TFLAG:倍率補正, "指靈活", TARGET)
;胸を使う指令（例外的に胸を揉んだりするのもＯＫ）
CASE 64, 74, 81, 82, 92, 94, 104
	;淫乳
	SIF TALENT:淫乳
		TIMES TFLAG:倍率補正, 1.50
	;ABL:魔乳
	TFLAG:倍率補正 = SOURCE_EXABL(TFLAG:倍率補正, "魔乳", TARGET)
	;爆乳、巨乳、貧乳
	IF TALENT:巨乳 >= 3
		TIMES TFLAG:倍率補正, 2.00
	ELSEIF TALENT:巨乳 == 2
		TIMES TFLAG:倍率補正, 1.50
	ELSEIF TALENT:巨乳
		TIMES TFLAG:倍率補正, 1.20
	ELSEIF TALENT:貧乳
		TIMES TFLAG:倍率補正, 0.70
	ENDIF
;足を使う指令
CASE 95
	;ABL:指靈活
	TFLAG:倍率補正 = SOURCE_EXABL(TFLAG:倍率補正, "指靈活", TARGET)
;尻を使う指令
CASE TNUM("尻素股")
	IF TALENT:巨尻 >= 3
		TIMES TFLAG:倍率補正, 2.00
	ELSEIF TALENT:巨尻 == 2
		TIMES TFLAG:倍率補正, 1.50
	ELSEIF TALENT:巨尻
		TIMES TFLAG:倍率補正, 1.20
	ELSEIF TALENT:小尻
		TIMES TFLAG:倍率補正, 0.70
	ENDIF
ENDSELECT

;腰を使う指令
SELECTCASE SELECTCOM
CASE 1, 4, 9, 11, 16, 93, 94, TNUM("尻素股"), 120 TO 129
	;ABL:腰靈活
	TFLAG:倍率補正 = SOURCE_EXABL(TFLAG:倍率補正, "腰靈活", TARGET)
;騎乗位は性交系の中では腰靈活の影響が很强（腰靈活ＬＶが０だとペナルティ）
CASE 65, 75, 88
	;ABL:腰靈活
	IF ABL:腰靈活
		TFLAG:倍率補正 = SOURCE_EXABL(TFLAG:倍率補正, "腰靈活", TARGET)
	ELSE
		TIMES TFLAG:倍率補正, 0.70
	ENDIF
;騎乗位以外の性交系はちょい弱め(刺激挿入部位系は腰靈活の影響无)
CASE 60 TO 64, 70 TO 74, 83 TO 87
	TFLAG:倍率補正 += (SOURCE_EXABL(TFLAG:倍率補正, "腰靈活", TARGET) - TFLAG:倍率補正)/3
ENDSELECT

;アシスタント能力
IF TEQUIP:MASTER:小悪魔の轻语 && TEQUIP:甜言蜜语
	TIMES TFLAG:倍率補正, 1.20
ELSEIF TEQUIP:PLAYER:撒娇鬼
	;胸をいじられた場合のみ感度上昇
	SELECTCASE TRAINNAME:SELECTCOM
	CASE "给对方乳交", "胸爱抚奉侍"
		TIMES TFLAG:倍率補正, 1.20
	ENDSELECT
ENDIF
;疲労状態だとペナルティ
SIF COND("疲労")
	TFLAG:倍率補正 /= 2

;-------------------------------------------------
;射精部位の強制変更
;ここでの変更不可は、射精部位を選ぶ部分のみ影響する
;-------------------------------------------------
@SET_SHOOT, ARG, ARGS
SELECTCASE ARGS
CASE "髪"
	TCVAR:ARG:想要射精的位置 = 1
CASE "顔"
	TCVAR:ARG:想要射精的位置 = 2
CASE "口"
	TCVAR:ARG:想要射精的位置 = 3
CASE "胸"
	TCVAR:ARG:想要射精的位置 = 4
CASE "股間"
	TCVAR:ARG:想要射精的位置 = 5
CASE "お腹"
	TCVAR:ARG:想要射精的位置 = 6
CASE "お尻"
	TCVAR:ARG:想要射精的位置 = 7
CASE "ぶっかけ"
	TCVAR:ARG:想要射精的位置 = RAND:7 + 1

CASE "鼻の穴"
	TCVAR:ARG:想要射精的位置 = 8

CASE "変更不可", "このまま"
	TCVAR:ARG:想要射精的位置 = 99
ENDSELECT
TCVAR:ARG:射精部位の強制変更 = 1

;-------------------------------------------------
;射精部位
;PLAYERが默认。省略可能。
;-------------------------------------------------
@SHOOT(ARGS, ARG)
#FUNCTION
SIF ARG == 0 && PLAYER > 0
	ARG = PLAYER
SIF ARGS == "こらえた" && NOWEX:ARG:绝顶忍耐
	RETURNF 1
SIF COND("絶頂", ARG) == 0
	RETURNF 0
SELECTCASE ARGS
CASE "髪"
	SIF TCVAR:ARG:想要射精的位置 == 1
		RETURNF 1
CASE "顔"
	SIF TCVAR:ARG:想要射精的位置 == 2
		RETURNF 1
CASE "口"
	SIF TCVAR:ARG:想要射精的位置 == 3 || (TCVAR:ARG:想要射精的位置 == 0 && TCVAR:ARG:PLAY区分メイン == 1)
		RETURNF 1
CASE "胸"
	SIF TCVAR:ARG:想要射精的位置 == 4 || (TCVAR:ARG:想要射精的位置 == 0 && TCVAR:ARG:PLAY区分メイン == 5) || (TCVAR:ARG:想要射精的位置 == 0 && TCVAR:ARG:PLAY区分メイン == 18)
		RETURNF 1
CASE "股間"
	SIF TCVAR:ARG:想要射精的位置 == 5
		RETURNF 1
CASE "くぱぁ"
	;くぱぁ中
	IF SELECTCOM == 13 || COND("両穴くぱぁ") || TEQUIP:PLAYER:自慰 == 13
		SIF TCVAR:ARG:想要射精的位置 == 5
			RETURNF 1
	ENDIF
CASE "お腹"
	SIF TCVAR:ARG:想要射精的位置 == 6
		RETURNF 1
CASE "お尻"
	SIF TCVAR:ARG:想要射精的位置 == 7
		RETURNF 1
CASE "鼻の穴"
	SIF TCVAR:ARG:想要射精的位置 == 8
		RETURNF 1
CASE "Ａくぱぁ"
	;Ａくぱぁ中
	IF SELECTCOM == 14 || COND("両穴くぱぁ") || TEQUIP:PLAYER:自慰 == 14
		SIF TCVAR:ARG:想要射精的位置 == 6 || TCVAR:ARG:想要射精的位置 == 7
			RETURNF 1
	ENDIF
CASE "ぶっかけ"
	SELECTCASE TCVAR:ARG:想要射精的位置
	CASE 1, 2, 5, 6, 7, 8
		RETURNF 1
	ENDSELECT
CASE "外"
	SIF TCVAR:ARG:想要射精的位置 && TCVAR:ARG:想要射精的位置 <= 8
		RETURNF 1
CASE "変更不可"
	SIF TCVAR:ARG:想要射精的位置 == 99
		RETURNF 1
CASE "就这様"
	SIF TCVAR:ARG:想要射精的位置 == 0
		RETURNF 1
CASE "口淫"
	SIF TCVAR:ARG:PLAY区分メイン == 1
		RETURNF 1
CASE "手"
	SIF TCVAR:ARG:PLAY区分メイン == 2
		RETURNF 1
CASE "ぱんつ"
	SIF TCVAR:ARG:PLAY区分メイン == 2 && SELECTCOM == 97
		RETURNF 1
CASE "飞机杯"
	SIF TCVAR:ARG:PLAY区分メイン == 2 && SELECTCOM == 105
		RETURNF 1
CASE "中出し"
	SIF TCVAR:ARG:想要射精的位置 == 0 && (TCVAR:ARG:PLAY区分メイン == 3 || TCVAR:ARG:PLAY区分メイン == 4 || TCVAR:ARG:PLAY区分メイン == 19)
		RETURNF 1
CASE "自分以外に中出し"
	SIF TCVAR:ARG:想要射精的位置 == 0 && (TCVAR:ARG:PLAY区分サブ == 3 || TCVAR:ARG:PLAY区分サブ == 4 || TCVAR:ARG:PLAY区分サブ == 19)
		RETURNF 1
CASE "膣内"
	SIF TCVAR:ARG:PLAY区分メイン == 3
		RETURNF 1
	SIF COND("性欲解消実行中") && STR:PLAY内容 == "Ｖ性交" && COND("女性主導生性交", ARG)
		RETURNF 1
CASE "Ｖ中出し"
	SIF TCVAR:ARG:想要射精的位置 == 0 && TCVAR:ARG:PLAY区分メイン == 3
		RETURNF 1
CASE "肛門"
	SIF TCVAR:ARG:PLAY区分メイン == 4
		RETURNF 1
CASE "Ａ中出し"
	SIF TCVAR:ARG:想要射精的位置 == 0 && TCVAR:ARG:PLAY区分メイン == 4
		RETURNF 1
	SIF COND("性欲解消実行中") && STR:PLAY内容 == "Ａ性交"
		RETURNF 1
CASE "乳交"
	SIF TCVAR:ARG:PLAY区分メイン == 5
		RETURNF 1
CASE "脚"
	SIF TCVAR:ARG:PLAY区分メイン == 6
		RETURNF 1
CASE "兜合わせ"
	SIF TCVAR:ARG:PLAY区分メイン == 7 && SELECTCOM == 16
		RETURNF 1
CASE "尻素股"
	SIF TCVAR:ARG:PLAY区分メイン == 7 && SELECTCOM == TNUM("尻素股")
		RETURNF 1
CASE "素股"
	SIF TCVAR:ARG:PLAY区分メイン == 7
		RETURNF 1
CASE "接吻"
	SIF TCVAR:ARG:PLAY区分メイン == 8
		RETURNF 1
CASE "逆舐陰"
	SIF TCVAR:ARG:PLAY区分メイン == 9
		RETURNF 1
CASE "逆強姦"
	SIF TCVAR:ARG:PLAY区分メイン == 10
		RETURNF 1
CASE "逆肛交"
	SIF TCVAR:ARG:PLAY区分メイン == 11
		RETURNF 1

CASE "面部騎乗"
	SIF TCVAR:ARG:PLAY区分メイン == 14
		RETURNF 1
CASE "肛門奉仕"
	SIF TCVAR:ARG:PLAY区分メイン == 15
		RETURNF 1
CASE "ＶＡ舐め"
	SIF TCVAR:ARG:PLAY区分メイン == 16
		RETURNF 1
CASE "洗面奶"
	SIF TCVAR:ARG:PLAY区分メイン == 17
		RETURNF 1
CASE "乳頭奸"
	SIF TCVAR:ARG:PLAY区分メイン == 18
		RETURNF 1
CASE "乳内中出し"
	SIF TCVAR:ARG:想要射精的位置 == 0 && TCVAR:ARG:PLAY区分メイン == 18
		RETURNF 1
CASE "尿道"
	SIF TCVAR:ARG:PLAY区分メイン == 19
		RETURNF 1
CASE "尿道中出し"
	SIF TCVAR:ARG:想要射精的位置 == 0 && TCVAR:ARG:PLAY区分メイン == 19
		RETURNF 1
CASE "自慰"
	SIF TCVAR:ARG:PLAY区分メイン == 20
		RETURNF 1

CASE "乳交奉仕"
	SIF TCVAR:ARG:PLAY区分メイン == 21
		RETURNF 1
		
CASE "逆Ａ振動棒"
	SIF TCVAR:ARG:PLAY区分メイン == 22
		RETURNF 1

CASE "調教者が女性"
	SIF TCVAR:ARG:PLAY区分メイン >= 30 && TCVAR:ARG:PLAY区分メイン <= 49
		RETURNF 1

CASE "助手"
	SIF TCVAR:ARG:PLAY区分メイン >= 50 && TCVAR:ARG:PLAY区分メイン <= 59
		RETURNF 1
CASE "助手の膣内"
	SIF TCVAR:ARG:PLAY区分メイン == 50
		RETURNF 1
CASE "助手の肛門"
	SIF TCVAR:ARG:PLAY区分メイン == 51
		RETURNF 1
CASE "助手の口"
	SIF TCVAR:ARG:PLAY区分メイン == 52
		RETURNF 1

CASE "強制変更"
	SIF TCVAR:ARG:射精部位の強制変更
		RETURNF 1
CASE "なぶられ中"
	SELECTCASE TCVAR:ARG:PLAY区分メイン
	CASE 8 TO 11, 14 TO 17
		RETURNF 1
	ENDSELECT
ENDSELECT
RETURNF 0

;-------------------------------------------------
;助手のPLAYに対する射精部位
;-------------------------------------------------
@SHOOT_A(ARGS, ARG)
#FUNCTION
SIF ARG == 0 && PLAYER > 0
	ARG = PLAYER
SWAP TCVAR:PLAYER:PLAY区分メイン, TCVAR:PLAYER:PLAY区分サブ
LOCAL = SHOOT(ARGS, ARG)
SWAP TCVAR:PLAYER:PLAY区分メイン, TCVAR:PLAYER:PLAY区分サブ
RETURNF LOCAL

@SAMEN_AND_EXTACY
;消費道具指令では起こさない
SIF ITEM_PLAY()
	RETURN 0

CALL SETFLAG, "射精＆絶頂格子", PLAYER
;３Ｐ
IF COND("３Ｐ")
	CALL SETFLAG, "調教者交代"
	CALL SETFLAG, "射精＆絶頂格子", PLAYER
	CALL SETFLAG, "調教者交代"
ENDIF

;PLAYERに阴茎があるなら、どこに射精したかor我慢したかのTFLAGをここで設定する。
;３Ｐなら変更不可とする（今後変更可能にするかも）
IF PENIS(PLAYER) && COND("絶頂", PLAYER) && COND("３Ｐ") == 0 && COND("射精禁止中", PLAYER) == 0
	;精液箇所変更可能判定フラグ。基本値は腰靈活。
	;TFLAG:余裕が2以上ならば、余裕有と判定されます。
	;4以上ならば、@SHOOT_CHANGEにおいて「忍住」が選択できる。

	;精力と技巧ＬＶに応じて猶予
	TFLAG:余裕 = LIMIT(ABL:PLAYER:技巧, 0, 5) + 4 - 4*BASE:PLAYER:精力/MAXBASE:PLAYER:精力

	;限界突破
	SELECTCASE BASE:PLAYER:快感許容値男性
	CASE IS >= MAXBASE:PLAYER:快感許容値男性*3
		TFLAG:余裕 = 0
	CASE IS >= MAXBASE:PLAYER:快感許容値男性
		;精力ＭＡＸ(-3or-6)、精力が９割以上（-2or-4）、３割以上で分岐(-1or-2)
		SELECTCASE 100 * BASE:PLAYER:精力 / MAXBASE:PLAYER:精力
		CASE IS >= 100
			TFLAG:余裕 -= BASE:PLAYER:快感許容値男性 / MAXBASE:PLAYER:快感許容値男性 * 3
		CASE IS >= 90
			TFLAG:余裕 -= BASE:PLAYER:快感許容値男性 / MAXBASE:PLAYER:快感許容値男性 * 2
		CASE IS >= 30
			TFLAG:余裕 -= BASE:PLAYER:快感許容値男性 / MAXBASE:PLAYER:快感許容値男性
		ENDSELECT
	CASE IS >= MAXBASE:PLAYER:快感許容値男性/2
		TFLAG:余裕 += 2
	CASEELSE
		TFLAG:余裕 += 4
	ENDSELECT
	;前回こらえた
	SIF EX:PLAYER:绝顶忍耐
		TFLAG:余裕 -= 1 + RAND:5

	;射精部位を選べる指令か？
	SELECTCASE TCVAR:PLAYER:PLAY区分メイン
	CASE 1 TO 7
		;余裕がない！
		SIF TFLAG:余裕 < 2
			TFLAG:余裕 = 0
	;自慰
	CASE 20
		TFLAG:余裕 = 1
	CASEELSE
		TFLAG:余裕 = 0
		SIF TEQUIP:PLAYER:自慰
			TFLAG:余裕 = 1
	ENDSELECT

	;射精部位変更を許さない指令はここに記述。今後変更される可能性大。
	SELECTCASE SELECTCOM
	CASE 66, 67, 68, 96, 105, 160
		TFLAG:余裕 = 0
	ENDSELECT

	SIF TEQUIP:六九式 || CHECK_COM("洗面奶手交") || CHECK_COM("玩弄Ａ手交")
		TFLAG:余裕 = 0
	;射精部位変更OFFor恍惚or脫力or口上での射精部位決定
	SIF SHOOT("強制変更") || STATE("恍惚", PLAYER) || STATE("脫力", PLAYER)
		TFLAG:余裕 = 0

	;股間にかけた時には、VA両方に汚れがつくものとする。
	;射精部位変更フラグが立っていて、二人に被逆推て無いなら、ここで変更。
	IF TFLAG:余裕 && TEQUIP:Ｗ推倒 == 0 && CALCF("射精部位の自動選択") == 0
		CALL SHOOT_CHANGE
	ELSEIF COND("射精部位変更", PLAYER)
		IF SHOOT("外")

		ELSEIF SHOOT("変更不可")
			TCVAR:PLAYER:想要射精的位置 = 0
		ENDIF
	ENDIF
ENDIF

;射精or絶頂
IF COND("絶頂", PLAYER) || (COND("３Ｐ") && COND("絶頂", PLAYER:1) )
	;射精選択直後～射精の地の文間の口上
	CALL KOJO_MESSAGE_AFTERSHOOTCHANGE

	;挿入解除など
	SELECTCASE TCVAR:PLAYER:想要射精的位置
	CASE 1 TO 8
		CALL RESET_INSERT, TARGET, PLAYER
		TEQUIP:深喉 = 0
	CASEELSE
		SIF SHOOT("外")
			CALL RESET_INSERT, TARGET, PLAYER
	ENDSELECT

	CALL CALC, "同時絶頂"

	IF COND("絶頂", PLAYER)
		SIF STATE("バインド：Ｐ", PLAYER)
			PRINTFORML %CALLNAME:PLAYER%異常高扬的射精欲打破了拘束、開始射精！
		PRINTFORML %TEXTS("絶頂", PLAYER)%
	ENDIF
	SIF COND("３Ｐ") && COND("絶頂", PLAYER:1)
		PRINTFORML %TEXTS("絶頂", PLAYER:1)%

	;絶頂した時のテ接吻トを出力します。
	IF COND("絶頂", PLAYER)
		CALL SAMEN_SHOOT_MESSAGE
	ELSE
		CALL SETFLAG, "調教者交代"
		CALL SAMEN_SHOOT_MESSAGE
		CALL SETFLAG, "調教者交代"
	ENDIF

	IF COND("絶頂", PLAYER)
		CALL CALC, "絶頂させた処理", TARGET
		;W推倒
		SIF SELECTCOM:1 >= 0
			CALL CALC, "絶頂させた処理", TARGET:1
		CALL CALC, "絶頂した処理", PLAYER
	ENDIF
	IF COND("３Ｐ") && COND("絶頂", PLAYER:1)
		CALL SETFLAG, "調教者交代"
		CALL CALC, "絶頂させた処理", TARGET
		CALL CALC, "絶頂した処理", PLAYER
		CALL SETFLAG, "調教者交代"
	ENDIF

	;受精確率の変動を表示
	CALL CHECK_NINSHIN_ALLACTOR

	;効果を及ぼすのはメインPLAYヤー一人のみ
	CALL ENERGY_DRAIN
ELSE
	IF COND("射精禁止中", PLAYER)
		PRINTFORMW %CALLNAME:PLAYER%堵住了尿道、无法射精！
	ELSEIF COND("焦躁中", PLAYER)
		PRINTFORMW %CALLNAME:PLAYER%正挑逗着%CALLNAME:TARGET%\@ SELECTCOM:1 >= 0 ? 们 # \@！
	ELSEIF EX:PLAYER:绝顶忍耐

	;こらえていない＆要去了
	ELSEIF EX:PLAYER:绝顶忍耐 == 0 && BASE:PLAYER:絶頂 >= MAXBASE:PLAYER:絶頂*4/5 && TCVAR:PLAYER:絶頂開始前 != BASE:PLAYER:絶頂
		PRINTFORMW %CALLNAME:PLAYER%快要到极限了的様子……
	ENDIF
ENDIF

;嘔吐発生？
IF COND("射精後嘔吐")
	CALL SETFLAG, "強制口交で嘔吐"
;奉仕精神ＬＶ２以上、技巧ＬＶ２以上で実行値を30以上上回っているなら汚れをなめ取る
ELSEIF ABL:奉仕精神 > MAX(1, RAND:5) && ABL:技巧 >= 2 && SHOOT("口") && TCVAR:干劲 >= 30 && STAIN:PLAYER:Ｐ != SET_STAIN(0, "Ｐ")
	SIF COND("絶頂", PLAYER) && TFLAG:清洁口交 == 0 && ABL:奉仕精神 > RAND:5 && (COND("Ｐ汚れの相手", PLAYER) != TARGET || RAND:3 == 0)
		TFLAG:清洁口交 = 1
ENDIF


@SHOOT_CHANGE
#DIM CHOICE
#DIM IS_SHOOT_SELECT, 100
#DIM MEMO_LINECOUNT

;射精部位が選択できるかの判定に使う
VARSET IS_SHOOT_SELECT
IS_SHOOT_SELECT:0 = 1
IS_SHOOT_SELECT:1 = 1
IS_SHOOT_SELECT:2 = 2
SIF SHOOT("口") + SHOOT("脚") + SHOOT("素股") == 0
	IS_SHOOT_SELECT:3 = 3
SIF SHOOT("胸") == 0
	IS_SHOOT_SELECT:4 = 4
SIF TALENT:男性 == 0
	IS_SHOOT_SELECT:5 = 5
SIF INSERT("挿入") || SELECTCOM == 14 || COND("両穴くぱぁ") || TEQUIP:PLAYER:自慰 == 14
	IS_SHOOT_SELECT:6 = 6
SIF SHOOT("口") +  SHOOT("胸") && TEQUIP:鼻钩 && TEQUIP:推倒 == 0 && ABL:PLAYER:施虐属性
	IS_SHOOT_SELECT:7 = 7
SIF COND("忍住", PLAYER)
	IS_SHOOT_SELECT:99 = 99

SIF TEQUIP:PLAYER:避孕套 && IS_SHOOT_SELECT:99 == 0
	RETURN 0

PRINTFORML 
IF EX:PLAYER:绝顶忍耐
	IF TEQUIP:推倒
		PRINTFORM 不断的挑逗推动着射精的冲动
	ELSE
		PRINTFORM 尽管刚才勉强忍住了、
	ENDIF
ENDIF
PRINTFORM %CALLNAME:PLAYER%的阴茎
IF BASE:PLAYER:絶頂 >= EJAC:PLAYER * 2
	PRINTFORM 膨張膨胀到了极限、
ELSE
	PRINTFORM 无比得勃起着、
ENDIF
PRINTFORMW 已经马上就要射精\@ TEQUIP:推倒 ? 的様子 # 了 \@……

MEMO_LINECOUNT = LINECOUNT

;射精前の口上
IF COND("だいしゅきホールド可能") && RAND:7 == 0
	PRINTFORML 
	;CALL PRINT_STRL, @"爱心粉紅_＜強制腿锁扣身姿势発生＞_爱心粉紅_"
	CALL PRINT_STRL, @"爱心粉紅_＜強制中出し発生＞_爱心粉紅_"
	SELECTCASE RAND:5
		CASE 4
			PRINTFORML %CALLNAME:TARGET%紧紧抓住%CALLNAME:MASTER%的身体、用力地将身体压在阴茎上……
		CASE 3
			PRINTFORML 察觉到%CALLNAME:MASTER%快要射精的瞬间、%CALLNAME:TARGET%用%TEXTR("非常凶猛的气势/非常大的力气")%抱紧了%CALLNAME:MASTER%的身体……
		CASE 2
			PRINTFORML %CALLNAME:TARGET%一边在耳边说着爱意、一边用双腿勾住了%CALLNAME:MASTER%不让阴茎拔出去……
		CASE 1
			PRINTFORML 察觉到了射精预兆的瞬间、%CALLNAME:TARGET%的腿缠了上来……
		CASE 0
			PRINTFORML 察觉到了%CALLNAME:MASTER%的绝顶的%CALLNAME:TARGET%、用尽剩余的力气用腿钩住了%CALLNAME:MASTER%的腰压下来……
	ENDSELECT
	PRINTFORMW ……%CALLNAME:MASTER%没法拔出来！

	MEMO_LINECOUNT = LINECOUNT

	CALL KOJO_MESSAGE_DAISYUKI

	CHOICE = 0

	SIF LINECOUNT > MEMO_LINECOUNT
		PRINTL 
ELSE
	CALL KOJO_MESSAGE_SHOOT

	SIF LINECOUNT > MEMO_LINECOUNT
		PRINTL 
	IF TEQUIP:PLAYER:避孕套
		PRINTFORMW \@ TEQUIP:推倒 ? 该怎么办呢 # 该怎么办呢 \@？

		PRINTFORML  [ 0] \@ TEQUIP:推倒 ? 让其射精 # 射精 \@
		PRINTFORML  [ 1] \@ TEQUIP:推倒 ? 让其再继续忍耐 # 忍耐 \@

		CALL INPUT_SELECT, 2
		IF RESULT == 0
			CHOICE = 0
		ELSE
			CHOICE = 99
		ENDIF
	ELSE
		PRINTFORMW \@ TEQUIP:推倒 ? 让其在哪里射精 # 要在%CALLNAME:TARGET%的哪里射精 \@？

		PRINTFORM  [ 0] 就这様
		IF SHOOT("胸")
			SELECTCASE SELECTCOM
			CASE 81
				PRINTFORM 在胸部上一边继续侵犯一边
			CASE 82
				PRINTFORM 在胸部里面
			CASEELSE
				PRINTFORM 在胸\@ TEQUIP:推倒 ? 上 # 部上一边继续侵犯一边 \@
			ENDSELECT
		ELSEIF SHOOT("口")
			IF TEQUIP:深喉
				PRINTFORM 在喉咙的深处
			ELSE
				PRINTFORM 在嘴里
			ENDIF
		ELSEIF SHOOT("手")
			PRINTFORM \@ SELECTCOM == 97 ? %CLO("内褲冲")%里 # 在手上 \@
		ELSEIF SHOOT("膣内")
			IF COND("子宮挿入フラグ")
				PRINTFORM 在子宮内
			ELSEIF SIZE("阴茎", PLAYER) >= 2 && CHECK_COM("完全挿入可能", INSERT("対応指令") )
				PRINTFORM 阴道的深处
			ELSE
				PRINTFORM 在膣内
			ENDIF
		ELSEIF SHOOT("肛門")
			IF CHECK_COM("結腸責め")
				PRINTFORM 在Ｓ状結腸内
			ELSEIF SIZE("阴茎", PLAYER) >= 2 && CHECK_COM("完全挿入可能", INSERT("対応指令") )
				PRINTFORM 直腸の奥深くに
			ELSE
				PRINTFORM 在腸内
			ENDIF
		ELSEIF SHOOT("脚")
			PRINTFORM 在脚上
		ELSEIF SHOOT("尻素股")
			PRINTFORM 尻部に
		ELSEIF SHOOT("素股")
			PRINTFORM 在身体上
		ELSEIF SHOOT("自慰")
			IF TEQUIP:野外PLAY
				PRINTFORM 在地面上
			ELSE
				PRINTFORM 在床上
			ENDIF
		ENDIF
		SIF COND("濃厚射精", PLAYER)
			PRINT 濃いのを
		PRINTFORML \@ TEQUIP:推倒 ? 射出来 # 射出来 \@

		PRINTFORML  [ 1] 髪
		PRINTFORML  [ 2] 顔
		SIF IS_SHOOT_SELECT:3
			PRINTFORML  [ 3] 口
		SIF IS_SHOOT_SELECT:4
			PRINTFORML  [ 4] 胸
		IF IS_SHOOT_SELECT:5
			IF SELECTCOM == 13 || COND("両穴くぱぁ") || TEQUIP:PLAYER:自慰 == 13
				PRINTFORML  [ 5] 自己掰開的阴部
			ELSE
				PRINTFORML  [ 5] 股間
			ENDIF
		ENDIF
		IF IS_SHOOT_SELECT:6
			IF SELECTCOM == 14 || COND("両穴くぱぁ") || TEQUIP:PLAYER:自慰 == 14
				PRINTFORML  [ 6] 自己掰開的菊穴
			ELSE
				PRINTFORML  [ 6] \@ INSERT("後背位") + INSERT("背面座位") ? 屁股 # 肚子 \@
			ENDIF
		ENDIF
		SIF IS_SHOOT_SELECT:7
			PRINTFORML  [ 7] 広開的鼻穴
		SIF IS_SHOOT_SELECT:99
			PRINTFORML  [99] \@ TEQUIP:推倒 ? 不让其射精 # 忍住 \@

		CALL INPUT_SELECT, 3, IS_SHOOT_SELECT:3, IS_SHOOT_SELECT:4, IS_SHOOT_SELECT:5, IS_SHOOT_SELECT:6, IS_SHOOT_SELECT:7, IS_SHOOT_SELECT:90, IS_SHOOT_SELECT:99
		CHOICE = RESULT
	ENDIF
ENDIF
;CHOICE == 0なら変化无
SELECTCASE CHOICE
CASE 0 TO 5
	TCVAR:PLAYER:想要射精的位置 = CHOICE
CASE 6
	IF INSERT("後背位") || INSERT("背面座位")
		TCVAR:PLAYER:想要射精的位置 = 7
	ELSE
		TCVAR:PLAYER:想要射精的位置 = 6
	ENDIF
CASE 7
	TCVAR:PLAYER:想要射精的位置 = 8
CASE 90
	TCVAR:PLAYER:想要射精的位置 = 90
	TCVAR:PLAYER:PLAY区分メイン = 0
CASE 99
	IF TEQUIP:推倒
		PRINTFORMW %CALLNAME:PLAYER%正在被挑逗着！
	ELSE
		PRINTFORMW %CALLNAME:PLAYER%忍住了\@ PENIS(PLAYER) ? 射精 # 绝顶 \@！
	ENDIF
	CALL KOJO_COUNTER, "绝顶忍耐"

	EX:PLAYER:绝顶忍耐 += 1
	NOWEX:PLAYER:绝顶忍耐 = 1
	TCVAR:PLAYER:PLAY区分メイン = 0
	TCVAR:PLAYER:絶頂度 = 0
ENDSELECT

;３Ｐなど複数人が調教側のときには、相方はPLAYER:1となっている
;ARGに角色番号が代入されている場合にはARGを一時的にTARGETと交換する
@SAMEN_SHOOT_MESSAGE, ARG
SIF ARG > 0
	SWAP ARG, TARGET

IF PENIS(PLAYER) == 0
	CALL EXTACY_MESSAGE
	SIF ARG > 0
		SWAP ARG, TARGET
	RETURN 0
ENDIF

;まずは、换地方段階のテ接吻ト
IF SHOOT("就这様") == 0 && COND("射精部位変更", PLAYER) == 0
	IF TEQUIP:推倒
		IF SHOOT("口淫")
			PRINTFORM 在%CALLNAME:PLAYER%快要射精之前%CALLNAME:TARGET%将
			SIF COND("深喉フラグ")
				PRINTFORM 刚刚还直到根部为止全部吞入的
			PRINTFORM 阴茎上从嘴里挪開、
		ELSEIF SHOOT("手")
			PRINTFORM %CALLNAME:TARGET%一边撸动着阴茎一边诱导着方向、
		ELSEIF SHOOT("膣内")
			PRINTFORM 在%CALLNAME:PLAYER%即将射精之前%CALLNAME:TARGET%抬起腰放開了体内的阴茎、
		ELSEIF SHOOT("肛門")
			PRINTFORM 在%CALLNAME:PLAYER%即将射精之前%CALLNAME:TARGET%抬起腰放開了体内的阴茎、
		ELSEIF SHOOT("乳交")
			PRINTFORM 在%CALLNAME:PLAYER%即将射精之前%CALLNAME:TARGET%停止了乳交、
		;ELSEIF SHOOT("脚")
		;	PRINTFORM %CALLNAME:PLAYER%一边用阴茎摩擦着脚一边浮起了腰、
		ELSE
			PRINTFORM 在%CALLNAME:PLAYER%射精之前%CALLNAME:TARGET%改变了自己的姿势、
		ENDIF
	ELSEIF SHOOT("口淫")
		IF SELECTCOM == 140
			PRINTFORM %CALLNAME:PLAYER%将
			IF COND("深喉フラグ") && SIZE("阴茎", PLAYER) >= 3
				PRINTFORM 食道
			ELSE
				PRINTFORM 口
			ENDIF
			PRINTFORM 中的阴茎拔出、
		ELSE
			PRINTFORM %CALLNAME:PLAYER%让%CALLNAME:TARGET%停止了舔舐、
		ENDIF
	ELSEIF SHOOT("手")
		PRINTFORM %CALLNAME:PLAYER%一边享受着手交一边调整方向、
	ELSEIF SHOOT("膣内")
		PRINTFORM %CALLNAME:PLAYER%从秘缝中拔出阴茎、
	ELSEIF SHOOT("肛門")
		PRINTFORM %CALLNAME:PLAYER%从肛門中拔出阴茎、
	ELSEIF SHOOT("乳交")
		IF TRAINNAME:SELECTCOM == "雙乳間抽插"
			PRINTFORM %CALLNAME:PLAYER%挺腰把龟頭从乳房中露出来、
		ELSE
			PRINTFORM %CALLNAME:PLAYER%让%CALLNAME:TARGET%停止了乳交、
		ENDIF
	;ELSEIF SHOOT("脚")
	;	PRINTFORM %CALLNAME:PLAYER%一边用阴茎摩擦着脚一边浮起了腰、
	ELSEIF SHOOT("自慰")
		PRINTFORM %CALLNAME:PLAYER%一边撸动着一边调整方向、
	ELSE
		PRINTFORM %CALLNAME:PLAYER%改变自己的姿势、
	ENDIF
ELSEIF SHOOT("就这様") == 0 && COND("射精部位変更", PLAYER)
	IF TEQUIP:推倒
		PRINTFORM %CALLNAME:TARGET%
	ENDIF
ENDIF
;以下実際にかかった部位を焦点としたテ接吻ト
;ぶっかけは必ず射精部位の変更が起きている
IF SHOOT("ぶっかけ")
	IF SHOOT("髪")
		;角
		IF TALENT:角 && RAND:2 == 0
			IF TEQUIP:推倒
				PRINTFORML 让精液浇在了自己的角上
				PRINTFORMW 而且、用%TEXTR("光滑的/美丽的")%角摩擦着阴茎、将浓厚的精液涂在上面…
			ELSE
				PRINTFORML 浇在了%CALLNAME:TARGET%的角上
				PRINTFORMW 而且、用阴茎摩擦着%TEXTR("光滑的/美丽的")%角将浓厚的精液涂抹在上面…
			ENDIF
		;天使の輪
		ELSEIF COND("種族：天使") + COND("種族：死神") && (RAND:3 == 0 || COND("絶頂", PLAYER) >= 3)
			IF TEQUIP:推倒
				PRINTFORMW 让精液浇在了自己的光环上
				PRINTFORMW 实际上是不可能弄脏的、但是因为这种背德的行为而感觉非常兴奋…
			ELSE
				PRINTFORMW 浇在了%CALLNAME:TARGET%的光环上
				PRINTFORMW 实际上是不可能弄脏的、但是因为这种背德的行为而感觉非常兴奋…
			ENDIF
		ELSE
			IF TEQUIP:推倒
				PRINTFORML 浇在了自己的頭发上
			ELSE
				PRINTFORML 浇在了%CALLNAME:TARGET%的頭发上
			ENDIF
			IF RAND:2 == 0
				PRINTFORMW 妖艳秀丽的頭发、与浓厚的精液缠在一起……
			ELSE
				PRINTFORMW 而且、用頭发卷起%TEXTS("气味")%被精液弄脏的阴茎擦拭着…
			ENDIF
		ENDIF
	ELSEIF SHOOT("顔")
		IF TEQUIP:推倒
			PRINTFORM 自己的
		ELSE
			IF SELECTCOM == 140
				IF (ABL:PLAYER:施虐属性 >= 3 || ABL:奉仕精神 >= 5) && RAND:3 == 0
					PRINTFORM 已经剧烈的强制口交而冒出众多白沫流出口水的
				ELSEIF ABL:喉拡張 <= SIZE("阴茎", PLAYER) && RAND:2
					IF RAND:2 || EXP:口交経験 >= 150
						PRINTFORM 毫不留情的喉
					ELSE
						PRINTFORM 经验不足的喉
					ENDIF
					IF RAND:3 == 0
						PRINTFORM 被摩擦着
					ELSEIF RAND:2
						PRINTFORM 被突刺着
					ELSE
						PRINTFORM 被侵犯着
					ENDIF
					IF RAND:3 == 0
						PRINTFORM 润湿了双目的
					ELSEIF RAND:2
						PRINTFORM 泪目的
					ELSE
						PRINTFORM 快要呕吐了一样的
					ENDIF
				ELSEIF ABL:喉拡張 > SIZE("阴茎", PLAYER) && ABL:受虐属性 >= 3 && RAND:2
					PRINTFORM 因为剧烈的PLAY而慌乱地喘息着的
				ENDIF
			ELSEIF TALENT:好奇心 && RAND:2
				PRINTFORM 饶有兴致地观察着阴茎的
			ENDIF
			PRINTFORM %CALLNAME:TARGET%的
		ENDIF
		IF RAND:3 && CHECK_OTHER("眼鏡")
			PRINTFORM 眼鏡
		ELSE
			PRINTFORM 脸上
		ENDIF
		IF COND("絶頂", PLAYER) >= 3 && RAND:3 == 0
			PRINTFORMW \@ TEQUIP:推倒 ? 被 #  \@没有一丝遗漏地涂上了大量的白浊液…
		ELSEIF COND("絶頂", PLAYER) >= 2 && RAND:3 == 0
			PRINTFORMW \@ TEQUIP:推倒 ? 被 #  \@非常有气势地喷上了精液…
		ELSEIF RAND:2
			PRINTFORMW \@ TEQUIP:推倒 ? 被浇上了 # 泄出了 \@%TEXTS("精液", PLAYER)%…
		ELSE
			PRINTFORMW \@ TEQUIP:推倒 ? 被 #  \@仔细地瞄准之后射精了…
		ENDIF
		IF TALENT:淫乱 + TALENT:恋慕 + TEQUIP:媚薬 && RAND:4
			PRINTFORM %CALLNAME:TARGET%
			IF RAND:2
				PRINTFORM 将有气势地飞溅出的\@ COND("絶頂", PLAYER) >= 2 ? 大量 # \@精液、
				IF CHECK_OTHER("眼鏡") && RAND:3
					PRINTFORM 像是完全不在意眼镜会被弄脏一样
				ELSE
					PRINTFORM 张着嘴
				ENDIF
				PRINTFORMW 用脸全部接住了…
			ELSE
				IF CHECK_OTHER("眼鏡") && RAND:3
					PRINTFORM 透过因为被精液弄脏而变得模糊不清的眼镜
				ELSEIF COND("絶頂", PLAYER) >= 2
					PRINTFORM 精液不断从脸上黏黏糊糊地滴下的同时
				ENDIF
				PRINTFORMW 、用像是非常迷醉的表情看着%CALLNAME:PLAYER%…
			ENDIF
		ELSEIF MAX(ABL:信頼/2, ABL:精液中毒) >= 3
			PRINTFORM %CALLNAME:TARGET%
			IF NOWEX:絶頂数合計 && RAND:2
				PRINTFORM 因为快感身体不断颤抖的同时、
			ELSEIF TALENT:害羞 && RAND:2
				PRINTFORM 害羞的同时、
			ELSEIF PALAM:欲情 >= 10000 && RAND:3
				PRINTFORM 脸颊通红着、
			ENDIF
			IF ABL:精液中毒 >= 5 && RAND:3 == 0
				PRINTFORMW 用手指把挂在脸上的%TEXTS("精液", PLAYER)%涂抹開来…
			ELSEIF ABL:信頼/2 + ABL:精液中毒 >= 7 && RAND:2 == 0
				PRINTFORMW 用脸爱惜地摩擦射精完毕后的阴茎…
			ELSE
				PRINTFORMW 没有任何躲闪的意思、用脸将%TEXTS("精液", PLAYER)%全部接住…
			ENDIF
		ENDIF
	ELSEIF SHOOT("股間")
		;処女（挿入かと思って焦る）
		;IF TALENT:処女
		;	PRINTFORML 以为%CALLNAME:TARGET%的阴茎要插进来了而全身僵硬着
		;	PRINTFORML 但是、发现并不是那样之后、露出了稍微有些安心的表情…
		;	PRINTFORML 
		;ENDIF
		IF TEQUIP:推倒
			PRINTFORMW 让精液吐在了自己贴过去的股间上
		ELSE
			IF SHOOT("くぱぁ")
				IF TALENT:処女
					PRINTFORM %TEXTR(@"%CALLNAME:TARGET%用自己的手指向两边掰開而露出来的/向两边按着阴唇而暴露出来的%CALLNAME:TARGET%的/在眼前露出来的%CALLNAME:TARGET%的")%処女膜
				ELSE
					PRINTFORM %TEXTR("圆圆地被撑開的/咕滋地向左右两边张開的/在眼前张得圆圆的")%%CALLNAME:TARGET%的膣口
				ENDIF
			ELSE
				PRINTFORM %CALLNAME:TARGET%的股間
			ENDIF

			SELECTCASE RANDF(3)
			CASE 2
				PRINTFORM 上对着压好阴茎
			CASE 1
				PRINTFORM 用阴茎瞄准着
			CASEELSE
				PRINTFORM 用阴茎对准
			ENDSELECT
			PRINTFORMW %TEXTR("、吐出精液/射精/、浇上精液")%
		ENDIF
		;阴部が露出していない
		IF CHECK_CLO("Ｖ露出") == 0 && SELECTCOM != 97
			PRINTFORMW %TEXTS("阴部：視覚")%被%TEXTS("精液", PLAYER)%染上了白色…
		ELSEIF SHOOT("くぱぁ")
			SELECTCASE RANDF(3)
			CASE 2
				PRINTFORMW 在慢慢停止了射出%TEXTS("精液", PLAYER)%之后、用龟頭细致地把精液在柔软的粘膜上涂開…
			CASEELSE
				PRINTFORMW %CALLNAME:TARGET%露出来的秘密之处、每一个角落都被%CALLNAME:PLAYER%的%TEXTS("精液", PLAYER)%涂满了…
			ENDSELECT
		;阴部が見える
		ELSE
			PRINTFORMW %CALLNAME:TARGET%の%TEXTS("割れ目")%%TEXTR("が精液で染められ/が精液で汚され/に精液が絡みつい")%ていく……
		ENDIF
	ELSEIF SHOOT("Ａくぱぁ")
		PRINTFORM 把阴茎在%CALLNAME:TARGET%的%TEXTR("菊門/狭窄的后穴/被拉開的肛門")%
		SELECTCASE RANDF(3)
		CASE 2
			PRINTFORM 上压住
		CASE 1
			PRINTFORM 瞄准好
		CASEELSE
			PRINTFORM 顶住
		ENDSELECT
		PRINTFORMW %TEXTR("、吐出精液/射精/、喷出精液")%
		PRINTFORMW 粘度很高的白浊液、盖住了%CALLNAME:TARGET%的%TEXTR("不干净的穴/那里/菊花")%之后粘稠地挂了下来…
	ELSEIF SHOOT("お腹")
		IF TEQUIP:推倒
			PRINTFORML 在自己的肚子上让精液射了出来
		ELSE
			PRINTFORML 在%CALLNAME:TARGET%的肚子上吐出精液
		ENDIF
		PRINTFORM 被释放出来的%TEXTS("精液", PLAYER)%、
		IF TALENT:肚脐环 && RAND:2
			PRINTFORMW 把那里的%TEXTS("肚脐环")%弄脏了…
		ELSE
			PRINTFORMW 流进了小小的肚脐里面……
		ENDIF
	ELSEIF SHOOT("お尻")
		IF TEQUIP:推倒
			PRINTFORMW 让%TEXTS("精液", PLAYER)%洒在自己的屁股上…
		ELSE
			PRINTFORMW 在%CALLNAME:TARGET%的%TEXTS("お尻：視覚")%上洒满了%TEXTS("精液", PLAYER)%……
		ENDIF
	ELSEIF SHOOT("鼻の穴")
		PRINTFORM %CALLNAME:TARGET%的%TEXTR("被钩子撑開的鼻穴/豚鼻/大大広開的鼻孔")%

		SELECTCASE EXP_GAIN("鼻孔精液経験")
		CASE IS >= 2
			PRINTFORMW %TEXTR("用阴茎押住将精液注入了进去/在瞄准好后射精了/瞄准后用精液泼洒了")%…
		CASE 1
			PRINTFORMW %TEXTR("用阴茎押住将精液再次注入了进去/在瞄准好又一次射精了/瞄准后用精液再次泼洒了")%…
		;今回初
		CASEELSE
			PRINTFORMW %TEXTR("に阴茎を押し付けて精液を注ぎ込んだ/に狙いを定めて射精した/めがけて精液をぶっかけた")%
			;初めて
			IF FIRST_EV("絶頂：ぶっかけ鼻の穴") == 0
				SIF COND("絶頂", PLAYER) >= 2
					PRINTFORM 大量的
				PRINTFORM 精液流入了%TEXTR("没有预测到的/意想不到的/超出常识的")%場所
				PRINTFORM %TEXTR("目瞪口呆/驚愕/身体本能地做出了拒否反応")%的%CALLNAME:TARGET%、%TEXTS("精液", PLAYER)%从鼻孔%TEXTR("流回/滴落/逆流")%的同时
				PRINTFORMW %TEXTR("激烈地呛着/忍耐着痛苦/皱起了眉頭")%……
			;鼻の穴に出され慣れて平気变成了
			ELSEIF CHECK("鼻射")
				PRINTFORM %TEXTR("习惯了从鼻穴里出来的/積累了経験的/察觉了%CALLNAME:PLAYER%的意图的")%
				PRINTFORM %CALLNAME:TARGET%、%TEXTR("不顾毫不留情的击打/用鼻子啜饮着/换做用嘴继续呼吸")%、将
				PRINTFORM %TEXTR("又粘又浓稠的白濁液/精液/濃鼻涕一样的液体")%
				PRINTFORMW %TEXTR("面带興奮地/以涼爽的表情/像无事发生一样")%%TEXTR("下落至喉咙里/品味着/飲下")%…
			;つらい
			ELSE
				PRINTFORM %TEXTR(@"由于%CALLNAME:PLAYER%毫不留情的击打皱起了眉根的/无法忍耐鼻腔的苦痛对的")%
				PRINTFORM %CALLNAME:TARGET%、无能为力地将
				PRINTFORMW 流入的精液的大半从鼻孔中%TEXTR("喷/逆流/吹")%了出去…
			ENDIF
		ENDSELECT
	ENDIF
;以下は通常の射精区分。
;素股足交系は射精部位の変更を経る事が無い
ELSEIF SHOOT("兜合わせ")
	;同時射精
	IF NOWEX:射精 > 0
		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 3
			PRINTFORMW 非常有气势地喷出的两人的%TEXTS("精液", PLAYER)%、从肚子流过胸部一直到两人相互的脸上为止咕噜咕噜地射着…
		CASE 1
			PRINTFORMW 两人同时射出的精液、滴答滴答地弄脏了两人的肚子和股间…
		ENDSELECT
	ELSE
		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 2
			PRINTFORMW 非常有气势地射出的大量精液、直冲%CALLNAME:TARGET%的胸口…
		CASE 1
			PRINTFORMW 射出的%TEXTS("精液", PLAYER)%、滴答滴答地弄脏了两人的肚子和股间…
		ENDSELECT
	ENDIF
ELSEIF SHOOT("脚")
	SELECTCASE SELECTCOM:1
	CASE 1, 4, 9, 104
		PRINTFORM %CALLNAME:MASTER%
		CALL TEXT, "追加地の文：Ｗ推倒中の射精"
		PRINTFORMW 因为%CALLNAME:TARGET%的足交而\@ COND("絶頂", PLAYER) >= 2 ? 大量的、 # \@射精了…
	CASEELSE
		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 3
			PRINTFORMW 在%CALLNAME:TARGET%\@ SELECTCOM:1 == 95 ? 和%CALLNAME:(TARGET:1)% # \@的脚满是刚刚射出来的大量的%TEXTS("精液", PLAYER)%…
		CASE 2
			PRINTFORMW 在%CALLNAME:TARGET%\@ SELECTCOM:1 == 95 ? 和%CALLNAME:(TARGET:1)% # \@的脚满是刚刚射出来的大量的精液…
		CASE 1
			PRINTFORMW 喷出的%TEXTS("精液", PLAYER)%把%CALLNAME:TARGET%\@ SELECTCOM:1 == 95 ? 和%CALLNAME:(TARGET:1)% # \@的脚弄脏了…
		ENDSELECT
	ENDSELECT
ELSEIF SHOOT("尻素股")
	IF SELECTCOM == TNUM("尻素股") && SELECTCOM:1 == SELECTCOM
		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 3
			PRINTFORMW 两人的屁股上沾满了射出来的大量的%TEXTS("精液", PLAYER)%…
		CASE 2
			PRINTFORMW 两人的屁股上沾满了射出来的大量的精液…
		CASE 1
			PRINTFORMW 射出来的大量的%TEXTS("精液", PLAYER)%弄脏了两人的屁股…
		ENDSELECT
	ELSE
		IF TEQUIP:推倒
			PRINTFORMW %CALLNAME:TARGET%让精液撒在了自己的屁股上…
		ELSE
			PRINTFORMW %CALLNAME:MASTER%在%CALLNAME:TARGET%的%TEXTS("お尻：視覚")%上洒出了%TEXTS("精液", PLAYER)%……
		ENDIF
	ENDIF
ELSEIF SHOOT("素股")
	IF SELECTCOM == 93 && SELECTCOM:1 == SELECTCOM
		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 3
			PRINTFORMW 两人的身体上沾满了射出来的大量的%TEXTS("精液", PLAYER)%…
		CASE 2
			PRINTFORMW 两人的身体上沾满了射出来的大量的精液…
		CASE 1
			PRINTFORMW 射出来的大量的%TEXTS("精液", PLAYER)%弄脏了两人的身体…
		ENDSELECT
	ELSE
		SELECTCASE SELECTCOM:1
		CASE 1, 4, 9, 104
			PRINTFORM %CALLNAME:MASTER%
			CALL TEXT, "追加地の文：Ｗ推倒中の射精"
			PRINTFORMW 因为%CALLNAME:TARGET%的素股奉仕\@ COND("絶頂", PLAYER) >= 2 ? 大量的、 # \@射精了…
		CASEELSE
			SELECTCASE COND("絶頂", PLAYER)
			CASE IS >= 3
				PRINTFORMW %CALLNAME:TARGET%\@ SELECTCOM:1 == 95 ? 和%CALLNAME:(TARGET:1)% # \@的身体满是刚刚射出来的大量的%TEXTS("精液", PLAYER)%…
			CASE 2
				PRINTFORMW %CALLNAME:TARGET%\@ SELECTCOM:1 == 95 ? 和%CALLNAME:(TARGET:1)% # \@的身体满是刚刚射出来的大量的精液…
			CASE 1
				PRINTFORMW 刚刚射出来的%TEXTS("精液", PLAYER)%把%CALLNAME:TARGET%\@ SELECTCOM:1 == 95 ? 和%CALLNAME:(TARGET:1)% # \@的身体弄脏了…
			ENDSELECT
		ENDSELECT
	ENDIF
ELSEIF SHOOT("口")
	IF SHOOT("就这様") == 0
		IF TEQUIP:推倒
			IF ABL:精液中毒 >= 5 + RAND:5
				PRINTFORM 伸出舌頭像是等不及了一样
			ELSEIF ABL:精液中毒 >= 3 + RAND:5
				PRINTFORM 大大地张開着
			ENDIF
			PRINTFORMW 让欲望在自己的嘴中吐了出来。
		ELSE
			IF ABL:精液中毒 >= 5 + RAND:5
				PRINTFORM 在伸出舌頭张大着嘴等待着的
			ELSEIF ABL:精液中毒 >= 3 + RAND:5
				PRINTFORM 在大大地张開着的
			ENDIF
			PRINTFORMW %CALLNAME:TARGET%的口中吐出了欲望。
		ENDIF
	;二人推倒
	ELSEIF SHOOT_A("なぶられ中")
		PRINTFORM %CALLNAME:MASTER%
		CALL TEXT, "追加地の文：Ｗ推倒中の射精"
		PRINTFORMW 对着%CALLNAME:TARGET%的嘴\@ COND("絶頂", PLAYER) >= 2 ? 大量的、 # \@射精了。
	ELSEIF CHECK_COM("３Ｐ奉仕")
		PRINTFORM %CALLNAME:PLAYER%\@ SELECTCOM == 140 ? 挺出自己的腰、 # \@
		CALL SAMEN_SHOOT_MESSAGE_3P, "口"
		PRINTFORMW 在%CALLNAME:TARGET%的\@ SELECTCOM == 140 ? 咽喉的深处 # 口中 \@\@ COND("絶頂", PLAYER) >= 2 ? 大量的、 # \@射精了。
	ELSEIF SELECTCOM == 140
		PRINTFORM %CALLNAME:PLAYER%将%CALLNAME:TARGET%的頭抬起用力地顶出腰部、
		IF TEQUIP:深喉 && SIZE("阴茎") >= 2 && RAND:2
			PRINTFORMW 直接往食道中灌入了%TEXTS("精液", PLAYER)%。
		ELSE
			PRINTFORMW 在咽喉的深处射精了。
		ENDIF
	;ダブル口交
	ELSEIF SELECTCOM == 91 && SELECTCOM:1 == SELECTCOM
		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 3
			PRINTFORMW %CALLNAME:PLAYER%在张着嘴等待着的两人的脸上满满地用白浊液染上了颜色。
		CASEELSE
			PRINTFORMW %CALLNAME:PLAYER%顺从着涌上来的射精感、二在两人的口中吐出了欲望。
		ENDSELECT
	ELSE
		IF RAND:3 == 0
			PRINTFORM %CALLNAME:PLAYER%顺从着涌上来的射精感、
		ELSEIF TEQUIP:面部騎乗
			PRINTFORM %CALLNAME:PLAYER%的脸%TEXTR("被坐着夺走了自由/被股间摩擦着/被股间压着摩擦")%的同时、
		ELSEIF TEQUIP:六九式
			CALL TEXT, "追加地の文：６９中の射精"
		ELSE
			PRINTFORM %CALLNAME:PLAYER%顺从着涌上来的射精感、
		ENDIF

		PRINTFORM %CALLNAME:TARGET%的
		IF TEQUIP:深喉
			PRINTFORMW %TEXTR("喉咙深处/食道")%吐出了欲望。
		ELSE
			PRINTFORMW 口中吐出了欲望。
		ENDIF
	ENDIF

	CALL LUXURIOUS_HIT, "精液", TARGET

	;ダブル口交
	IF SELECTCOM == 91 && SELECTCOM:1 == SELECTCOM
		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 3
			IF TALENT:淫乱 + TALENT:恋慕 + TALENT:(TARGET:1):淫乱 + TALENT:(TARGET:1):恋慕 >= 2 && RAND:4
				PRINTFORM %CALLNAME:TARGET%和%CALLNAME:(TARGET:1)%
				SIF COND("絶頂", PLAYER) >= 4
					PRINTFORM 精液不断从脸上黏黏糊糊地滴下的同时
				PRINTFORMW 、用像是非常迷醉的表情看着%CALLNAME:PLAYER%…
			ELSEIF ABL:信頼/2 + ABL:精液中毒 + ABL:(TARGET:1):信頼/2 + ABL:(TARGET:1):精液中毒 >= 7
				PRINTFORM %CALLNAME:TARGET%和%CALLNAME:(TARGET:1)%
				IF RAND:2 == 0 && ABL:信頼/2 + ABL:精液中毒 >= 7
					SIF PALAM:欲情 >= 10000
						PRINTFORM 红着脸
					PRINTFORMW 把脸贴在阴茎上摩擦…
				ELSE
					SIF TALENT:害羞
						PRINTFORM 、也许是感觉到害羞了也说不定、
					PRINTFORMW 没有任何躲闪的意思、用脸将精液全部接住…
				ENDIF
			ENDIF
		CASEELSE
			IF ABL:精液中毒 + ABL:(TARGET:1):精液中毒 >= 6 && RAND:3 == 0
				PRINTFORMW %CALLNAME:TARGET%和%CALLNAME:(TARGET:1)%用嘴交换着%TEXTS("精液", PLAYER)%玩耍着…
			ELSE
				PRINTFORMW %CALLNAME:TARGET%和%CALLNAME:(TARGET:1)%用嘴接受了%TEXTS("精液", PLAYER)%…
			ENDIF
		ENDSELECT
	ELSE
		PRINTFORM %CALLNAME:TARGET%
		;挿入から飲ませる
		IF ABL:奉仕精神 >= 5 && SHOOT("膣内") + SHOOT("肛門") && ABL:奉仕精神/2 + TALENT:恋慕 + TALENT:淫乱 + TALENT:献身 - (TALENT:害羞 + TALENT:汚臭敏感) > 3
			IF RAND:3 == 0
				LOCALS = %TEXTR("污渍/粘液臭/味道/性交后的臭味")%
			ELSE
				IF SHOOT("膣内")
					LOCALS = %TEXTR("愛液/自己的胎内の/性交后の")%
				ELSE
					LOCALS = %TEXTR("腸液/自己的肠内の/刚肛門性交后の")%
					SIF BASE:排泄物 && BASE:排泄欲 >= MAXBASE:排泄欲 && RAND:4 == 0
						LOCALS = %TEXTR("排泄物の","排泄物")%
				ENDIF
				SELECTCASE SUBSTRING(LOCALS, STRLENS(LOCALS) - 2, 2)
				CASE "の"
					LOCALS = %LOCALS%%TEXTR("味道很大/臭/难闻")%
				CASEELSE
					LOCALS = %TEXTR(@"滴滴答答的%TEXTR("自分の","＿")%%LOCALS%/涂上了%TEXTR("自分の","＿")%%LOCALS%")%
				ENDSELECT
			ENDIF
			IF (TALENT:倒錯的 || ABL:受虐属性) && RAND:2
				PRINTFORM 因%LOCALS%%TEXTR("而兴奋地/发情着")%
			ELSE
				IF RAND:2 && MAX(ABL:信頼, ABL:欲望, ABL:奉仕精神) >= 5
					PRINTFORM 完全不介意%LOCALS%地
				ELSE
					PRINTFORM 不把%LOCALS%当一回事地
				ENDIF
				;各調教で最初の一回のみ
				SIF TALENT:恋慕 && EX:口内射精 == 0
					PRINTFORM 好像很喜欢一样
			ENDIF
			IF RAND:3 == 0
				PRINTFORM 用舌頭缠住%TEXTR("阴茎/龟頭")%、
			ELSEIF RAND:2
				PRINTFORM 将%TEXTR("阴茎/龟頭")%迎进来、
			ELSE
				PRINTFORM 吸住%TEXTR("阴茎/龟頭")%、
			ENDIF
		;６９自慰
		ELSEIF CHECK_COM("６９自慰", SELECTCOM) && (ABL:精液中毒 || ABL:奉仕精神 >= 5 || TALENT:精液嗜好)
			;きちんと飲めた
			IF ABL:精液中毒 || ABL:奉仕精神 >= 5 || TALENT:精液嗜好
				PRINTFORM 不停地抚弄自己舒服的地方的同时
			ELSE
				PRINTFORM 沉迷于自慰行为之中的同时、
			ENDIF
		;六九式
		ELSEIF TEQUIP:六九式 && (ABL:精液中毒 || ABL:奉仕精神 >= 5 || TALENT:精液嗜好)
			SELECTCASE TEQUIP:PLAYER:六九式
			CASE 0
				PRINTFORM 因为对臀部的刺激
			CASE 2, 9
				PRINTFORM 因为对肛門的刺激
			CASE 4
				PRINTFORM 因为对阴茎的刺激
			CASEELSE
				SELECTCASE SELECTCOM
				CASE 13, 14
					PRINTFORM 因为羞恥
				CASEELSE
					PRINTFORM 因为对秘部的刺激
				ENDSELECT
			ENDSELECT
			PRINTFORM 而全身颤抖着的同时、
		ELSEIF COND("嘔吐確率")
			;吐かずに済みそうなとき
			IF COND("嘔吐確率") < 50 && NOWEX:嘔吐寸止め == 0
				PRINTFORM %TEXTR("忍耐着微弱的恶心感/忍耐着逐渐变强的呕吐感/注意着不到达无法遏制的地步")%的同时、
			ELSE
				PRINTFORM %TEXTR("忍耐着涌上来的呕吐感/快要无法忍耐/努力地忍耐呕吐的生理反射")%的同时、
			ENDIF
		ENDIF
		IF COND("精飲可能") >= 3 && RAND:2 == 0
			IF COND("絶頂", PLAYER) >= 3 && RAND:2
				PRINTFORM 恐怖的量的%TEXTS("精液", PLAYER)%を
				IF ABL:精液中毒 >= 5 && RAND:3 == 0
					PRINTFORM 以超过射精的气势
				ELSEIF RAND:2
					PRINTFORM 咕噜咕噜地
				ELSE
					PRINTFORM 迷醉地
				ENDIF
				PRINTFORMW 喝干净了…
			ELSEIF COND("絶頂", PLAYER) == 2 && RAND:2
				PRINTFORMW \@ RAND:2 ? 看起来很開心地 # 看起来很好吃地 \@喝完了大量的精液…
			ELSEIF COND("絶頂", PLAYER)
				IF RAND:2
					PRINTFORMW \@ RAND:2 ? 细细地品味着 # 很清爽地 \@喝完了%TEXTS("精液", PLAYER)%…
				ELSE
					PRINTFORMW 喉咙发出声音地喝完了%TEXTS("精液", PLAYER)%…
				ENDIF
			ENDIF
		ELSEIF COND("精飲可能") >= 2
			SELECTCASE COND("絶頂", PLAYER)
			CASE IS >= 3
				IF ABL:精液中毒 >= 3 || TALENT:精液嗜好
					IF RAND:2
						PRINTFORMW 一边接住黏糊糊的精液发出鼻息一边用喉咙发出声音咽了下去…
					ELSE
						PRINTFORMW 喉咙不知道响了多少次、\@ TEQUIP:深喉 ? 被注入到喉咙深处 # 快要从嘴中溢出 \@的%TEXTS("精液", PLAYER)%终于流进了胃里…
					ENDIF
				ELSE
					PRINTFORM 将大量喷出的%TEXTS("精液", PLAYER)%
					IF RAND:2
						PRINTFORMW 努力地喝了下去…
					ELSE
						PRINTFORMW 眼角微微带着泪水喝了下去…
					ENDIF
				ENDIF
			CASE 2
				PRINTFORMW 咕滋咕滋地颤抖着身体咽下了大量的%TEXTS("精液", PLAYER)%…
			CASE 1
				PRINTFORMW 看起来在为%TEXTS("精液", PLAYER)%能\@ TEQUIP:深喉 ? 从很深的地方射了出来 # 从口中射出 \@而感到高兴…
			ENDSELECT
		ELSEIF COND("精飲可能")
			IF ABL:奉仕精神 >= 5
				PRINTFORM 发挥了奉仕精神
			ELSE
				PRINTFORM 遵从着身体的本能
			ENDIF
			PRINTFORMW 用\@ SELECTCOM == TNUM("強制口交") ? 喉咙深处 # 口 \@接受了精液…
			SELECTCASE COND("絶頂", PLAYER)
			CASE IS >= 3
				PRINTFORMW 但是努力地吞咽大量地喷出的精液的同时、还没来得及喝下去的%TEXTS("精液", PLAYER)%从%CALLNAME:TARGET%的口角鼻中溢了出来…
			CASE 2
				IF ABL:精液中毒 == 0 && TALENT:精液嗜好 == 0
					PRINTFORMW 因为喉咙中苦涩的%TEXTS("精液", PLAYER)%的味道而皱起眉頭的同时、%CALLNAME:TARGET%为了不让唾液从口中溢出来而拼命地吞咽着…
				ELSE
					PRINTFORMW 但好像无法喝完的样子、精液从%CALLNAME:TARGET%的口角溢了出来…
				ENDIF
			ENDSELECT
		ELSE
			;人生初の精飲
			IF EXP:精飲経験 == 0
				PRINTFORM 品味着初次喝到的精液的味道
				;涼しい顔
				IF TALENT:冷静 + TALENT:感情缺乏 + TALENT:汚臭鈍感 + TALENT:精液嗜好
					PRINTFORMW 表情毫无变化地静静品味着…
				;不快感を表情に出す
				ELSEIF TALENT:強気 + TALENT:坦率 + TALENT:傲慢 + TALENT:粗野
					PRINTFORM に%TEXTR("拧起眉頭/皱起脸")%、
					IF TALENT:叛逆
						PRINTFORMW 反射性地吐了出来…
					ELSE
						PRINTFORMW 不知该如何是好…
					ENDIF
				ELSE
					PRINTFORMW 露出微妙的表情…似乎不是很合口味的样子
				ENDIF
			;今回の初精飲
			ELSEIF EXP_GAIN("精飲経験") == 0
				PRINTFORM 品尝着%TEXTR("和以往一样的/口中的/非要说的话并不算好的")%精液的味道、
				;涼しい顔
				IF TALENT:冷静 + TALENT:感情缺乏 + TALENT:汚臭鈍感
					PRINTFORMW %TEXTR("并没有露出什么特别的表情/冷静地品味着/保持着普通的表情咀嚼着")%、花了一段时间后才吞下…
				;不快感を表情に出す
				ELSEIF TALENT:強気 + TALENT:坦率 + TALENT:傲慢 + TALENT:粗野
					PRINTFORM %TEXTR("拧起眉毛/皱起脸/露出困扰的表情")%、
					IF TALENT:叛逆
						PRINTFORMW 并不是吞下而是直接吐了出来…
					ELSEIF TALENT:汚臭鈍感 == 0 && TALENT:温柔 + TALENT:高贵 + TALENT:倒錯的 == 0
						PRINTFORMW 带着歉意吐了出来…
					ELSE
						PRINTFORMW 与恶心感苦战着…
					ENDIF
				ELSE
					PRINTFORMW %TEXTR("眼神恍惚/露出微妙的表情/身体出现了一些反抗反应")%、连仅仅是喝下一点点都有点困难的样子…
				ENDIF
			ELSE
				SELECTCASE COND("絶頂", PLAYER)
				CASE IS >= 2
					PRINTFORMW 随着哪怕一点点都无法饮下的精液大量喷射出来、%TEXTR("表现出有些慌乱的样子/看起来稍微有些痛苦/嘴角溢出了一些精液、双眼有些失神了的样子")%…
				CASE 1
					PRINTFORMW 因为口中的精液的味道而露出了微妙的表情…
				ENDSELECT
			ENDIF
		ENDIF
	ENDIF
ELSEIF SHOOT("乳頭奸")
	PRINTFORM %CALLNAME:PLAYER%将
	IF TEQUIP:推倒
		PRINTFORMW 一边被%CALLNAME:TARGET%撸动着阴茎、一边在乳房中\@ COND("絶頂", PLAYER) >= 2 ? 大量 # \@射精了…
	ELSEIF CHECK_COM("３Ｐ奉仕")
		;左右乳頭奸
		IF CHECK_COM("左右乳頭奸")
			PRINTFORM 和%CALLNAME:(PLAYER:1)%协力侵犯着左右乳房的同时、
			IF COND("絶頂", PLAYER:1)
				PRINTFORMW 抓住时机同时往里面注入了精液…
			ELSE
				PRINTFORMW 往乳房中注入了\@ COND("絶頂", PLAYER) >= 2 ? 大量的 # \@精液…
			ENDIF
		ELSE
			CALL SAMEN_SHOOT_MESSAGE_3P, "ニプル"
			PRINTFORMW 在%CALLNAME:TARGET%的乳房中\@ COND("絶頂", PLAYER) >= 2 ? 大量 # \@射精了…
		ENDIF
	ELSE
		PRINTFORM 扭动着腰
		IF RAND:5 == 0
			PRINTFORM 在%TEXTR("乳房/胸/乳頭")%的内部激烈地搅拌的同时、
		ELSEIF RAND:4 == 0
			PRINTFORM 突刺向%TEXTR("乳房/胸/乳頭")%深处的同时、
		ELSEIF RAND:3 == 0
			PRINTFORM 深深地突刺进%TEXTR("乳房/胸/乳頭")%的同时、
		ELSEIF RAND:2 == 0
			PRINTFORM 到深处为止侵犯着%TEXTR("乳房/胸/乳頭")%的同时、
		ELSE
			PRINTFORM 激烈地侵犯着在%TEXTR("乳房/胸/乳頭")%的同时、
		ENDIF
		SIF PALAM:欲情 > PALAM:恭順 && PALAM:欲情 > 10000 && RAND:5 < COND("絶頂", PLAYER)
			PRINTFORM 顺从了欲望

		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 3
			PRINTFORM 恐怖的量的
		CASE 2
			PRINTFORM 大量的
		CASE 1
			PRINTFORM 滚烫的
		ENDSELECT

		IF RAND:3 == 0 && COND("絶頂", PLAYER) >= 2
			PRINTFORMW 精液流入其中…
		ELSEIF RAND:2 == 0
			PRINTFORMW %TEXTS("精液", PLAYER)%在里面染上了颜色…
		ELSE
			PRINTFORMW %TEXTS("精液", PLAYER)%被注入其中…
		ENDIF
	ENDIF

	SIF COND("絶頂", PLAYER) >= 3
		PRINTFORMW 从%CALLNAME:TARGET%的乳頭缝隙中漏出来%TEXTS("精液", PLAYER)%、就像是母乳一样垂挂着…

	CALL LUXURIOUS_HIT, "精液", TARGET
ELSEIF SHOOT("尿道")
	PRINTFORM %CALLNAME:PLAYER%将
	IF TEQUIP:推倒
		PRINTFORMW 被%CALLNAME:TARGET%用尿道侵犯着、在膀胱中\@ COND("絶頂", PLAYER) >= 2 ? 大量 # \@射精了…
	ELSE
		PRINTFORM 扭动着腰
		IF RAND:4 == 0 && BASE:尿意 >= 10000 && PENIS(TARGET) == 0
			PRINTFORM 激烈地搅拌着膀胱内储存的尿液的同时、
		ELSEIF RAND:3 == 0 && PENIS(TARGET) == 0
			PRINTFORM 刺进膀胱的深处的同时、
		ELSEIF RAND:2 == 0
			PRINTFORM 侵犯着排尿器官的同时、
		ELSE
			PRINTFORM 激烈地侵犯尿道的同时、
		ENDIF
		SIF PALAM:欲情 > PALAM:恭順 && PALAM:欲情 > 10000 && RAND:5 < COND("絶頂", PLAYER)
			PRINTFORM 顺从了欲望

		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 3
			PRINTFORM 恐怖的量的
		CASE 2
			PRINTFORM 大量的
		CASE 1
			PRINTFORM 滚烫的
		ENDSELECT

		IF TEQUIP:PLAYER:避孕套
			PRINTFORMW %TEXTS("精液", PLAYER)%被吐入避孕套中…
		ELSEIF RAND:3 == 0 && COND("絶頂", PLAYER) >= 2
			PRINTFORMW 精液流入其中…
		ELSEIF RAND:2 == 0
			PRINTFORMW %TEXTS("精液", PLAYER)%在里面染上了颜色…
		ELSE
			PRINTFORMW %TEXTS("精液", PLAYER)%被注入其中…
		ENDIF
	ENDIF
	CALL LUXURIOUS_HIT, "精液", TARGET
ELSEIF SHOOT("胸")
	IF SHOOT("就这様") == 0
		IF TEQUIP:推倒
			PRINTFORMW 在自己的胸部上倾吐出欲望。
		ELSE
			PRINTFORM 阴茎的先端对准%CALLNAME:TARGET%的
			IF RAND:2 && PALAM:欲情 >= 3000
				PRINTFORM 附著晶瑩汗滴的胸
			ELSEIF TALENT:巨乳
				PRINTFORM 豐腴飽滿的胸
			ELSEIF TALENT:貧乳 || COND("伪娘")
				PRINTFORM 单薄的胸
			ELSE
				PRINTFORM 胸
			ENDIF
			PRINTFORMW 、倾吐出欲望。
		ENDIF
	;二人推倒
	ELSEIF SHOOT_A("なぶられ中")
		PRINTFORM %CALLNAME:MASTER%
		CALL TEXT, "追加地の文：Ｗ推倒中の射精"
		PRINTFORMW 对着%CALLNAME:TARGET%的胸部\@ COND("絶頂", PLAYER) >= 2 ? 大量 # \@射精了。
	ELSEIF CHECK_COM("３Ｐ奉仕")
		PRINTFORM %CALLNAME:PLAYER%将
		CALL SAMEN_SHOOT_MESSAGE_3P, "胸"
		PRINTFORMW 在%CALLNAME:TARGET%的胸上\@ COND("絶頂", PLAYER) >= 2 ? 大量 # \@射精了。
	;面部騎乗
	ELSEIF TEQUIP:面部騎乗
		PRINTFORMW %CALLNAME:PLAYER%脸被股间压住摩擦的同时、在%CALLNAME:TARGET%的胸部里去了。
	ELSEIF TEQUIP:六九式
		CALL TEXT, "追加地の文：６９中の射精"
		PRINTFORMW 在%CALLNAME:TARGET%的胸部上去了。
	ELSE
		SELECTCASE SELECTCOM
		CASE 81
			PRINTFORMW %CALLNAME:PLAYER%用阴茎侵犯着%CALLNAME:TARGET%的乳房的同时\@ COND("絶頂", PLAYER) >= 2 ? 大量的 # \@精液被喷了出来。
		CASEELSE
			PRINTFORMW %CALLNAME:PLAYER%在%CALLNAME:TARGET%的胸部上\@ COND("絶頂", PLAYER) >= 2 ? 大量 # \@射精了。
		ENDSELECT
	ENDIF
	IF SELECTCOM == 92 && SELECTCOM:1 == SELECTCOM
		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 2
			PRINTFORMW 从乳房中露出来的阴茎的前端喷出了大量的精液、将%CALLNAME:TARGET%和%CALLNAME:(TARGET:1)%的脸弄脏了…
		CASE 1
			PRINTFORMW %CALLNAME:TARGET%和%CALLNAME:(TARGET:1)%用胸部的山谷接受了精液…
		ENDSELECT
	ELSEIF ABL:信頼 >= 5 && COND("指の使用") && RAND:2
		PRINTFORM %CALLNAME:TARGET%
		IF ABL:欲望 >= 5 && RAND:2
			PRINTFORMW 露出恍惚的表情、用%TEXTS("精液", PLAYER)%在整个%TEXTS("胸部")%上%TEXTR("涂抹着/涂画着")%…
		ELSEIF TALENT:貧乳 == 0 && TALENT:男性 == 0 && RAND:2
			PRINTFORMW 双手捧起自己的胸部、为了不让精液漏出来全部用胸部接住了……
		ELSE
			PRINTFORMW 用指尖挑起弄脏了%TEXTS("胸部")%的%TEXTS("精液", PLAYER)%、在%TEXTS("乳頭：描写")%乳頭上開心地涂抹着……
		ENDIF
	;貧乳
	ELSEIF TALENT:貧乳 || COND("伪娘")
		IF RAND:2
			PRINTFORMW %TEXTS("精液", PLAYER)%从少有起伏的胸部上流了下来……
		ELSE
			PRINTFORMW 滚烫的精液在极少有突出的地方的胸部上流了下来……
		ENDIF
	ELSE
		IF TALENT:巨乳 && RAND:2
			PRINTFORMW 玷污了%TEXTS("胸部")%的白浊液在山谷间流动着、形成了一条精液溪流…
		ELSEIF RAND:2 == 0
			PRINTFORMW 喷出的精液在%CALLNAME:TARGET%的胸口中被接住、连\@ TALENT:魅力 ? 漂亮的 # \@脸都被沾上了飞溅的精液…
		ELSE
			PRINTFORMW 温热的精液在柔软的白球上流了下来……
		ENDIF
	ENDIF
;手で射精
ELSEIF SHOOT("手")
	;二人推倒
	IF SHOOT_A("なぶられ中")
		PRINTFORM %CALLNAME:MASTER%
		CALL TEXT, "追加地の文：Ｗ推倒中の射精"
		PRINTFORM 被%CALLNAME:TARGET%
		IF SELECTCOM == 97
			PRINTFORM 的%CLO("内褲冲")%摩擦着阴茎而
		ELSE
			PRINTFORM 撸动阴茎的同时
		ENDIF
		PRINTFORMW \@ COND("絶頂", PLAYER) >= 2 ? 大量 # \@射精了。
	ELSEIF CHECK_COM("３Ｐ奉仕")
		PRINTFORM %CALLNAME:PLAYER%
		CALL SAMEN_SHOOT_MESSAGE_3P, "手"
		PRINTFORM 被%CALLNAME:TARGET%
		IF SELECTCOM == 97
			PRINTFORM 的%CLO("内褲冲")%摩擦着阴茎而
		ELSE
			PRINTFORM 看着的同时
		ENDIF
		PRINTFORMW \@ COND("絶頂", PLAYER) >= 2 ? 大量 # \@射精了。
	;面部騎乗
	ELSEIF TEQUIP:面部騎乗
		PRINTFORM %CALLNAME:PLAYER%脸被股间压着摩擦的同时、在%CALLNAME:TARGET%
		IF SELECTCOM == 97
			PRINTFORM 的%CLO("内褲冲")%上
		ELSE
			PRINTFORM 撸动的
			SIF SELECTCOM == 105
				PRINTFORM 飞机杯中
		ENDIF
		PRINTFORMW \@ COND("絶頂", PLAYER) >= 2 ? 大量 # \@射精了。
	ELSEIF CHECK_COM("玩弄Ａ手交")
		PRINTFORMW %CALLNAME:PLAYER%\@ TEQUIP:推倒 ? 被一种扭曲的体位压着# \@被舌頭刺激着肛門的同时、欲望满满地射精了。
	ELSEIF CHECK_COM("洗面奶手交")
		PRINTFORM %CALLNAME:PLAYER%将
		IF COND("喝母乳フラグ", PLAYER)
			IF RAND:2
				PRINTFORM 含着%CALLNAME:TARGET%的乳頭品尝着母乳
			ELSE
				PRINTFORM 品尝着%CALLNAME:TARGET%的胸部
			ENDIF
		ELSE
			PRINTFORM 将脸埋进欧派
		ENDIF
		PRINTFORMW 的同时、欲望满满地射精了。
	;飞机杯冲
	ELSEIF SELECTCOM == 105
		PRINTFORMW %CALLNAME:PLAYER%被%CALLNAME:TARGET%撸动着的同时、在飞机杯中\@ COND("絶頂", PLAYER) >= 2 ? 大量 # \@射精了。
	ELSEIF TEQUIP:六九式
		CALL TEXT, "追加地の文：６９中の射精"
		PRINTFORMW 欲望满满地\@ COND("絶頂", PLAYER) >= 2 ? 大量 # \@射精了。
	ENDIF
	;飞机杯冲
	IF SELECTCOM == 105
		SIF COND("絶頂", PLAYER) >= 2
			PRINTFORMW 大量的%TEXTS("精液", PLAYER)%从飞机杯的缝隙中漏出、咕噜咕噜地打起了白色的泡沫…
	ELSEIF SELECTCOM == 97 && SELECTCOM:1 == SELECTCOM
		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 2
			PRINTFORMW 大量的精液从%CALLNAME:TARGET%和%CALLNAME:(TARGET:1)%的胖次中流出…
		CASE 1
			PRINTFORMW 吐出的%TEXTS("精液", PLAYER)%、从%CALLNAME:TARGET%和%CALLNAME:(TARGET:1)%的胖次中渗透了出来…
		ENDSELECT
	ELSEIF SELECTCOM == 97
		SIF CHECK_COM("洗面奶手交")
			PRINTFORM 因为柔软的触感而恍惚了的%CALLNAME:PLAYER%射精了
		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 3
			PRINTFORMW 大量的%TEXTS("精液", PLAYER)%从%CLO("内褲冲")%的布中喷出、%CALLNAME:TARGET%满身是大量的白浊液…
		CASE 2
			PRINTFORMW 大量的精液从%CLO("内褲冲")%像果冻一样流出、把%CALLNAME:TARGET%的手都涂满了…
		CASE 1
			PRINTFORMW %TEXTS("精液", PLAYER)%在%CALLNAME:TARGET%的%CLO("内褲冲")%中射出、胖次立刻变得沉重粘黏了起来…
		ENDSELECT
	ELSE
		SIF ABL:精液中毒 >= 3
			PRINTFORM 露出恍惚的表情
		SIF SELECTCOM == 90 && SELECTCOM:1 == SELECTCOM
			PRINTFORM %CALLNAME:(TARGET:1)%和
		IF CHECK_COM("洗面奶手交")
			LOCALS = %CALLNAME:TARGET%的手
		ELSEIF CHECK_COM("玩弄Ａ手交")
			LOCALS = 不用说%CALLNAME:TARGET%的手、连%CALLNAME:PLAYER%的脸都
		ELSE
			LOCALS = %CALLNAME:TARGET%的脸和手
		ENDIF
		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 3
			PRINTFORMW %LOCALS%沾满了大量的白浊液…
		CASE 2
			PRINTFORMW %LOCALS%沾上了大量的精液…
		CASE 1
			PRINTFORMW %CALLNAME:TARGET%被%TEXTS("精液", PLAYER)%淋了一身…
		ENDSELECT
	ENDIF
;自慰で射精
ELSEIF SHOOT("自慰")
	PRINTFORMW %CALLNAME:PLAYER%将身体交给已经到达临界的欲望、向空中\@ COND("絶頂", PLAYER) >= 2 ? 大量 # 舒服地 \@射精了。

;性交で射精
ELSEIF SHOOT("中出し")
	PRINTFORM %CALLNAME:PLAYER%将
	;、の管理
	LOCALS = 
	;二人推倒
	IF SHOOT_A("なぶられ中")
		CALL TEXT, "追加地の文：Ｗ推倒中の射精"
		LOCALS = 、
	ELSEIF CHECK_COM("３Ｐ奉仕")
		CALL SAMEN_SHOOT_MESSAGE_3P, "中出し"
		PRINTFORM %CALLNAME:TARGET%的
	;洗面奶
	ELSEIF SELECTCOM == 104
		IF TEQUIP:推倒
			IF RAND:2 && NOWEX:絶頂数合計 == 0
				PRINTFORM 被用%TEXTS("胸部")%在脸上摩擦着的%CALLNAME:TARGET%的
			ELSE
				PRINTFORM 被用%TEXTS("胸部")%包住了脸的同时、
				LOCALS = 、
			ENDIF
		ELSE
			IF RAND:2 && NOWEX:絶頂数合計 == 0
				PRINTFORM 被用%TEXTS("胸部")%在脸上摩擦着的%CALLNAME:TARGET%的
			ELSE
				PRINTFORM 将脸塞进%TEXTS("胸部")%的同时、
				LOCALS = 、
			ENDIF
		ENDIF
	ELSEIF NOWEX:絶頂数合計 && RAND:3 == 0
		IF (RAND:2 && SELECTCOM != 67) || TEQUIP:推倒
			PRINTFORM %TEXTR("蠢动的/蠕動的")%
		ELSE
			PRINTFORM 摇晃着腰的%CALLNAME:TARGET%的
		ENDIF
	ELSEIF TEQUIP:推倒
		IF RAND:2 == 0 && COND("指の使用")
			PRINTFORM 被%CALLNAME:TARGET%紧紧抱住
		ELSEIF SHOOT("肛門") && ABL:Ａ拡張 >= SIZE("阴茎", PLAYER)
			PRINTFORM %TEXTR("腰紧紧地贴在一起/压上自己的体重")%
		ELSEIF SHOOT("膣内") && ABL:Ｖ拡張 >= SIZE("阴茎", PLAYER)
			PRINTFORM %TEXTR("腰紧紧地贴在一起/压上自己的体重")%
		ELSE
			PRINTFORM 压上自己的体重
		ENDIF
	ELSE
		IF RAND:2 == 0 && COND("指の使用", PLAYER)
			PRINTFORM 紧紧抱住%CALLNAME:TARGET%
		ELSE
			PRINTFORM 腰%TEXTR("紧贴在一起/向前挺出")%
		ENDIF
	ENDIF

	IF COND("子宮挿入フラグ")
		IF TEQUIP:推倒
			PRINTFORM %TEXTR("用子宫深处的肉壁抚摸龟頭/用子宫激烈地侵犯")%的同时
		ELSE
			PRINTFORM %TEXTR("叩击着子宫深处的肉壁/压在子宫深处的肉壁上/激烈地侵犯子宫")%的同时
		ENDIF
	ELSEIF SELECTCOM == 67
		IF TEQUIP:推倒
			PRINTFORM %TEXTR("子宫往下压/用子宫口摩擦先端/用子宫口吸附在龟頭上")%的同时
		ELSE
			PRINTFORM %TEXTR("压入子宫/用阴茎戳弄子宫口/把龟頭压在子宫口上")%的同时
		ENDIF
	ELSEIF SHOOT("膣内")
		IF TEQUIP:推倒
			IF RAND:5 == 0 && NOWEX:絶頂数合計 == 0
				PRINTFORM 用下面的口%TEXTR("激烈地/毫不留情地")%侵犯的同时
			ELSEIF RAND:3 == 0 && ABL:Ｖ拡張 >= SIZE("阴茎", PLAYER)
				PRINTFORM 到阴道的最深处为止全部吞入的同时
			ELSE
				PRINTFORM %TEXTR("阴道缠上收缩/膣壁摩擦着")%的同时
			ENDIF
		ELSE
			IF RAND:2 && SIZE("阴茎", PLAYER) >= 2
				PRINTFORM %TEXTR("激烈侵犯膣道/深深侵犯膣道/叩击阴道深处的肉壁/拍打膣的深处")%的同时
			ELSE
				PRINTFORM %TEXTR("突入阴道深处/摩擦着膣壁/激烈搅动着膣内/突刺着阴道深处")%的同时
			ENDIF
		ENDIF
	ELSEIF SHOOT("肛門")
		PRINTFORM %TEXTR("直腸/肛門")%
		IF TEQUIP:推倒
			IF RAND:4 == 0
				PRINTFORM 给予着强烈刺激的同时
			ELSEIF RAND:3 == 0 && ABL:Ａ拡張 >= SIZE("阴茎", PLAYER)
				PRINTFORM 直至深处地呑込的同时
			ELSEIF RAND:2
				PRINTFORM 缠上收缩的同时
			ELSE
				PRINTFORM %TEXTR("激烈地/毫不留情地")%侵犯着的同时
			ENDIF
		ELSE
			IF RAND:2 && SIZE("阴茎", PLAYER) >= 2
				PRINTFORM %TEXTR("深处突刺着/深深侵犯")%的同时
			ELSE
				PRINTFORM %TEXTR("直至根部地突入/激烈搅动/激烈侵犯")%的同时
			ENDIF
		ENDIF
	ENDIF

	SELECTCASE LOCALS
	CASE "、"
	CASEELSE
		PRINTFORM 、
	ENDSELECT

	VARSET LOCALS

	SIF RAND:5 < COND("絶頂", PLAYER)
		LOCALS = \@ TEQUIP:推倒 ? 败给了欲望 # 放任自己的欲望 \@

	SELECTCASE COND("絶頂", PLAYER)
	CASE IS >= 3
		LOCALS:1 = 恐怖的量的
	CASE 2
		LOCALS:1 = 大量的
	CASE 1
		LOCALS:1 = 滚烫的
	ENDSELECT

	IF TEQUIP:PLAYER:避孕套
		PRINTFORMW %LOCALS:1%%TEXTS("精液", PLAYER)%吐进了避孕套中…
	ELSEIF SELECTCOM == 67 && RAND:3 == 0
		PRINTFORMW %LOCALS:1%%TEXTS("精液", PLAYER)%\@ TEQUIP:推倒 ? 被挤进了 # 流进了 \@最深处。
	ELSEIF EXP_GAIN("膣内精液経験") == 0 && SHOOT("膣内") && COND("危険日")
		PRINTFORMW %LOCALS:1%精液\@ TEQUIP:推倒 ? 被正处于危险日的子宫榨取着 # %LOCALS%射入正处于危险日的子宫中 \@。
	ELSEIF RAND:3 == 0 && TEQUIP:推倒 == 0
		PRINTFORMW %LOCALS%、%LOCALS:1%%TEXTS("精液", PLAYER)%在内部染上了颜色。
	ELSEIF RAND:2
		PRINTFORMW %LOCALS%\@ TEQUIP:推倒 ? 挤出了 # 放出了 \@%LOCALS:1%精液。
	ELSE
		PRINTFORMW %LOCALS:1%%TEXTS("精液", PLAYER)%\@ TEQUIP:推倒 ? 被榨了出来 # %LOCALS%注射了进去 \@。
	ENDIF

	IF TEQUIP:PLAYER:避孕套 == 0
		CALL LUXURIOUS_HIT, "精液", TARGET

		IF MARK:淫紋 && TALENT:男性 == 0 && SHOOT("膣内") && EXP_GAIN("膣内精液経験") == 0
			PRINTL 
			CALL PRINT_CUTIN, "腹部", TARGET
			CALL PRINT_STRW, @"爱心粉紅_%CALLNAME:TARGET%被刻上的淫纹发出了妖艳的光…"
		ENDIF


		IF MARK:淫紋 && TALENT:男性 == 0 && SHOOT("膣内") && EXP_GAIN("膣内精液経験") == 0
			PRINTFORMW 感受着%TEXTS("精液", PLAYER)%%TEXTR("流入/注入")%子宫所带来的难以忍受的%TEXTR("疼痛感/愉悦感")%、%CALLNAME:TARGET%无意识地扭起了腰…
		ELSE
			IF COND("３Ｐ") && PENIS(PLAYER:1) && COND("絶頂", PLAYER:1) && CHECK_COM("两根挿入Ｖ中") + CHECK_COM("两根挿入Ａ中")
				PRINTFORM 两人份的
			ELSEIF (SHOOT("膣内") && NOWEX:Ｖ絶頂) || (SHOOT("肛門") && NOWEX:Ａ絶頂)
				SIF NOWEX:精液絶頂 == 0
					PRINTFORM 绝顶的同时
			ELSEIF SELECTCOM == 3 && TCVAR:干劲 >= 40
				PRINTFORM 还在沉迷于不断的自慰中时、
			;今回の初中出し
			ELSEIF EXP_GAIN("膣内精液経験") + EXP_GAIN("肛内精液経験") == 0
				IF PLAYER == MASTER
					IF TALENT:母親 + TALENT:父親
						PRINTFORM 亲\@ TRUE_SEX(PLAYER) == "男性" ? 儿子 # 女儿 \@的
					ELSEIF TALENT:姉 + TALENT:兄
						PRINTFORM 実の\@ TRUE_SEX(PLAYER) == "男性" ? 弟 # 妹 \@
					ELSEIF TALENT:妹 + TALENT:弟
						PRINTFORM 亲生\@ TRUE_SEX(PLAYER) == "男性" ? 哥哥 # 姐姐 \@
					ELSEIF CONDS("間柄", PLAYER) == "教え子"
						PRINTFORM 學生的
					ELSE
						PRINTFORM %CALLNAME:PLAYER%の
					ENDIF
				ENDIF
			ENDIF

			SELECTCASE COND("絶頂", PLAYER)
			CASE IS >= 3
				PRINTFORM %TEXTS("精液", PLAYER)%就像要溢出来一样不断地注入的
			CASE 2
				PRINTFORM %TEXTS("精液", PLAYER)%填满了的
			CASE 1
				PRINTFORM %TEXTS("精液", PLAYER)%灌入的
			ENDSELECT

			PRINTFORM %CALLNAME:TARGET%的
			IF COND("３Ｐ") && PENIS(PLAYER:1) && COND("絶頂", PLAYER:1) && CHECK_COM("二穴挿入")
				PRINTFORM 两穴
			ELSEIF SHOOT("膣内")
				PRINTFORM 阴道内
			ELSE
				PRINTFORM 腸内
			ENDIF
			IF TALENT:淫壷 + TALENT:尻穴狂い && RAND:2 == 0
				PRINTFORM 因贪欲而蠢动着、
			ELSEIF RAND:2 == 0
				PRINTFORM 细微地抽搐着、
			ELSE
				PRINTFORM 偶尔蠕动着、
			ENDIF
			IF TALENT:淫壷 + TALENT:尻穴狂い && RAND:4 == 0
				IF COND("３Ｐ") && PENIS(PLAYER:1) && COND("絶頂", PLAYER:1) && CHECK_COM("二穴挿入")
				ELSEIF SHOOT("膣内")
					PRINTFORM 阴道口
				ELSE
					PRINTFORM 肛門
				ENDIF
				IF RAND:2
					PRINTFORMW 完全不给任何休息的机会不停地榨取着阴茎…
				ELSE
					PRINTFORMW 像是要将尿道里面的精液也全部榨取出来一样强烈地挤压着…
				ENDIF
			ELSEIF RAND:3 == 0
				PRINTFORMW 粘膜即使在射精之后也紧紧地吸附着阴茎…
			ELSEIF RAND:2 == 0
				PRINTFORMW 紧紧地抓着阴茎…
			ELSE
				PRINTFORMW 紧紧地缠住了阴茎…
			ENDIF
		ENDIF
	ENDIF
;接吻、舐陰、舐肛など、口や顔への刺激で射精
ELSEIF SHOOT("接吻") || SHOOT("面部騎乗") || SHOOT("洗面奶")
	;舐陰
	IF SELECTCOM == 1 || TEQUIP:面部騎乗 == 1
		IF TEQUIP:推倒
			PRINTFORM %CALLNAME:PLAYER%的脸被阴部压住摩擦的同时、
		ELSE
			PRINTFORM %CALLNAME:PLAYER%舔舐着阴部的同时、
		ENDIF
	;舐陰莖
	ELSEIF SELECTCOM == 4 && (SELECTCOM:1 == 120 || SELECTCOM:1 == 126)
		PRINTFORM %CALLNAME:PLAYER%将喉
		IF SELECTCOM:1 == 120
			PRINTFORM 和膣
		ELSEIF SELECTCOM:1 == 126
			PRINTFORM 和肛門
		ENDIF
		PRINTFORM 用阴茎蹂躏着、
	ELSEIF SELECTCOM == 4
		IF TEQUIP:推倒
			PRINTFORM %CALLNAME:PLAYER%被阴茎侵犯着嘴的同时、
		ELSE
			PRINTFORM %CALLNAME:PLAYER%用口奉仕阴茎的同时、
		ENDIF
	;接吻
	ELSEIF SELECTCOM == 6
		PRINTFORM %CALLNAME:PLAYER%和%CALLNAME:TARGET%
		;SIF ABL:技巧 >= 5
		;	PRINTFORM 濃密な
		PRINTFORM 接吻的同时、
	;舐肛
	ELSEIF SELECTCOM == 9
		IF TEQUIP:推倒
			PRINTFORM %CALLNAME:PLAYER%舔舐着尻穴的同时、
		ELSE
			PRINTFORM %CALLNAME:PLAYER%舔舐着菊花的同时、
		ENDIF
	;洗面奶
	ELSEIF SELECTCOM == 104
		PRINTFORM %CALLNAME:PLAYER%将
		IF COND("喝母乳フラグ", PLAYER)
			IF RAND:2
				PRINTFORM 含着乳頭品尝母乳的同时、
			ELSE
				PRINTFORM 品尝着浓厚的乳房的味道的同时、
			ENDIF
		ELSEIF TEQUIP:推倒
			IF TALENT:巨乳 && RAND:3 == 0
				PRINTFORM 被%TOFULL(CONDS("罩杯尺寸") )%杯的%TALENT_NAME(GETNUM(TALENT, "巨乳"), TALENT:巨乳)%压得快要窒息的同时、
			ELSEIF RAND:2
				PRINTFORM 脸颊被压进胸部的同时、
			ELSE
				PRINTFORM 被用胸部在脸上揉搓的同时、
			ENDIF
		ELSE
			IF TALENT:巨乳 && RAND:3 == 0
				PRINTFORM 享受%TOFULL(CONDS("罩杯尺寸") )%杯的%TALENT_NAME(GETNUM(TALENT, "巨乳"), TALENT:巨乳)%的同时、
			ELSEIF RAND:2
				PRINTFORM 把脸埋进胸部的同时、
			ELSE
				PRINTFORM 用脸摩擦柔软的胸部的同时、
			ENDIF
		ENDIF
		SIF CHECK_COM("洗面奶手交") && PREVCOM == 97
			PRINTFORM 在%CALLNAME:TARGET%的%CLO("内褲冲")%中
	ENDIF
	IF SELECTCOM:1 == 90
		PRINTFORM %CALLNAME:(TARGET:1)%的手中
	ELSEIF SELECTCOM:1 == 91
		PRINTFORM %CALLNAME:(TARGET:1)%的口中
	ELSEIF SELECTCOM:1 == 92
		PRINTFORM %CALLNAME:(TARGET:1)%的胸部上
	ELSEIF SELECTCOM:1 == 65
		PRINTFORM %CALLNAME:(TARGET:1)%的膣穴深处
	ELSEIF SELECTCOM:1 == 95
		PRINTFORM %CALLNAME:(TARGET:1)%的脚上
	ELSEIF SELECTCOM:1 == 97
		PRINTFORM %CALLNAME:(TARGET:1)%的胖次里
	ELSEIF SELECTCOM:1 == 75
		PRINTFORM %CALLNAME:(TARGET:1)%的肛門中
	ENDIF
	SELECTCASE COND("絶頂", PLAYER)
	CASE IS >= 3
		PRINTFORMW 气势惊人地持续射精…
	CASE 2
		PRINTFORMW 射出大量的精液…
	CASE 1
		PRINTFORMW 喷出精液…
	ENDSELECT
;逆肛交、逆強姦で射精
ELSEIF SHOOT("逆強姦") || SHOOT("逆肛交") || SHOOT("肛門奉仕") || SHOOT("逆舐陰") || SHOOT("逆Ａ振動棒")
	PRINTFORM %CALLNAME:PLAYER%将
	;両穴强奸
	IF (SELECTCOM == 126 && SELECTCOM:1 == 120) || (SELECTCOM == 120 && SELECTCOM:1 == 126)
		PRINTFORM 两边的穴被激烈地侵犯
		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 3
			PRINTFORMW 的同时、气势惊人地持续射精了…
		CASE 2
			PRINTFORMW 、射出了大量的精液…
		CASE 1
			PRINTFORMW 、射精了…
		ENDSELECT
	;强奸＋強制口交
	ELSEIF SELECTCOM:1 == 4 && (SELECTCOM == 120 || SELECTCOM == 126)
		PRINTFORM 喉
		IF SELECTCOM == 120
			PRINTFORM 和膣
		ELSEIF SELECTCOM == 126
			PRINTFORM 和肛門
		ENDIF

		PRINTFORM 被激烈地侵犯

		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 3
			PRINTFORMW 的同时、气势惊人地持续射精了…
		CASE 2
			PRINTFORMW 、射出了大量的精液…
		CASE 1
			PRINTFORMW 、射精了…
		ENDSELECT
	ELSE
		SIF TEQUIP:Ｗ推倒
			CALL TEXT, "追加地の文：Ｗ推倒中の射精"

		IF CHECK_COM("３Ｐ奉仕")
			IF COND("絶頂", PLAYER:1)
				PRINTFORM 被%CALLNAME:(PLAYER:1)%中出而不断地抽搐着、
			ELSEIF INSERT("騎乗位")
				PRINTFORM 跨在%CALLNAME:(PLAYER:1)%的腰上被顶着抽插、
			ELSE
				PRINTFORM 被%CALLNAME:(PLAYER:1)%侵犯着、
			ENDIF
		ENDIF

		SELECTCASE SELECTCOM
		CASE TNUM("手淫"), TNUM("内褲冲"), TNUM("飞机杯冲")
			IF INSERT("Ｖ挿入", PLAYER, TARGET)
				PRINTFORM 被%CALLNAME:TARGET%侵犯着
			ELSEIF INSERT("Ａ挿入", PLAYER, TARGET)
				PRINTFORM 被%CALLNAME:TARGET%侵犯着菊穴
			ENDIF
			PRINTFORM 的同时、被抓着阴茎狠狠地欺负了
		CASE 96
			PRINTFORM 被%CALLNAME:TARGET%的舌頭刺进了菊穴
		CASE 98
			PRINTFORM 被%CALLNAME:TARGET%舔舐着阴部
		CASE 107
			PRINTFORM 被%CALLNAME:TARGET%用玩具玩弄着尻穴
		CASE 120 TO 124
			PRINTFORM 被%CALLNAME:TARGET%激烈地侵犯
		CASE 125 TO 129
			PRINTFORM 被%CALLNAME:TARGET%激烈地侵犯肛門
		CASEELSE
			IF CHECK_COM("玩弄Ａ手交")
				PRINTFORM 被%CALLNAME:TARGET%的舌頭刺进了菊穴
			ELSEIF INSERT("Ｖ挿入", PLAYER, TARGET)
				PRINTFORM 被%CALLNAME:TARGET%激烈地侵犯
			ELSEIF INSERT("Ａ挿入", PLAYER, TARGET)
				PRINTFORM 被%CALLNAME:TARGET%激烈地侵犯肛門
			ENDIF
		ENDSELECT

		IF SELECTCOM:1 == 65
			PRINTFORM 的同时、在%CALLNAME:(TARGET:1)%的膣穴中
		ELSEIF SELECTCOM:1 == 75
			PRINTFORM 的同时、在%CALLNAME:(TARGET:1)%的直肠中
		ELSEIF SELECTCOM:1 == 83
			PRINTFORM 的同时、在%CALLNAME:(TARGET:1)%的膀胱和膣穴中
		ELSEIF CHECK_COM("玩弄Ａ手交")
			PRINTFORM 的同时、阴茎被\@ PREVCOM == 97 ? %CLO("内褲冲")% # 手 \@激烈地撸动着
		ELSE
			PRINTFORM て
		ENDIF

		SELECTCASE COND("絶頂", PLAYER)
		CASE IS >= 3
			PRINTFORMW 气势惊人地持续射精…
		CASE 2
			PRINTFORMW 射出大量的精液…
		CASE 1
			PRINTFORMW 射精了…
		ENDSELECT
	ENDIF
;胸への刺激で射精
ELSEIF SHOOT("乳交奉仕")
	;给对方乳交
	IF SELECTCOM == 11
		PRINTFORM %CALLNAME:PLAYER%将
		IF TEQUIP:推倒
			PRINTFORM %TEXTS("胸部", PLAYER)%被激烈地侵犯、
		ELSE
			PRINTFORM 不能忍受对胸部的刺激、
		ENDIF
	;被胸爱抚
	ELSEIF SELECTCOM == 102
		PRINTFORM %CALLNAME:PLAYER%将
		IF TALENT:PLAYER:母乳体質 && RAND:3 == 0
			PRINTFORM 不断从乳頭溢出母乳的同时、
		ELSEIF (TALENT:PLAYER:貧乳 || TALENT:PLAYER:男性 || TALENT:PLAYER:伪娘)
			PRINTFORM 乳頭被欺负着、
		ELSE
			PRINTFORM %TEXTS("胸部", PLAYER)%被激烈地责罚着、
		ENDIF
	ENDIF
	SELECTCASE COND("絶頂", PLAYER)
	CASE IS >= 3
		PRINTFORMW 气势惊人地持续射精…
	CASE 2
		PRINTFORMW 射出大量的精液…
	CASE 1
		PRINTFORMW 喷出精液…
	ENDSELECT
;助手に射精
ELSEIF SHOOT("助手")
	PRINTFORM 在%CALLNAME:TARGET%的眼前、在%CALLNAME:ASSI%的
	IF SHOOT("助手の膣内")
		PRINTFORM 阴道的深处
	ELSEIF SHOOT("助手の肛門")
		PRINTFORM 肛門里
	ELSEIF SHOOT("助手の口")
		PRINTFORM 在嘴里
	ENDIF
	PRINTFORMW 吐出了\@ COND("絶頂", PLAYER) >= 2 ? 多到像是要溢出来一样的 # \@精液…
	SIF ABL:欲望 >= 5 || ABL:精液中毒 >= 3
		PRINTFORMW %CALLNAME:TARGET%羡慕地看着%CALLNAME:ASSI%享受的身姿…
ENDIF

SIF ARG > 0
	SWAP ARG, TARGET

@EXTACY_MESSAGE
#DIM ACTOR

;両穴强奸
IF (SELECTCOM == 120 && SELECTCOM:1 == 126) || (SELECTCOM == 126 && SELECTCOM:1 == 120)
	PRINTFORMW %CALLNAME:PLAYER%两边的穴被激烈地侵犯着、忍不住去了…
ELSEIF TCVAR:PLAYER:PLAY区分メイン == 30
	PRINTFORML %CALLNAME:PLAYER%去了…
ELSE
	PRINTFORM %CALLNAME:PLAYER%将
	IF COND("３Ｐ")
		IF CHECK_COM("二穴挿入")
			PRINTFORM 和%CALLNAME:(PLAYER:1)%一起侵犯前后穴的同时、
		ELSEIF CHECK_COM("两根挿入Ｖ中")
			PRINTFORM 和%CALLNAME:(PLAYER:1)%同时侵犯膣穴的同时、
		ELSEIF CHECK_COM("两根挿入Ａ中")
			PRINTFORM 和%CALLNAME:(PLAYER:1)%同时侵犯直肠的同时、
		ENDIF
	ELSEIF TCVAR:PLAYER:PLAY区分サブ == 31
		PRINTFORM %CALLNAME:(TARGET:1)%
	ELSEIF TCVAR:PLAYER:PLAY区分メイン == 31
		PRINTFORM %CALLNAME:TARGET%
	ENDIF
	;舐陰
	IF SELECTCOM == 1 || SELECTCOM:1 == 1
		IF TEQUIP:推倒
			PRINTFORM 的阴部压住脸的同时、
		ELSE
			PRINTFORM 的阴部进行舔舐的同时、
		ENDIF
	;舐陰莖
	ELSEIF SELECTCOM == 4 || SELECTCOM:1 == 4
		IF TEQUIP:推倒
			PRINTFORM 的阴茎在口中侵犯的同时、
		ELSE
			PRINTFORM 的阴茎用嘴奉仕的同时、
		ENDIF
	;接吻
	ELSEIF SELECTCOM == 6 || SELECTCOM:1 == 6
		PRINTFORM 在接吻的同时、
	;舐肛
	ELSEIF SELECTCOM == 9 || SELECTCOM:1 == 9
		IF TEQUIP:推倒
			PRINTFORM 的菊穴被命令用嘴舔的同时、
		ELSE
			PRINTFORM 的肛門被舔的同时、
		ENDIF
	;给对方乳交
	ELSEIF SELECTCOM == 11 || SELECTCOM:1 == 11
		IF TEQUIP:推倒
			PRINTFORM %TEXTS("胸部", PLAYER)%被激烈地侵犯、
		ELSE
			PRINTFORM 不能忍受对胸部的刺激、
		ENDIF
	;被胸爱抚
	ELSEIF SELECTCOM == 102
		IF TALENT:PLAYER:母乳体質 && RAND:3 == 0
			PRINTFORM 不断从乳頭溢出母乳的同时、
		ELSEIF (TALENT:PLAYER:貧乳 || TALENT:PLAYER:男性 || TALENT:PLAYER:伪娘)
			PRINTFORM 乳頭を虐められ
		ELSE
			PRINTFORM %TEXTS("胸部", PLAYER)%被激烈地责罚着、
		ENDIF
	;洗面奶
	ELSEIF SELECTCOM == 104 || SELECTCOM:1 == 104
		IF TEQUIP:推倒
			PRINTFORM 的胸摩擦起脸的同时、
		ELSE
			PRINTFORM 的胸埋入脸的同时、
		ENDIF
	ENDIF
	IF SELECTCOM:1 == 95 || SELECTCOM:1 == 96 || SELECTCOM:1 == 98 || SELECTCOM:1 == 120 || SELECTCOM:1 == 126
		PRINTFORM %CALLNAME:(TARGET:1)%
		ACTOR = TARGET:1
	ELSEIF SELECTCOM == 95 || SELECTCOM == 96 || SELECTCOM == 98 || SELECTCOM == 120 || SELECTCOM == 126
		PRINTFORM %CALLNAME:TARGET%
		ACTOR = TARGET
	ENDIF
	IF SELECTCOM == 126 || SELECTCOM:1 == 126
		PRINTFORM 被侵犯肛門
	ELSEIF SELECTCOM == 120 || SELECTCOM:1 == 120
		IF ABL:ACTOR:技巧 >= 4 && STATE("超短", ACTOR) == 0 && RAND:2 == 0
			PRINTFORM 被顶撞着子宫
		ELSEIF ABL:ACTOR:技巧 >= 4
			PRINTFORM 被欺负着G点
		ELSE
			PRINTFORM 滋噗滋噗地被侵犯
		ENDIF
	ELSEIF SELECTCOM == 98 || SELECTCOM:1 == 98
		PRINTFORM 被激烈地舔阴
	ELSEIF SELECTCOM == 96 || SELECTCOM:1 == 96
		PRINTFORM 被舌頭刺穿了肛門
	ELSEIF SELECTCOM == 95 || SELECTCOM:1 == 95
		IF ABL:ACTOR:施虐属性 >= 3 && RAND:2 == 0
			PRINTFORM 被电器按摩着
		ELSE
			PRINTFORM 被踩踏着股间
		ENDIF
	ELSE
		PRINTFORM 身体颤抖着
	ENDIF
	PRINTFORMW 去了…
ENDIF


;-------------------------------------------------
;partnerの射精格子
;-------------------------------------------------
@TARGET_EJAC_CHECK_NOTEXT
#DIM MEMO_FLAG

MEMO_FLAG = TFLAG:システム文スキップ
TFLAG:システム文スキップ = 1
CALL TARGET_EJAC_CHECK
TFLAG:システム文スキップ = MEMO_FLAG

@TARGET_EJAC_CHECK
#DIM ACTOR
#DIM CAN_EJECT
#DIM MEMO_BASE
#DIM CAN_TOKOROTEN

SIF PENIS(TARGET) == 0
	RETURN 0

MEMO_BASE = BASE:絶頂
CAN_EJECT = 0
CAN_TOKOROTEN = 0

BASE:絶頂 += CUP:快Ｃ * MAXBASE:絶頂 / 10000
;射精ゲージ増加量の記録
TCVAR:絶頂増加 += CUP:快Ｃ * MAXBASE:絶頂 / 10000

IF COND("前立腺刺激")
	BASE:絶頂 += CUP:快Ａ * MAXBASE:絶頂 / 20000
	;射精ゲージ増加量の記録
	TCVAR:絶頂増加 += CUP:快Ａ * MAXBASE:絶頂 / 20000
	SIF CUP:快Ｃ == 0
		CAN_TOKOROTEN = 1
ENDIF

SIF BASE:絶頂 > MEMO_BASE && BASE:絶頂 >= MAXBASE:絶頂
	CAN_EJECT = 1

;こらえた場合には射精しない
IF NOWEX:绝顶忍耐
ELSEIF CAN_EJECT
	SELECTCASE BASE:絶頂
	CASE IS >= EJAC:TARGET * 4
		NOWEX:射精 = 3
	CASE IS >= EJAC:TARGET * 2
		NOWEX:射精 = 2
	CASE IS >= EJAC:TARGET
		NOWEX:射精 = 1
	ENDSELECT
	SIF CUP:快Ｃ == 0 && COND("前立腺刺激") && NOWEX:射精 < 2
		NOWEX:射精 = 0
	;射精量強化(上限突破で射精ランクを強化する)
	SIF NOWEX:射精 && TALENT:射精量強化
		NOWEX:射精 += 1
ENDIF

;partnerが射精
EX:射精 += NOWEX:射精

;射精前骤停(手下留情)
IF NOWEX:射精 && COND("射精禁止中")
	;大量射精前骤停
	IF NOWEX:射精 >= 2
		SOURCE:欲情追加 += 800
		SOURCE:屈従 += 1000

		NOWEX:射精前骤停 = 2
	ELSEIF NOWEX:射精
		SOURCE:欲情追加 += 300
		SOURCE:屈従 += 500

		NOWEX:射精前骤停 = 1
	ENDIF
	NOWEX:射精 = 0
ELSEIF NOWEX:射精
	NOWEX:射精回数 += 1
	EX:射精回数 += 1
	IF NOWEX:射精量 == 0
		NOWEX:射精量 = CALCF("射精量", COND("絶頂"), TARGET)
		EX:射精量 += NOWEX:射精量
	ENDIF
	IF TEQUIP:避孕套 == 0
		NOWEX:生射精回数 += 1
		EX:生射精回数 += 1
	ENDIF

	IF CAN_TOKOROTEN
		NOWEX:前列腺高潮射精 += 1
		EX:前列腺高潮射精 += 1
		EXP:前列腺高潮射精経験 += 1
	ENDIF

	SELECTCASE EXP:射精経験
	CASE IS < EXPLV:1
		SOURCE:屈従 += 650 * NOWEX:射精
	CASE IS < EXPLV:2
		SOURCE:屈従 += 550 * NOWEX:射精
	CASE IS < EXPLV:3
		SOURCE:屈従 += 450 * NOWEX:射精
	CASE IS < EXPLV:4
		SOURCE:屈従 += 400 * NOWEX:射精
	CASE IS < EXPLV:5
		SOURCE:屈従 += 300 * NOWEX:射精
	CASEELSE
		SOURCE:屈従 += 200 * NOWEX:射精
	ENDSELECT

	EXP:射精経験 += 1
	SIF TEQUIP:拘束
		EXP:拘束強制射精経験 += 1

	IF BASE:濃厚精液
		BASE:濃厚精液 -= MAX(TCVAR:濃厚射精, 1)
		NOWEX:濃厚射精 = MAX(TCVAR:濃厚射精, 1)
		EX:濃厚射精 += MAX(TCVAR:濃厚射精, 1)
		TCVAR:濃厚射精 = 0
	ENDIF

	BASE:絶頂 = 0
	;精力減少(Ｃ絶頂でも減っているはずなのでここでは純粋に射精で減るだけを扱う)
	LOCAL = MAX(NOWEX:射精, 1)
	BASE:精力 -= LOCAL
	TCVAR:精力減少 += LOCAL

	;避孕套有些なら套套内射精フラグON
	IF TEQUIP:避孕套
		SETBIT TCVAR:イベント, 50
	;想要射精的位置に精液汚れを付加
	ELSEIF INSERT("Ｖ挿入中")
		ACTOR = INSERT("Ｖ挿入中")
		EXP:ACTOR:精液経験 += NOWEX:射精 * 2
		CALL SETFLAG, "膣内精液経験", NOWEX:射精, ACTOR, TARGET
	ELSEIF INSERT("Ａ挿入中")
		ACTOR = INSERT("Ａ挿入中")
		EXP:ACTOR:精液経験 += NOWEX:射精 * 2
		CALL SETFLAG, "肛内精液経験", NOWEX:射精, ACTOR, TARGET
	ELSE
		SELECTCASE SELECTCOM
		;口
		CASE 4, 11
			EXP:PLAYER:精液経験 += NOWEX:射精 * 3
			CALL SETFLAG, "精飲経験", NOWEX:射精, PLAYER, TARGET
			SIF SELECTCOM == 11
				CALL ADD_STAIN, PLAYER, "Ｂ", "精液"
		;手
		CASE 10
			EXP:PLAYER:精液経験 += NOWEX:射精
			CALL ADD_STAIN, PLAYER, "手", "精液"
		;脚
		CASE 12
			EXP:PLAYER:精液経験 += NOWEX:射精
			CALL ADD_STAIN, PLAYER, "脚", "精液"
		;阴部
		CASE 120 TO 124
			EXP:PLAYER:精液経験 += NOWEX:射精 * 2
			CALL SETFLAG, "膣内精液経験", NOWEX:射精, PLAYER, TARGET
		;肛門
		CASE 125 TO 129
			EXP:PLAYER:精液経験 += NOWEX:射精 * 2
			CALL SETFLAG, "肛内精液経験", NOWEX:射精, PLAYER, TARGET
		;助手の阴部
		CASE 161
			EXP:ASSI:精液経験 += NOWEX:射精 * 2
			CALL SETFLAG, "膣内精液経験", NOWEX:射精, ASSI, TARGET
		ENDSELECT
	ENDIF

	;Ｐに精液汚れ
	CALL ADD_STAIN, TARGET, "Ｐ", "精液"
ENDIF

CALL TARGET_EJAC_CHECK_TEXT, TARGET


@TARGET_EJAC_CHECK_TEXT, ARG
#DIM MEMO_EXP, 100
#DIM LCOUNT

SIF TFLAG:システム文スキップ
	RETURN 0
SIF ARG == 0 && TARGET > 0
	ARG = TARGET

FOR LCOUNT, 0, 100
	MEMO_EXP:LCOUNT = EXP:ARG:LCOUNT
NEXT

CALL BLANKLINE

VARSET LOCALS
IF NOWEX:ARG:射精前骤停
	PRINTFORML %CALLNAME:ARG%\@ ARG == ASSI ? (%TEXTS("助手の名称")%) # \@%TEXTS("射精詳細", ARG)%
ELSEIF NOWEX:ARG:射精
	;射精前の口上
	TRYCALL KOJO_MESSAGE_BEFORE_TARGETSHOOT

	IF ABL:ARG:精液中毒 && TEQUIP:ARG:避孕套 == 0 && INSERT("屈曲位", ARG) && SELECTCOM == TNUM("给对方手交")
		PRINTFORML %CALLNAME:ARG%已经到达了极限、马上就要射精了的样子……要将撸动中的阴茎瞄准向自己的脸吗？
		CALL PRINT_SELECT, "瞄准脸/瞄准口/还是算了"
		IF RESULT == 0
			TCVAR:ARG:想要射精的位置 = 2
			CALL SETFLAG, "自我颜射フラグ", ARG
		ELSEIF RESULT == 1
			TCVAR:ARG:想要射精的位置 = 3
			CALL SETFLAG, "自我口内射精フラグ", ARG
		ENDIF
	ENDIF

	IF ARG == ASSI
		STR:助手の絶頂 = %STR:助手の絶頂%(%TEXTS("射精詳細", ARG)%)
	ELSEIF ARG == TARGET
		STR:対象の絶頂 = %STR:対象の絶頂%(%TEXTS("射精詳細", ARG)%)
	ENDIF
	PRINTFORML %CALLNAME:ARG%%TEXTS("射精詳細", ARG)%
;	PRINTFORML 射精経験＋{NOWEX:ARG:射精} \@ ARG == ASSI ? (%TEXTS("助手の名称")%) # \@
	IF NOWEX:前列腺高潮射精
;		PRINTFORML 前列腺高潮射精経験＋1 \@ ARG == ASSI ? (%TEXTS("助手の名称")%) # \@
	ELSEIF SHOOT("顔", ARG)
		CALL SETFLAG, "精液ぶっかけ経験", COND("絶頂", ARG), ARG, ARG
		CALL ADD_STAIN, ARG, "顔", "精液"
		EXP:ARG:精液経験 += NOWEX:ARG:射精
	ELSEIF SHOOT("口", ARG)
		CALL SETFLAG, "精飲経験", COND("絶頂", ARG), ARG, ARG
		CALL ADD_STAIN, ARG, "Ｍ", "精液"
		EXP:ARG:精液経験 += NOWEX:ARG:射精 * 2
	ENDIF

;	FOR LCOUNT, 0, 100
;		SELECTCASE EXPNAME:LCOUNT
;		CASE "精飲経験", "精液経験", "膣内精液経験", "肛内精液経験", "乳内精液経験", "膀胱精液経験", "鼻孔精液経験"
;			SIF EXP:ARG:LCOUNT > MEMO_EXP:LCOUNT
;				PRINTFORML %EXPNAME:LCOUNT%+{EXP:ARG:LCOUNT - MEMO_EXP:LCOUNT} \@ ARG == ASSI ? (%TEXTS("助手の名称")%) # \@
;		ENDSELECT
;	NEXT

	LOCAL = MAX(NOWEX:ARG:射精, 1)
;	PRINTFORML 精力-{LOCAL}
ENDIF


;-------------------------------------------------
;partnerの噴乳格子
;-------------------------------------------------
@TARGET_MILK_CHECK

SIF TALENT:母乳体質 == 0
	RETURN 0

CALL SETFLAG, "射精ゲージ", TARGET

;母乳生産量
LOCAL = RAND:1000
IF CUP:快Ｂ <= 10000
	LOCAL += CUP:快Ｂ * MAXBASE:母乳 / EJAC:TARGET
ELSE
	LOCAL += (10000 + DOWN_PALAMLV(CUP:快Ｂ - 10000) ) * MAXBASE:母乳 / EJAC:TARGET
ENDIF
LOCAL += TALENT:巨乳 * 500
SIF TALENT:淫乳
	LOCAL += 500
SIF BASE:育児中
	LOCAL += 1000

BASE:母乳 += LOCAL
;母乳ゲージ増加量の記録
TCVAR:母乳増加 += LOCAL

IF CUP:快Ｂ && NOWEX:Ｂ絶頂 && BASE:母乳 >= MAXBASE:母乳 && (NOWEX:Ｂ絶頂 >= 2 || BASE:母乳 >= EJAC:TARGET)
	SELECTCASE BASE:母乳
	CASE IS >= 10000 * 4
		NOWEX:噴乳 = 3
	CASE IS >= 10000 * 2
		NOWEX:噴乳 = 2
	CASE IS >= 10000
		NOWEX:噴乳 = 1
	ENDSELECT
	NOWEX:噴乳 = MIN(NOWEX:噴乳, NOWEX:Ｂ絶頂 + 1)
ENDIF

EX:噴乳 += NOWEX:噴乳

IF NOWEX:噴乳
	SOURCE:露出 += 500 * NOWEX:噴乳

	EXP:噴乳経験 += 1

	;Ｂに母乳汚れ
	CALL ADD_STAIN, TARGET, "Ｂ", "乳"

	IF NOWEX:Ｂ絶頂
		BASE:母乳 = MAX(BASE:母乳 - NOWEX:噴乳*10000, 0)
	ELSE
		BASE:母乳 = MAX(BASE:母乳 - NOWEX:噴乳*5000, 0)
	ENDIF
ENDIF

CALL TARGET_MILK_CHECK_TEXT, TARGET


@TARGET_MILK_CHECK_TEXT, ARG
SIF TFLAG:システム文スキップ
	RETURN 0

IF NOWEX:ARG:噴乳
	IF NOWEX:ARG:噴乳 >= 2 && NOWEX:Ｂ絶頂
		PRINTFORML %CALLNAME:ARG%的乳頭噴出了大量的母乳
	ELSEIF NOWEX:Ｂ絶頂
		PRINTFORML %CALLNAME:ARG%的乳頭流出了母乳
	ELSE
		PRINTFORML %CALLNAME:ARG%的乳頭滲出了母乳
	ENDIF
	;PRINTFORML 噴乳経験＋{NOWEX:ARG:噴乳} \@ ARG == ASSI ? (%TEXTS("助手の名称")%) # \@
ENDIF
