

@COMNAME323
#FUNCTIONS
TSTR:コマンド名受渡 = 环肩揉胸

;===================================================
;コマンドタイプ
;===================================================
@COMTYPE_323
#FUNCTION
TFLAG:コマンドタイプ受渡 = COMTYPE("セクハラ強")
弱点コマンドカテゴリ = B_女

@COM_TOOLTIP_323
LOCALS = <br>■环肩揉胸<br>
LOCALS += "从身后环抱对方肩膀并揉捏胸部的指令。<br>执行者体格明显小于目标时不可执行。<br>目标穿着上半身护甲时不可执行。"
LOCALS += "<br>指令类型：性骚扰<br>获取来源：接触・暴露・快Ｂ"
LOCALS += "<br>专属经验值：无<br>"
TSTR:ツールチップ受渡 = %LOCALS%

@COM323
#DIM 同行数
;尻を揉む

CALL セクハラ反応タイプ判定(TARGET)
;RFLAG:コマンド結果受渡し変数
;1:拒絶  2:受け入れ 3:喜び
;RFLAG:コマンド結果受渡し変数２
;1:無知  2:無反応 3:嫌悪  4:拒否  5:余裕  6:羞恥  7:愉悦  8:汎用

;セクハラ強は基本的に喜び以外に入らないはず（合意条件であり、合意に入るにはそれなりに仲良くならなければならないため）

SELECTCASE RFLAG:コマンド結果受渡し変数２
	CASE 1
		;無知
		CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
		CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
		CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 50)
	CASE 2
		;無反応
		CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
		CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
		CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 50)
	CASE 3
		;嫌悪
		CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
		CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
		CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 80)
	CASE 4
		;拒否
		CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
		CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
		CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 100)
	CASE 5
		;余裕
		CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
		CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
		CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 120)
	CASE 6
		;羞恥
		CALL SOURCE_CALC_接触(TARGET, PLAYER, 300)
		CALL SOURCE_CALC_露出(TARGET, PLAYER, 350)
		CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 150)
	CASE 7
		;愉悦
		CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
		CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
		CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 130)
	CASE 8
		;汎用
		CALL SOURCE_CALC_接触(TARGET, PLAYER, 200)
		CALL SOURCE_CALC_露出(TARGET, PLAYER, 250)
		CALL SOURCE_CALC_好感度要素_性愛度UP(TARGET, PLAYER, 100)
ENDSELECT
SIF 同性愛性癖判定(PLAYER,TARGET)
	EXP:PLAYER:同性愛経験 += 1
SIF 同性愛性癖判定(TARGET,PLAYER)
	EXP:TARGET:同性愛経験 += 1
;発生する快楽は受け手の状態に依存しない
CALL SOURCE_CALC_快Ｂ(TARGET, PLAYER, 100)
SIF TALENT:PLAYER:器用な指
	CALL SOURCE_CALC_快Ｂ(TARGET, PLAYER, 50)

;同行が二人未満なら同行化
IF CFLAG:TARGET:デート == 0 || CFLAG:TARGET:デート == PLAYER + 100
	同行数 = 0
	FOR LOCAL,1,CHARANUM
		SIF TARGET:LOCAL < 1
			BREAK
		IF CFLAG:(TARGET:LOCAL):同行 
			同行数 ++
		ENDIF
	NEXT
	IF 同行数 < 2
		CALL MODE_CHANGE("肩組み乳揉み", PLAYER, TARGET)
		CFLAG:TARGET:同行 = 60 + (CFLAG:好感度レベル - 関係閾値:2) * 5
		RFLAG:コマンド結果受渡し変数３ = 1
	ENDIF
ENDIF

TIME += 10
RETURN 1

;-------------------------------------------------
;実行判定
;-------------------------------------------------
@COM_ABLE323
;尻尾の付け根を揉む実行判定
SIF SAVESTR:ゲームフェイズ管理 != "通常モード"
	RETURN 0
;一括管理
SIF GLOBAL_COMABLE(323) && !RFLAG:罰ゲーム中
	RETURN RESULT
;睡眠中
SIF CFLAG:睡眠
	RETURN 0
SIF TEQUIP:上半身鎧あり
	RETURN 0
;体格問題 TARGETのほうが2サイズ大きいと届かない
SIF 体格差計算(PLAYER, TARGET) >= 2
	RETURN 0
RETURN 1

;-------------------------------------------------
;実行時メッセージ
;-------------------------------------------------
@MESSAGE_COM323

PRINTFORM %CALLNAME:PLAYER%
SIF 体格差計算(PLAYER, TARGET) <= -3
	PRINT 蹲下身
PRINTFORM 从身后环抱%CALLNAME:TARGET%的肩膀顺势
SELECTCASE TALENT:TARGET:バストサイズ
	CASE -2
		PRINTL 将手伸向几乎无起伏的平坦胸部勉强揉捏
	CASE -1
		PRINTL 轻柔抚弄微微隆起的青涩酥胸
	CASE 0
		PRINTL 伸手揉捏胸部的柔软轮廓
	CASE 1 TO 2
		PRINTL 把玩着饱满丰盈的浑圆双峰
	CASE 3
		PRINTL 贪婪揉捏着双手难以掌握的丰硕乳肉
ENDSELECT

IF CUP:TARGET:快Ｂ > 1000
	;一定以上の快楽が発生した時にちょっと声が出る
	PRINTFORML 突如其来的快感让%CALLNAME:TARGET%不禁漏出些许声音…
	PRINTL
ENDIF

IF RFLAG:コマンド結果受渡し変数３
	PRINTL 
	PRINTFORML %CALLNAME:PLAYER%持续揉捏胸部带着%CALLNAME:TARGET%移动
ENDIF

@MESSAGE_COM323_非口上時
;基本喜びだけのはずなので一旦分類せずに直接喜びパターンの文章を書く

SELECTCASE RFLAG:コマンド結果受渡し変数２
	CASE 1
		;無知
		PRINTFORML %CALLNAME:TARGET%虽不太明白，但看到%CALLNAME:PLAYER%开心也跟着高兴起来
	CASE 2
		;無反応
		PRINTFORML %CALLNAME:TARGET%看似镇定，却红着脸将身体贴近%CALLNAME:PLAYER%…
	CASE 3
		;嫌悪
		PRINTFORML %CALLNAME:TARGET%露出[真拿你没办法]的表情任由%CALLNAME:PLAYER%摆布…
	CASE 4
		;拒否
		PRINTFORML %CALLNAME:TARGET%似乎并不讨厌，放任%CALLNAME:PLAYER%继续动作…
	CASE 5
		;余裕
		PRINTFORML %CALLNAME:TARGET%悄悄提醒%CALLNAME:PLAYER%注意避开旁人视线…
	CASE 6
		;羞恥
		PRINTFORML %CALLNAME:TARGET%红着脸凝视%CALLNAME:PLAYER%，轻轻依偎过来…
	CASE 7
		;愉悦
		PRINTFORML %CALLNAME:TARGET%用妩媚神情暗示%CALLNAME:PLAYER%触碰更多部位…
	CASE 8
		PRINTFORML %CALLNAME:TARGET%似乎对%CALLNAME:PLAYER%的触碰感到欣喜…
ENDSELECT

