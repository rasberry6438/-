@キャラ履歴表示画面(ARG)
#DIM イベント件数
#DIM 人物ID
#DIM 解析行数
#DIM ページ番号
#DIM 開始ページ
#DIM DYNAMIC 検索リザルトID, 100000
#DIMS フィルタ
#DIM 表示行数 = 20; 履歴の表示行数
;#DIM 履歴表示フィルタ
#DIM L_C
;ここで立ち絵表示
CALL 画像描画終了
L_C = LINECOUNT
IF GETBIT(画像サイズ切り替えOPTION記憶, 2)
	HTML_PRINT @"<div rect='4062, 37, 1125, 2250'>%短冊グラ表示用文字列関数(ARG)%</div>", 1
ELSE
	HTML_PRINT @"<div rect='4062, 37, 1125, 1125'>%顔グラ表示用文字列関数(ARG)%</div>", 1
ENDIF
PRINTFORM ■%NAME表示(ARG)%
PRINTL
IF ARG != MASTER
	PRINT 　
	CALL 通常時体力ゲージ表示(ARG)
	PRINTL 
	PRINT 　
	CALL 通常時性欲ゲージ表示(ARG)
	PRINTL 
ENDIF
PRINTL
PRINTL □ 履历 □---------------------------------------------------------------------

フィルタ = 
;フィルタリング条件を取り込んでいく,0日常1うふふ2探索3実績4リゾート5非うふふ6非実績7その他
IF 部分一致
	SIF GETBIT(履歴表示フィルタ, 0) == 1
		フィルタ += @" AND DAILY <> 1 "
	SIF GETBIT(履歴表示フィルタ, 1) == 1
		フィルタ += @" AND ADULT <> 1 "
	SIF GETBIT(履歴表示フィルタ, 2) == 1
		フィルタ += @" AND QUEST <> 1 "
	SIF GETBIT(履歴表示フィルタ, 3) == 1
		フィルタ += @" AND TROPHY <> 1 "
	SIF GETBIT(履歴表示フィルタ, 4) == 1
		フィルタ += @" AND HISTORY <> 1 "
	SIF GETBIT(履歴表示フィルタ, 5) == 1
		フィルタ += @" AND ADULT <> 0 "
	SIF GETBIT(履歴表示フィルタ, 6) == 1
		フィルタ += @" AND TROPHY <> 0 "
	SIF GETBIT(履歴表示フィルタ, 7) == 1
		フィルタ += @" AND OTHERS <> 1 "
ELSE
	VARSET LOCALS
	フィルタ = AND (
	;フィルタリング条件を取り込んでいく,0日常1うふふ2探索3実績4リゾート5非うふふ6非実績7その他
	SIF GETBIT(履歴表示フィルタ, 0) == 0
		ARRAYSHIFT LOCALS, 1, " DAILY <> 0 "
	SIF GETBIT(履歴表示フィルタ, 1) == 0
		ARRAYSHIFT LOCALS, 1, " ADULT <> 0 "
	SIF GETBIT(履歴表示フィルタ, 2) == 0
		ARRAYSHIFT LOCALS, 1, " QUEST <> 0 "
	SIF GETBIT(履歴表示フィルタ, 3) == 0
		ARRAYSHIFT LOCALS, 1, " TROPHY <> 0 "
	SIF GETBIT(履歴表示フィルタ, 4) == 0
		ARRAYSHIFT LOCALS, 1, " HISTORY <> 0 "
	IF LOCALS:0 == ""
		GOTO 履歴取得スキップ
	ELSE
		FOR LOCAL,0,5
			IF LOCALS:LOCAL != ""
				IF LOCALS:(LOCAL + 1) == ""
					フィルタ += @"%LOCALS:LOCAL%)"
				ELSE
					フィルタ += @"%LOCALS:LOCAL% OR"
				ENDIF
			ENDIF
		NEXT
	ENDIF

	{
		;ややこしいので一旦外してテスト
	SIF GETBIT(履歴表示フィルタ, 5) == 1
		フィルタ += @" AND ADULT <> 0 "
	SIF GETBIT(履歴表示フィルタ, 6) == 1
		フィルタ += @" AND TROPHY <> 0 "
	SIF GETBIT(履歴表示フィルタ, 7) == 1
		フィルタ += @" AND OTHERS <> 1 "
	}
ENDIF

LOCAL = GET_PERSON_出会った周回(CFLAG:ARG:人物番号)
フィルタ += @" AND LOOP >= {LOCAL} "

;キャラIDがARGの人物または0(全体履歴)と一致する、かつフィルタ条件をみたす
イベント件数 = DT_SELECT("履歴データベース", @"(キャラID = {CFLAG:ARG:人物番号} OR キャラID = 0)%フィルタ% ", "LOOP ASC, DATE ASC", 検索リザルトID)

LOCALS = 
LOCALS:1 = 
FOR LOCAL, 0 + (表示行数 * 能力表示現在ページ), MIN((表示行数 * (能力表示現在ページ + 1)), イベント件数)
	LOCALS:1 += @"%DT_CELL_GETS("履歴データベース", 検索リザルトID:LOCAL, "NOTE", 1)%"
	LOCALS:1 += @"<br>"
NEXT

解析行数 = HTML_STRINGLINES(REPLACE(LOCALS:1, "<img src='[^']*'>", "　"), 76)
LOCALS += @"<div rect='0,0,3900,{解析行数 * 100 + 500}'>%LOCALS:1%"
LOCALS += @"</div>"

IF イベント件数 > 表示行数
	LOCALS += @"<div rect='0,{解析行数 * 100 + 300},5000,200'>"
	IF 能力表示現在ページ > 5
		LOCALS += @"<button value='-1'>[0]</button>..."
		開始ページ = 能力表示現在ページ - 5
	ELSE
		LOCALS += @"　　　"
		開始ページ = 0
	ENDIF
	FOR ページ番号, 0, 11
		IF イベント件数 > (ページ番号 + 開始ページ) * 表示行数
			SIF 能力表示現在ページ == ページ番号 + 開始ページ
				LOCALS += @"<font color='#%カラーパレット_HTML("黄")%'>"
			LOCALS += @"<button value='{(ページ番号 + 開始ページ) * -1 - 1}'>[{ページ番号 + 開始ページ}]</button> "
			SIF 能力表示現在ページ == ページ番号 + 開始ページ
				LOCALS += @"</font>"
		ENDIF
	NEXT
	IF イベント件数 > (MAX(能力表示現在ページ, 5) + 5) * 表示行数
		LOCALS += @"<button value='{((イベント件数 - 1) / 表示行数) * -1 - 1}'>...[{(イベント件数 - 1) / 表示行数}]</button> "
	ENDIF
	LOCALS += @"</div>"
ELSE
	能力表示現在ページ = 0
ENDIF

$履歴取得スキップ

LOCALS += @"<div rect='0,{解析行数 * 100 + 500},5000,300'>履历显示筛选："

SELECTCASE GETBIT(履歴表示フィルタ, 0); 日常
	CASE 0
		LOCALS += "<button value='1001'>[日常]</button> / "
	CASE 1
		LOCALS += "<font color='#666666'><button value='1001'>[日常]</button></font> / "
ENDSELECT
SELECTCASE GETBIT(履歴表示フィルタ, 1); うふふ
	CASE 0
		LOCALS += "<button value='1002'>[嘿咻]　</button> / "
	CASE 1
		LOCALS += "<font color='#666666'><button value='1002'>[嘿咻]　</button></font> / "
ENDSELECT
SELECTCASE GETBIT(履歴表示フィルタ, 3); 実績
	CASE 0
		LOCALS += "<button value='1004'>[成就]　</button> / "
	CASE 1
		LOCALS += "<font color='#666666'><button value='1004'>[成就]　</button></font> / "
ENDSELECT
SELECTCASE GETBIT(履歴表示フィルタ, 4); リゾート
	CASE 0
		LOCALS += "<button value='1005'>[度假村]</button> / "
	CASE 1
		LOCALS += "<font color='#666666'><button value='1005'>[度假村]</button></font> / "
ENDSELECT
SELECTCASE GETBIT(履歴表示フィルタ, 7); その他
	CASE 0
		LOCALS += "<button value='1008'>[其他]</button>"
	CASE 1
		LOCALS += "<font color='#666666'><button value='1008'>[其他]</button></font>"
ENDSELECT

LOCALS += "<br>　　　　　　　　　"

SELECTCASE GETBIT(履歴表示フィルタ, 2); 探索
	CASE 0
		LOCALS += "<button value='1003'>[探索]</button> / "
	CASE 1
		LOCALS += "<font color='#666666'><button value='1003'>[探索]</button></font> / "
ENDSELECT
IF 部分一致
	SELECTCASE GETBIT(履歴表示フィルタ, 5); 非うふふ
		CASE 0
			LOCALS += "<button value='1006'>[非嘿咻]</button> / "
		CASE 1
			LOCALS += "<font color='#666666'><button value='1006'>[非嘿咻]</button></font> / "
	ENDSELECT
	SELECTCASE GETBIT(履歴表示フィルタ, 6); 非実績
		CASE 0
			LOCALS += "<button value='1007'>[非成就]</button> / "
		CASE 1
			LOCALS += "<font color='#666666'><button value='1007'>[非成就]</button></font> / "
	ENDSELECT
ENDIF
LOCALS += "<button value='1009'>[全部关闭]</button> / "
LOCALS += "<button value='1010'>[全部开启]</button> / "
IF 部分一致
	LOCALS += "<button value='1011'>[优先开启]</button>"
ELSE
	LOCALS += "<button value='1011'>[优先关闭]</button>"
ENDIF

LOCALS += "</div>"

HTML_PRINT LOCALS, 1

FOR LOCAL, 0, MAX(29 - (LINECOUNT - L_C), 解析行数 + 3)
	PRINTL
NEXT

RETURN イベント件数

@履歴データベース作成
;初期設定
DT_CREATE "履歴データベース"
DT_COLUMN_ADD "履歴データベース", "キャラID", 4
DT_COLUMN_ADD "履歴データベース", "LOOP", 4
DT_COLUMN_ADD "履歴データベース", "DATE", 4
DT_COLUMN_ADD "履歴データベース", "NOTE"
DT_COLUMN_ADD "履歴データベース", "DAILY", 1
DT_COLUMN_ADD "履歴データベース", "ADULT", 1
DT_COLUMN_ADD "履歴データベース", "QUEST", 1
DT_COLUMN_ADD "履歴データベース", "TROPHY", 1
DT_COLUMN_ADD "履歴データベース", "HISTORY", 1
DT_COLUMN_ADD "履歴データベース", "OTHERS", 1 ;他フラグがないとき1で登録する


@履歴データベース登録(登録キャラID, 履歴文字列, フィルタ用文字列 = "", 特殊履歴タイプ = 0,  周回 = -1, 日付 = 0)
#DIM 登録キャラID; CFLAG::人物番号　0で全体履歴
#DIM 周回
#DIM 日付
#DIM 日常フィルタ
#DIM うふふフィルタ
#DIM 探索フィルタ
#DIM 実績フィルタ
#DIM リゾートフィルタ
#DIM その他フィルタ
#DIMS 履歴文字列
#DIM 特殊履歴タイプ; -1で日付非表示
#DIMS フィルタ用文字列

;分身のみ例外処理
IF STRFIND(履歴文字列, "アンチラ２") > -1 || STRFIND(履歴文字列, "アンチラ３") > -1 || STRFIND(履歴文字列, "アンチラ４") > -1
	;同じ履歴があればスキップ
	FOR LOCAL, 0, DT_ROW_LENGTH("履歴データベース")
		IF STRFIND(DT_CELL_GETS("履歴データベース", LOCAL, "NOTE"), 履歴文字列) > -1
			RETURN 0
		ENDIF
	NEXT
ENDIF

LOCALS = 

IF 登録キャラID < 0
	;分身は登録しない
	RETURN 0
ENDIF

;今日の周回日付を取得
SIF 周回 == -1
	周回 = 周回回数累計:0
SIF 日付 == 0
	日付 = DAY

IF 特殊履歴タイプ == -1; 日付の非表示ができるようにする
ELSE
	IF 周回 > 0
		LOCALS += @"第{周回 + 1}周目 "
	ENDIF

	;-2 空欄 -1 破線 (0 = DAY) 1以上で指定の日付
	IF 日付 == -1
		LOCALS += @"──────────"
	ELSE
		LOCALS += @"第{日付 / 120 + 1}年 %月登録:((日付 / 30) % 4)% {日付 % 30 + 1}日"
	ENDIF
	STRLENS LOCALS
	FOR LOCAL, 0, 20 - RESULT:0
		LOCALS += @" "
	NEXT
	LOCALS += "："
ENDIF

;任意の入力
LOCALS += @"%履歴文字列%"

;文字列をフィルタへ変換
日常フィルタ = 0
SIF STRFIND(フィルタ用文字列, "日常") > -1
	日常フィルタ = 1
うふふフィルタ = 0
SIF STRFIND(フィルタ用文字列, "うふふ") > -1
	うふふフィルタ = 1
探索フィルタ = 0
SIF STRFIND(フィルタ用文字列, "探索") > -1
	探索フィルタ = 1
実績フィルタ = 0
SIF STRFIND(フィルタ用文字列, "実績") > -1
	実績フィルタ = 1
リゾートフィルタ = 0
SIF STRFIND(フィルタ用文字列, "リゾート") > -1
	リゾートフィルタ = 1
;全フラグがないときその他フィルタをつける
その他フィルタ = 0
SIF 日常フィルタ == 0 && うふふフィルタ == 0 && 探索フィルタ == 0 && 実績フィルタ == 0 && リゾートフィルタ == 0
	その他フィルタ = 1

DT_ROW_ADD "履歴データベース", "キャラID", 登録キャラID, "LOOP", 周回, "DATE", 日付, "NOTE", @"%LOCALS%", "DAILY", 日常フィルタ, "ADULT", うふふフィルタ, "QUEST", 探索フィルタ, "TROPHY", 実績フィルタ, "HISTORY", リゾートフィルタ, "OTHERS", その他フィルタ


@履歴登録チェック(対象キャラ, 登録モード)
#DIMS 登録モード
#DIM 対象キャラ
;履歴登録の集約

SELECTCASE 登録モード
	CASE "覗かれ_着替え"
		SELECTCASE 履歴用実績:対象キャラ:着替え覗かれ回数
			CASE 1
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次被%CALLNAME:MASTER%偷窥[更衣]","うふふ")
			CASE 10
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[更衣]１０次","うふふ")
			CASE 50
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[更衣]５０次","うふふ")
			CASE 100
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[更衣]１００次","うふふ")
			CASE 300
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[更衣]３００次","うふふ")
			CASE 500
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[更衣]５００次","うふふ")
			CASE 999
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[更衣]９９９次","うふふ")
		ENDSELECT
	CASE "覗かれ_入浴"
		SELECTCASE 履歴用実績:対象キャラ:風呂覗かれ回数
			CASE 1
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次被%CALLNAME:MASTER%偷窥[沐浴]","うふふ")
			CASE 10
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[沐浴]１０次","うふふ")
			CASE 50
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[沐浴]５０次","うふふ")
			CASE 100
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[沐浴]１００次","うふふ")
			CASE 300
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[沐浴]３００次","うふふ")
			CASE 500
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[沐浴]５００次","うふふ")
			CASE 999
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[沐浴]９９９次","うふふ")
		ENDSELECT
	CASE "覗かれ_野外オナニー"
		SELECTCASE 履歴用実績:対象キャラ:野外オナニー覗かれ回数
			CASE 1
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次被%CALLNAME:MASTER%偷窥[户外自慰]","うふふ")
			CASE 10
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[户外自慰]１０次","うふふ")
			CASE 50
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[户外自慰]５０次","うふふ")
			CASE 100
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[户外自慰]１００次","うふふ")
			CASE 300
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[户外自慰]３００次","うふふ")
			CASE 500
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[户外自慰]５００次","うふふ")
			CASE 999
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被%CALLNAME:MASTER%偷窥[户外自慰]９９９次","うふふ")
		ENDSELECT
	CASE "被写体"
		SELECTCASE 履歴用実績:対象キャラ:被写体回数
			CASE 1
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次成为摄影对象","日常")
			CASE 10
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"成为摄影对象１０次","日常")
			CASE 50
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"成为摄影对象５０次","日常")
			CASE 100
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"成为摄影对象１００次","日常")
			CASE 300
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"成为摄影对象３００次","日常")
			CASE 500
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"成为摄影对象５００次","日常")
			CASE 999
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"成为摄影对象９９９次","日常")
		ENDSELECT
	CASE "被写体_ハメ撮り"
		SELECTCASE 履歴用実績:対象キャラ:ハメ撮り回数
			CASE 1
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次被拍摄交合场景","うふふ")
			CASE 10
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被拍摄交合场景１０次","うふふ")
			CASE 50
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被拍摄交合场景５０次","うふふ")
			CASE 100
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被拍摄交合场景１００次","うふふ")
			CASE 300
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被拍摄交合场景３００次","うふふ")
			CASE 500
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被拍摄交合场景５００次","うふふ")
			CASE 999
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被拍摄交合场景９９９次","うふふ")
		ENDSELECT
	CASE "被写体_ハメ撮り_絶頂時"
		SELECTCASE 履歴用実績:対象キャラ:絶頂ハメ撮り回数
			CASE 1
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次被拍下高潮姿态","うふふ")
			CASE 10
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被拍下高潮姿态１０次","うふふ")
			CASE 50
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被拍下高潮姿态５０次","うふふ")
			CASE 100
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被拍下高潮姿态１００次","うふふ")
			CASE 300
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被拍下高潮姿态３００次","うふふ")
			CASE 500
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被拍下高潮姿态５００次","うふふ")
			CASE 999
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被拍下高潮姿态９９９次","うふふ")
		ENDSELECT
	CASE "すごろく勝利"
		SELECTCASE 履歴用実績:対象キャラ:すごろく勝利
			CASE 1
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次在双六游戏中获胜","リゾート")
			CASE 10
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在双六游戏中获胜１０次","リゾート")
			CASE 50
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在双六游戏中获胜５０次","リゾート")
			CASE 100
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在双六游戏中获胜１００次","リゾート")
			CASE 300
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在双六游戏中获胜３００次","リゾート")
			CASE 500
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在双六游戏中获胜５００次","リゾート")
			CASE 999
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在双六游戏中获胜９９９次","リゾート")
		ENDSELECT
	CASE "ポーカー勝利"
		SELECTCASE 履歴用実績:対象キャラ:ポーカー勝利
			CASE 1
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次在扑克游戏中获胜","リゾート")
			CASE 10
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在扑克游戏中获胜１０次","リゾート")
			CASE 50
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在扑克游戏中获胜５０次","リゾート")
			CASE 100
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在扑克游戏中获胜１００次","リゾート")
			CASE 300
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在扑克游戏中获胜３００次","リゾート")
			CASE 500
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在扑克游戏中获胜５００次","リゾート")
			CASE 999
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在扑克游戏中获胜９９９次","リゾート")
		ENDSELECT
	CASE "人物当て正解"
		SELECTCASE 履歴用実績:対象キャラ:人物当て正解
			CASE 1
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次在猜人物游戏中答对","リゾート")
			CASE 10
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在猜人物游戏中答对１０次","リゾート")
			CASE 50
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在猜人物游戏中答对５０次","リゾート")
			CASE 100
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在猜人物游戏中答对１００次","リゾート")
			CASE 300
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在猜人物游戏中答对３００次","リゾート")
			CASE 500
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在猜人物游戏中答对５００次","リゾート")
			CASE 999
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在猜人物游戏中答对９９９次","リゾート")
		ENDSELECT
	CASE "水鉄砲回数"
		SELECTCASE 履歴用実績:対象キャラ:水鉄砲回数
			CASE 1
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次愉快地玩水枪","リゾート")
			CASE 10
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"愉快地玩水枪１０次","リゾート")
			CASE 50
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"愉快地玩水枪５０次","リゾート")
			CASE 100
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"愉快地玩水枪１００次","リゾート")
			CASE 300
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"愉快地玩水枪３００次","リゾート")
			CASE 500
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"愉快地玩水枪５００次","リゾート")
			CASE 999
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"愉快地玩水枪９９９次","リゾート")
		ENDSELECT
	CASE "卓球勝利回数"
		SELECTCASE 履歴用実績:対象キャラ:卓球勝利回数
			CASE 1
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次在乒乓球对决中获胜","リゾート")
			CASE 10
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在乒乓球对决中获胜１０次","リゾート")
			CASE 50
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在乒乓球对决中获胜５０次","リゾート")
			CASE 100
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在乒乓球对决中获胜１００次","リゾート")
			CASE 300
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在乒乓球对决中获胜３００次","リゾート")
			CASE 500
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在乒乓球对决中获胜５００次","リゾート")
			CASE 999
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在乒乓球对决中获胜９９９次","リゾート")
		ENDSELECT
	CASE "体力減少"
		IF 履歴用実績:対象キャラ:体力減少量累積 < 1000 && 履歴用実績:対象キャラ:体力減少量累積 + RFLAG:履歴用数値保存 >= 1000
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"体力累计减少１０００","うふふ")
		ENDIF
		IF 履歴用実績:対象キャラ:体力減少量累積 < 10000 && 履歴用実績:対象キャラ:体力減少量累積 + RFLAG:履歴用数値保存 >= 10000
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"体力累计减少１万","うふふ")
		ENDIF
		IF 履歴用実績:対象キャラ:体力減少量累積 < 50000 && 履歴用実績:対象キャラ:体力減少量累積 + RFLAG:履歴用数値保存 >= 50000
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"体力累计减少５万","うふふ")
		ENDIF
		IF 履歴用実績:対象キャラ:体力減少量累積 < 100000 && 履歴用実績:対象キャラ:体力減少量累積 + RFLAG:履歴用数値保存 >= 100000
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"体力累计减少１０万","うふふ")
		ENDIF
		IF 履歴用実績:対象キャラ:体力減少量累積 < 500000 && 履歴用実績:対象キャラ:体力減少量累積 + RFLAG:履歴用数値保存 >= 500000
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"体力累计减少５０万","うふふ")
		ENDIF
		IF 履歴用実績:対象キャラ:体力減少量累積 < 1000000 && 履歴用実績:対象キャラ:体力減少量累積 + RFLAG:履歴用数値保存 >= 1000000
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"体力累计减少１００万","うふふ")
		ENDIF
	CASE "ポロリ回数"
		SELECTCASE 履歴用実績:対象キャラ:卓球ポロリ回数
			CASE 1
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次在乒乓球时露出胸部","うふふ")
			CASE 10
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在乒乓球时露出胸部１０次","うふふ")
			CASE 50
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在乒乓球时露出胸部５０次","うふふ")
			CASE 100
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在乒乓球时露出胸部１００次","うふふ")
			CASE 300
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在乒乓球时露出胸部３００次","うふふ")
			CASE 500
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在乒乓球时露出胸部５００次","うふふ")
			CASE 999
				CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"在乒乓球时露出胸部９９９次","うふふ")
		ENDSELECT
	CASE "膣内射精回数"
		IF 履歴用実績:対象キャラ:膣内射精回数 < 1 && 履歴用実績:対象キャラ:膣内射精回数 + RFLAG:履歴用数値保存 >= 1
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次阴道内被射精","うふふ")
		ELSEIF 履歴用実績:対象キャラ:膣内射精回数 < 10 && 履歴用実績:対象キャラ:膣内射精回数 + RFLAG:履歴用数値保存 >= 10
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"阴道内被射精１０次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:膣内射精回数 < 50 && 履歴用実績:対象キャラ:膣内射精回数 + RFLAG:履歴用数値保存 >= 50
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"阴道内被射精５０次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:膣内射精回数 < 100 && 履歴用実績:対象キャラ:膣内射精回数 + RFLAG:履歴用数値保存 >= 100
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"阴道内被射精１００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:膣内射精回数 < 300 && 履歴用実績:対象キャラ:膣内射精回数 + RFLAG:履歴用数値保存 >= 300
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"阴道内被射精３００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:膣内射精回数 < 500 && 履歴用実績:対象キャラ:膣内射精回数 + RFLAG:履歴用数値保存 >= 500
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"阴道内被射精５００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:膣内射精回数 < 999 && 履歴用実績:対象キャラ:膣内射精回数 + RFLAG:履歴用数値保存 >= 999
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"阴道内被射精９９９次","うふふ")
		ENDIF
	CASE "腸内射精回数"
		IF 履歴用実績:対象キャラ:腸内射精回数 < 1 && 履歴用実績:対象キャラ:腸内射精回数 + RFLAG:履歴用数値保存 >= 1
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次肠道内被射精","うふふ")
		ELSEIF 履歴用実績:対象キャラ:腸内射精回数 < 10 && 履歴用実績:対象キャラ:腸内射精回数 + RFLAG:履歴用数値保存 >= 10
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"肠道内被射精１０次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:腸内射精回数 < 50 && 履歴用実績:対象キャラ:腸内射精回数 + RFLAG:履歴用数値保存 >= 50
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"肠道内被射精５０次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:腸内射精回数 < 100 && 履歴用実績:対象キャラ:腸内射精回数 + RFLAG:履歴用数値保存 >= 100
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"肠道内被射精１００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:腸内射精回数 < 300 && 履歴用実績:対象キャラ:腸内射精回数 + RFLAG:履歴用数値保存 >= 300
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"肠道内被射精３００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:腸内射精回数 < 500 && 履歴用実績:対象キャラ:腸内射精回数 + RFLAG:履歴用数値保存 >= 500
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"肠道内被射精５００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:腸内射精回数 < 999 && 履歴用実績:対象キャラ:腸内射精回数 + RFLAG:履歴用数値保存 >= 999
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"肠道内被射精９９９次","うふふ")
		ENDIF
	CASE "口内射精回数"
		IF 履歴用実績:対象キャラ:口内射精回数 < 1 && 履歴用実績:対象キャラ:口内射精回数 + RFLAG:履歴用数値保存 >= 1
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次口中被射精","うふふ")
		ELSEIF 履歴用実績:対象キャラ:口内射精回数 < 10 && 履歴用実績:対象キャラ:口内射精回数 + RFLAG:履歴用数値保存 >= 10
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"口中被射精１０次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:口内射精回数 < 50 && 履歴用実績:対象キャラ:口内射精回数 + RFLAG:履歴用数値保存 >= 50
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"口中被射精５０次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:口内射精回数 < 100 && 履歴用実績:対象キャラ:口内射精回数 + RFLAG:履歴用数値保存 >= 100
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"口中被射精１００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:口内射精回数 < 300 && 履歴用実績:対象キャラ:口内射精回数 + RFLAG:履歴用数値保存 >= 300
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"口中被射精３００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:口内射精回数 < 500 && 履歴用実績:対象キャラ:口内射精回数 + RFLAG:履歴用数値保存 >= 500
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"口中被射精５００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:口内射精回数 < 999 && 履歴用実績:対象キャラ:口内射精回数 + RFLAG:履歴用数値保存 >= 999
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"口中被射精９９９次","うふふ")
		ENDIF
	CASE "乳内射精回数"
		IF 履歴用実績:対象キャラ:乳内射精回数 < 1 && 履歴用実績:対象キャラ:乳内射精回数 + RFLAG:履歴用数値保存 >= 1
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次胸部被射精","うふふ")
		ELSEIF 履歴用実績:対象キャラ:乳内射精回数 < 10 && 履歴用実績:対象キャラ:乳内射精回数 + RFLAG:履歴用数値保存 >= 10
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"胸部被射精１０次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:乳内射精回数 < 50 && 履歴用実績:対象キャラ:乳内射精回数 + RFLAG:履歴用数値保存 >= 50
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"胸部被射精５０次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:乳内射精回数 < 100 && 履歴用実績:対象キャラ:乳内射精回数 + RFLAG:履歴用数値保存 >= 100
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"胸部被射精１００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:乳内射精回数 < 300 && 履歴用実績:対象キャラ:乳内射精回数 + RFLAG:履歴用数値保存 >= 300
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"胸部被射精３００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:乳内射精回数 < 500 && 履歴用実績:対象キャラ:乳内射精回数 + RFLAG:履歴用数値保存 >= 500
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"胸部被射精５００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:乳内射精回数 < 999 && 履歴用実績:対象キャラ:乳内射精回数 + RFLAG:履歴用数値保存 >= 999
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"胸部被射精９９９次","うふふ")
		ENDIF
	CASE "顔射回数"
		IF 履歴用実績:対象キャラ:顔射回数 < 1 && 履歴用実績:対象キャラ:顔射回数 + RFLAG:履歴用数値保存 >= 1
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"初次被颜射","うふふ")
		ELSEIF 履歴用実績:対象キャラ:顔射回数 < 10 && 履歴用実績:対象キャラ:顔射回数 + RFLAG:履歴用数値保存 >= 10
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被颜射１０次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:顔射回数 < 50 && 履歴用実績:対象キャラ:顔射回数 + RFLAG:履歴用数値保存 >= 50
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被颜射５０次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:顔射回数 < 100 && 履歴用実績:対象キャラ:顔射回数 + RFLAG:履歴用数値保存 >= 100
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被颜射１００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:顔射回数 < 300 && 履歴用実績:対象キャラ:顔射回数 + RFLAG:履歴用数値保存 >= 300
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被颜射３００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:顔射回数 < 500 && 履歴用実績:対象キャラ:顔射回数 + RFLAG:履歴用数値保存 >= 500
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被颜射５００次","うふふ")
		ELSEIF 履歴用実績:対象キャラ:顔射回数 < 999 && 履歴用実績:対象キャラ:顔射回数 + RFLAG:履歴用数値保存 >= 999
			CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"被颜射９９９次","うふふ")
		ENDIF
ENDSELECT


