

@性癖開拓チャレンジ処理_野外オナニー(ARG)
;野外オナニー
CSTR:ARG:性癖開拓報告_記録文字列 += @"%CALLNAME:PLAYER%巧妙地将关于「户外自慰情境」色情书籍传递给了%CALLNAME:ARG%…<br><br>"

;固有処理
RESULT = 0
CALL 口上変数初期化
TRYCALLFORM 性癖開拓_固有条件_野外オナニー_{NO:ARG}(ARG)
LOCAL = RESULT
SIF 口上有無確認(0, 1)
	CSTR:ARG:性癖開拓報告_記録文字列 += @"性癖開拓_固有条件"
IF LOCAL == 1
	CSTR:ARG:性癖開拓報告_記録文字列 += @"<br>"
	CSTR:ARG:性癖開拓報告_記録文字列 += @"%CALLNAME:ARG%获得了性癖特质[户外自慰(兴趣)]<br>"
	性癖素質:ARG:野外オナニー = 1
	CALL 履歴データベース登録(CFLAG:ARG:人物番号, @"<font color='#%カラーパレット_HTML("薄ピンク")%'>觉醒性癖特质[户外自慰(兴趣)]</font>","うふふ")
	RETURN 1
ELSEIF LOCAL == -1
	RETURN 0
ENDIF

;エロ本を読むかどうか
IF 知識素質:ARG:性知識 < 性知識条件_性癖開拓チャレンジ()
	IF EXP:ARG:自慰経験 < 1
		;性知識が-1か-2、かつ自慰経験がないと本の内容を理解できない
		CSTR:ARG:性癖開拓報告_記録文字列 += @"%CALLNAME:ARG%随手翻开不知何时出现在身边的色情书籍，但似乎完全无法理解内容…<br>"
		RETURN -1
	ELSEIF CFLAG:ARG:オナニー覚えたて
		;オナニー覚えたてだと確実に読む
		CSTR:ARG:性癖開拓報告_記録文字列 += @"…%CALLNAME:ARG%发现了不知何时出现在身边的色情书籍。<br>"
		CSTR:ARG:性癖開拓報告_記録文字列 += @" 当指尖划过书页时，%CALLNAME:ARG%发现书中竟详细记载着最近刚学会的自慰技巧。<br>"
		CSTR:ARG:性癖開拓報告_記録文字列 += @"文字描述着在户外隐秘角落进行自慰，快感会成倍提升的奇妙体验……<br>"
		CSTR:ARG:性癖開拓報告_記録文字列 += "<br>"
		CSTR:ARG:性癖開拓報告_記録文字列 += @"%CALLNAME:ARG%获得了性癖特质[户外自慰(兴趣)]<br>"
		性癖素質:ARG:野外オナニー = 1
		CALL 履歴データベース登録(CFLAG:ARG:人物番号, @"<font color='#%カラーパレット_HTML("薄ピンク")%'>觉醒性癖特质[户外自慰(兴趣)]</font>","うふふ")
		RETURN 1
	ENDIF
ENDIF

;基礎確率は2/10
LOCAL = 2
;叡智の殿堂補正
SIF 高速船記録:派遣先登録 == "智慧殿堂"
	LOCAL += 1
;自制心、性的興味、性欲が影響
LOCAL -= TALENT:ARG:自制心
LOCAL += TALENT:ARG:性的興味 * 2
LOCAL += TALENT:ARG:性欲
SIF BASE:ARG:性欲 > 1500
	LOCAL += 1
;露出癖が影響
LOCAL += ABL:ARG:露出癖
;野外オナニー経験が影響
SIF EXP:ARG:野外オナニー経験 > 0
	LOCAL += MAX(1, EXP:ARG:野外オナニー経験 / 5)

;自慰しやすいが影響
LOCAL += TALENT:ARG:自慰しやすい * 2
;最低確率1割は確保
LOCAL = MAX(LOCAL, 1)
;性欲無しだと読まない
SIF TALENT:ARG:性欲 == -2
	LOCAL = -1
;補正確率より低ければ読む
IF RAND:10 < LOCAL
	;読むパターン
	CSTR:ARG:性癖開拓報告_記録文字列 += @"…%CALLNAME:ARG%发现了不知何时出现在身边的色情书籍。<br>"
	IF 知識素質:ARG:性知識 < 性知識条件_性癖開拓チャレンジ()
		CSTR:ARG:性癖開拓報告_記録文字列 += @"…%CALLNAME:ARG%偶然发现了这本不知何时出现的书籍。<br>"
		CSTR:ARG:性癖開拓報告_記録文字列 += @"文字描述着在户外隐秘角落进行自慰，快感会成倍提升的奇妙体验……<br>"
	ELSE
		CSTR:ARG:性癖開拓報告_記録文字列 += @"慌张地环顾四周确认无人后，%CALLNAME:ARG%偷偷翻开了书页……<br>"
	ENDIF
	CSTR:ARG:性癖開拓報告_記録文字列 += "<br>"
	CSTR:ARG:性癖開拓報告_記録文字列 += @"%CALLNAME:ARG%获得了性癖特质[户外自慰(兴趣)]<br>"
	性癖素質:ARG:野外オナニー = 1
	CALL 履歴データベース登録(CFLAG:ARG:人物番号, @"<font color='#%カラーパレット_HTML("薄ピンク")%'>觉醒性癖特质[户外自慰(兴趣)]</font>","うふふ")
	RETURN 1
ELSE
	;読まないパターン
	CSTR:ARG:性癖開拓報告_記録文字列 += @"%CALLNAME:ARG%对突然出现的色情书籍露出嫌恶表情，将其扔进了垃圾桶<br>"
ENDIF

RETURN 0

@性癖段階非同室成長_野外オナニー(キャラ番号)
#DIM キャラ番号

SELECTCASE 性癖素質:キャラ番号:野外オナニー
	CASE 1
		;経験が足りないとダメ
		SIF EXP:キャラ番号:野外オナニー経験 < 30
			RETURN 0
		性癖素質:キャラ番号:野外オナニー = 2
		;取得メッセージ
		DRAWLINE
		PRINTFORML %CALLNAME:キャラ番号%通过反复进行户外自慰，性癖似乎得到了强化…
		PRINTL 
		PRINTFORML %CALLNAME:キャラ番号%的性癖特质[户外自慰(兴趣)]已进化为[户外自慰(喜好)]
		CALL 履歴データベース登録(CFLAG:キャラ番号:人物番号, @"<font color='#%カラーパレット_HTML("薄ピンク")%'>性癖特质[户外自慰(兴趣)]已进化为[户外自慰(喜好)]</font>","うふふ")
		PRINTL

		RETURN 1
	CASE 2
		;経験が足りないとダメ
		SIF EXP:キャラ番号:野外オナニー経験 < 100
			RETURN 0
		性癖素質:キャラ番号:野外オナニー = 3
		;取得メッセージ
		DRAWLINE
		PRINTFORML %CALLNAME:キャラ番号%已然将户外自慰融入日常生活节奏…
		PRINTL 
		PRINTFORML %CALLNAME:キャラ番号%的性癖特质[户外自慰(喜好)]已进化为[户外自慰(成瘾)]
		CALL 履歴データベース登録(CFLAG:キャラ番号:人物番号, @"<font color='#%カラーパレット_HTML("薄ピンク")%'>性癖特质[户外自慰(喜好)]已进化为[户外自慰(成瘾)]</font>","うふふ")
		PRINTL

		RETURN 1
	CASE 3
		;既に中毒ならスキップ
		RETURN 0
ENDSELECT

