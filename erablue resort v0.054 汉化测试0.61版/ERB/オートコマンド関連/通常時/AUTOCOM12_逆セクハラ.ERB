;------------------------------------------------------------------------------
;通常時、反向性骚扰
;------------------------------------------------------------------------------
@AUTOCOM12
#DIM セクハラ部位
#DIM セクハラ快楽量
CALL SOURCE_CALC_歓楽(AUTOCOM_実行番号保存, PLAYER, 500)
CALL SOURCE_CALC_好感度要素_性愛度UP(AUTOCOM_実行番号保存, PLAYER, 250)

;快楽計算
;部位決定
セクハラ部位 = WEIGHTED_RANDOM_PART(PLAYER)

;快楽量決定、基本値から諸々補正
SELECTCASE 知識素質:AUTOCOM_実行番号保存:性知識
	CASE IS < 0
		セクハラ快楽量 = 30
	CASE 0
		セクハラ快楽量 = 100
	CASE 1
		セクハラ快楽量 = 200
	CASE 2
		セクハラ快楽量 = 300
	CASE 3
		セクハラ快楽量 = 500
ENDSELECT

セクハラ快楽量 += ABL:AUTOCOM_実行番号保存:技巧 * 30
セクハラ快楽量 += TALENT:AUTOCOM_実行番号保存:経験豊富 * 50
セクハラ快楽量 += TALENT:AUTOCOM_実行番号保存:器用な指 * 20

SELECTCASE セクハラ部位
	CASE 0
		CALL SOURCE_CALC_快Ｃ(PLAYER, AUTOCOM_実行番号保存, セクハラ快楽量)
	CASE 1
		CALL SOURCE_CALC_快Ｖ(PLAYER, AUTOCOM_実行番号保存, セクハラ快楽量)
	CASE 2
		CALL SOURCE_CALC_快Ａ(PLAYER, AUTOCOM_実行番号保存, セクハラ快楽量)
	CASE 3
		CALL SOURCE_CALC_快Ｂ(PLAYER, AUTOCOM_実行番号保存, セクハラ快楽量)
ENDSELECT

;口上用に数値受け渡し
RFLAG:コマンド結果受渡し変数 = セクハラ部位
RFLAG:コマンド結果受渡し変数２ = セクハラ快楽量

TIME_反向性骚扰:AUTOCOM_実行番号保存:0 = TIME

RETURN 1

@AUTOCOM_ABLE12(キャラ番号)
#DIM キャラ番号
;あなたが必要
SIF GETBIT(AUTOCOM_相手判別関数(キャラ番号), 0) == 0
	RETURN 0
;うふふ中ではない
SIF CFLAG:キャラ番号:うふふ
	RETURN 0
;性感帯無し時は駄目
SIF !HAS_EROGENOUS_ZONE(PLAYER)
	RETURN 0
;フィールド展開中
SIF フィールド展開:反向性骚扰 == 0
	RETURN 0
;うふふしたことがある
SIF 初体験日取得("初うふふ", キャラ番号, MASTER) == 0
	RETURN 0
;２時間に１回のみ発動
SIF TIME - TIME_反向性骚扰:キャラ番号:0 < 120
	RETURN 0
;無関心、恥じらいは性欲必要
SIF (TALENT:キャラ番号:無関心 > 0 || TALENT:キャラ番号:羞恥心 > 0) && BASE:キャラ番号:性欲 < 1500
	RETURN 0

RETURN 1

@MESSAGE_AUTOCOM12
PRINTFORM %CALLNAME:AUTOCOM_実行番号保存%
SIF BASE:AUTOCOM_実行番号保存:性欲 > 1500
	PRINT 神情亢奋地对
PRINTFORM %CALLNAME:PLAYER%
SELECTCASE RFLAG:コマンド結果受渡し変数
	CASE 0
		IF TEQUIP:PLAYER:下腹部前鎧あり
			PRINT 将手探入护甲下方，
		ELSEIF TEQUIP:PLAYER:スカートめくり可
			PRINT 从裙摆下方伸手进去，
			IF TEQUIP:PLAYER:下タイツあり
				PRINT 隔着裤袜
			ELSEIF TEQUIP:PLAYER:下半身下着あり == 0
				PRINT 直接
			ELSE
				PRINT 隔着内裤
			ENDIF
		ELSEIF TEQUIP:PLAYER:ずらし可
			PRINT 扯开衣襟，
			IF TEQUIP:PLAYER:下タイツあり
				PRINT 隔着裤袜
			ELSEIF TEQUIP:PLAYER:下半身下着あり == 0
				PRINT 直接
			ELSE
				PRINT 隔着内裤
			ENDIF
		ELSE
			PRINT 隔着衣服，
		ENDIF
		IF GETBIT(TALENT:PLAYER:性別, 1)
			IF BASE:PLAYER:勃起 < 500
				PRINT 在尚未完全挺立的
			ELSEIF BASE:PLAYER:勃起 < 1000
				PRINT 半勃起的
			ELSE
				PRINT 完全坚挺的
			ENDIF
			PRINTL 阴茎上摩挲…
		ELSE
			PRINTL 在股间游移…
		ENDIF
	CASE 1
		IF TEQUIP:PLAYER:下腹部前鎧あり
			PRINT 将手探入护甲下方，
		ELSEIF TEQUIP:PLAYER:スカートめくり可
			PRINT 从裙摆下方伸手进去，
			IF TEQUIP:PLAYER:下タイツあり
				PRINT 隔着裤袜
			ELSEIF TEQUIP:PLAYER:下半身下着あり == 0
				PRINT 直接
			ELSE
				PRINT 隔着内裤
			ENDIF
		ELSEIF TEQUIP:PLAYER:ずらし可
			PRINT 扯开衣襟，
			IF TEQUIP:PLAYER:下タイツあり
				PRINT 隔着裤袜
			ELSEIF TEQUIP:PLAYER:下半身下着あり == 0
				PRINT 直接
			ELSE
				PRINT 隔着内裤
			ENDIF
		ELSE
			PRINT 隔着衣服，
		ENDIF
		PRINTFORML 在阴道口挑逗…
	CASE 2
		IF TEQUIP:PLAYER:下腹部後鎧あり
			PRINT 将手探入护甲下方，
		ELSEIF TEQUIP:PLAYER:スカートめくり可
			PRINT 从裙摆下方伸手进去，
			IF TEQUIP:PLAYER:下タイツあり
				PRINT 隔着裤袜
			ELSEIF TEQUIP:PLAYER:下半身下着あり == 0
				PRINT 直接
			ELSE
				PRINT 隔着内裤
			ENDIF
		ELSE
			PRINT 隔着衣服，
		ENDIF
		PRINTFORML 慢慢地揉捏臀部…
	CASE 3
		IF TEQUIP:PLAYER:上半身鎧あり
			PRINT 将手探入护甲下方，
		ELSEIF TEQUIP:PLAYER:手差し込み可
			PRINT 从裙摆下方伸手进去，
			IF TEQUIP:PLAYER:上タイツあり
				PRINT 隔着裤袜
			ELSEIF TEQUIP:PLAYER:上半身下着あり == 0
				PRINT 直接
			ELSE
				PRINT 隔着内裤
			ENDIF
		ELSE
			PRINT 隔着衣服，
		ENDIF
		PRINTFORML 在胸部上缓缓揉捏…
ENDSELECT

PRINTFORM %CALLNAME:PLAYER%因%CALLNAME:AUTOCOM_実行番号保存%
IF TALENT:AUTOCOM_実行番号保存:経験豊富
	PRINT 熟练的
ELSEIF TALENT:AUTOCOM_実行番号保存:器用な指
	PRINT 手法灵巧的
ENDIF
PRINT 骚扰行为，
SELECTCASE PALAM:PLAYER:(RFLAG:コマンド結果受渡し変数)
	CASE IS < 1000
		PRINTFORML 有些心痒难耐…
	CASE IS < 3000
		PRINTFORML 发出细微的喘息…
	CASE IS < 6000
		PRINTFORML 感受到强烈的快感…
	CASEELSE
		PRINTFORML 濒临高潮边缘。
ENDSELECT
