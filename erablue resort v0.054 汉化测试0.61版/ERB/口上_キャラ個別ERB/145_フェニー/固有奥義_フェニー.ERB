
@固有奥義_145(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 奥義威力
#DIMS 奥義名
#DIM 隊列番号
#DIM バフ・デバフ行数

; IF レベルやイベント完了などで強化される場合、奥義名や奥義威力などを分岐させる
; 	奥義名 = （任意の奥義名）
; 	奥義威力 = （任意の奥義威力数値。汎用奥義は300、固有奥義は400～500を基準とする）
; ELSE
	奥義名 = シャラーラ・ハラーラ
	奥義威力 = 1250
; ENDIF

;奥義威力を0にした場合、通常の奥義処理は行われず奥義追加効果のみが行われる。
;全体攻撃にしたい時や、攻撃しない奥義を作る場合は0に設定のこと

隊列番号 = キャラ隊列検索(GETCHARA(145))
バフ・デバフ行数 = バフ番号取得_枠("神秘の光焔", 隊列番号)

SELECTCASE ARGS
	CASE "奥義名"
		TSTR:コマンド名受渡 = %奥義名%
	CASE "奥義説明文"
		詳細文文字列受け渡し変数 = 奥義威力：{奥義威力}％<br>味方全体に火属性［10％］追撃効果［4ターン］
		詳細文文字列受け渡し変数 += @"<br>自身のHPを［最大値の20％］消費する"
		詳細文文字列受け渡し変数 += @"<br>◆神秘の光焔効果中、HPを消費しなくなる/火属性［攻撃力✕300％］追加ダメージ"
		
		RETURN 奥義威力
	CASE "奥義前効果"
		;対象決定の後、ダメージよりも前に発生する効果。基本の奥義ダメージ部分は記載する必要はない。
		;奥義威力が0だとここの部分もスキップされる
	CASE "奥義追加効果"
		;ここに奥義効果を記述する。基本の奥義ダメージ部分は記載する必要はない。
		;基本的にアビテンプレートの関数を使用すること
		;テンプレート使用の例は固有アビリティ_キャラ名.ERBに記載
		
		IF バフ・デバフ行数 > -1
			CALL アビ汎用変数文字列リセット
			アビ汎用変数:効果割合 = 300
			アビ汎用文字列:ダメージ種類 = 奥義ダメージ
			CALL アビテンプレート_ダメージ処理_火属性
		ENDIF
		
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_味方全体_生者のみ
		アビ汎用変数:効果割合 = 10
		アビ汎用文字列:バフ・デバフ枠 = 追撃C
		アビ汎用文字列:バフ・デバフ対象能力 = 追撃
		アビ汎用変数:持続ターン = 4
		CALL アビテンプレート_有利効果_バフ効果セット
		
		IF バフ・デバフ行数 < 0
			BATTLE_STATE:隊列番号:ＨＰ -= BATTLE_STATE:隊列番号:最大ＨＰ / 5
			SIF BATTLE_STATE:隊列番号:ＨＰ < 0
				BATTLE_STATE:隊列番号:ＨＰ = 0
			WSTR:(K++) = 奥義の反動で体力を消費した…
		ENDIF
ENDSELECT
