;****************************************
;ダンジョン探索中に条件を満たしていた時表示される文章
;****************************************
;・使い方
;「XXXX」をキャラクター番号に置換し、それぞれの関数に処理を入れる
;****************************************

;--------------------------------------------------
;「仲間と会話」ボタン押下時
;--------------------------------------------------
@KOJO_DUNGEON_仲間と会話_2172(対象キャラ)
#DIM 対象キャラ

;簡単に何度も見られるので、条件分岐やランダム化で複数パターンの登録を推奨

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)
;戦闘前セリフ「ミツモト先生の麻雀ファイトスクール、開校だ」
IF TALENT:対象キャラ:恋慕
	;ココアがパーティに居る時
	IF GETCHARA(2173)
		STRDATA KSTR:(K++)
			DATA 「_1st_と_2nd_との愛があれば更に無敵。ココアの本気を舐めないでくれよ」
			DATA 「恋も魔法もルンルン気分で一騎当千！…で行けたら良いのだが」
			DATA 「なぁに、ココアには指一本触れさせないさ」
		ENDDATA
	ELSE
		STRDATA KSTR:(K++)
			DATA 「_2nd_、疲れているな。_1st_の膝枕で大人しくする必要がある」
			DATA 「_2nd_とのいちゃらぶタイムは…戦いが終わってからだな」
			DATA ダイアは自分のリーチソングを口ずさみながら周囲を観察している…
		ENDDATA
	ENDIF
ELSE
	;ココアがパーティに居る時
	IF GETCHARA(2173)
		STRDATA KSTR:(K++)
			DATA 「我らには二代目魔法少女のココアが居る。魔法と気合があれば余裕のよっちゃんだぞ」
			DATA 「二人の魔法少女が揃えばあとはどうにかなる、麻雀も戦闘も押せ押せだ」
			DATALIST
				DATA 「見なよ、ウチの可愛い娘を…」
				DATA 「実に強くて最高だろう？」
			ENDLIST
		ENDDATA
	ELSE
		STRDATA KSTR:(K++)
			DATA 「…ココアは今頃何しているだろうか、寂しくて泣いていないか心配だ」
			DATA 「チョンボーローだけでなく、故郷の魔物との戦いには慣れている。心配ゴム用だ」
			DATA 「その衣装を何とかしろ――_2nd_、子供の頃から着ているらぶはむドレスにケチ付けるとは…10年早いぞ」
			DATA 「リゾート周辺にも魔物は出るのだな。_2nd_に頼み込まれた理由もよく分かる」
			DATA 「フッ、魔法少女をあまり舐めない方がいい」
		ENDDATA
	ENDIF
ENDIF

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ,,0,,対象キャラ)



;--------------------------------------------------
;固有スキル発動時
;--------------------------------------------------
;@KOJO_DUNGEON_固有アビ発動時_2172_らぶはむダイア(対象キャラ, 使用アビ名)
;#DIMS 使用アビ名
;#DIM 対象キャラ
;「（キャラ名）の（アビ名）！」よりも前に表示される
;汎用アビや衣装アビだと発動しないので注意

;YYYYを固有アビ関数の「@固有アビ_XXXX_YYYY」のYYYYと同じに変更する
;使用したアビリティの名前は「使用アビ名」に入ってくる

;CALL 口上変数初期化
;LOCAL = キャラ隊列検索(対象キャラ)

;KSTR:(K++) = 「_2nd_ら、愛し合っているか？」

;CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;奥義発動時
;--------------------------------------------------
@KOJO_DUNGEON_奥義発動時_2172(対象キャラ, 使用奥義名)
#DIMS 使用奥義名
#DIM 対象キャラ
;「（キャラ名）の奥義：（奥義名）！」よりも前に表示される

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「ここが年貢の納め時、ブタさんのエサになるがいい！」
	DATA 「右手に博愛、左手に慈愛、そして胸には…極大愛！」
	DATA 「白・發・中、三つの役牌を揃えた究極技…」
ENDDATA
KSTR:(K++) = 「必殺！だーいさぁーーーん、げんこつッ！！」

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ,,0,,対象キャラ)

;--------------------------------------------------
;チェンバースト発動時
;--------------------------------------------------
@KOJO_DUNGEON_チェンバ発動時_2172(対象キャラ)
#DIM 対象キャラ

;「チェインバースト！」（フルチェイン！）よりも前に表示される
;該当キャラが起点になった時（＝ターンで最初に奥義を撃ったキャラ）しか呼ばれないので注意

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

KSTR:(K++) = 「いくぞ、_1st_に続け！」

;掛け合いの作り方
;ZZZZ = 掛け合い相手のCSVに記載してあるキャラ番号とする
;
; LOCAL:2 = GETCHARA(ZZZZ)
; IF キャラ隊列検索(LOCAL:2) > -1
; 	KSTR:(K++) = （口上キャラのセリフ）
;
; 	NSTR:(K++) = ++++
;	切り替え名前:0 = %CALLNAME:(LOCAL:2)%
; 	切り替え顔グラリソース:0 = 探索用_{キャラ隊列検索(LOCAL:2)}_顔
;
; 	KSTR:(K++) = （掛け合い相手のセリフ）
; ENDIF
;と記述すると下に一個、掛け合い相手の顔グラと名前が表示されたメッセージ欄を増やせるので、そこで掛け合いを行う
;複数個メッセージ欄を増やす場合、切り替え顔グラリソース:1、切り替え名前:1のように配列番号を１つずつ増やすこと

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;トドメ時
;--------------------------------------------------
@KOJO_DUNGEON_トドメ時_2172(対象キャラ)
#DIM 対象キャラ

;行動の結果（◯◯は倒れた！など）の後に表示される
;複数攻撃時は一人でも倒していれば表示される

;口上用トドメフラグ には倒した敵の数が入っている
;口上用技名保存 には奥義名・アビ名が入っている
;       通常攻撃の場合は「通常攻撃」、チェンバの場合は「チェインバースト」が入っている

CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

KSTR:(K++) = 「これでキサマを殴る！」

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

; ;--------------------------------------------------
; ;味方から回復を受けた時
; ;「（キャラ名）のＨＰが」の直後に表示される
; ;複数人回復した場合、ランダムで一人の分が表示される
; ;--------------------------------------------------
; ;（現在未実装）
; @KOJO_DUNGEON_被回復時_XXXX(対象キャラ)
; #DIM 対象キャラ
; CALL 口上変数初期化
; LOCAL = GETCHARA(XXXX)
; LOCAL:1 = キャラ隊列検索(LOCAL)

; ;回復した側のキャラは「BATTLE_STATE:戦闘行動キャラ:キャラ登録番号」でキャラ番号が
; ;「戦闘行動キャラ」で隊列番号が取れる

; KSTR:(K++) = 

; CALL メッセージ欄表示用関数(@"探索用_{LOCAL:1}_顔", CALLNAME:対象キャラ)

;--------------------------------------------------
;戦闘勝利時
;--------------------------------------------------
@KOJO_DUNGEON_戦闘勝利時_2172(対象キャラ)
#DIM 対象キャラ

;ルピやEXPの取得よりも前に表示される

CALL メッセージ欄表示用関数(,,,0)
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「愛を阻むは叩いて砕き、押して進むがミツモトよ！」
	DATA 「っしゃ！マジカルビクトリー！」
	DATA 「うむ、皆無事で良かった」
	DATA 「_2nd_らもやるぞ、レッツらぶらぶ♡レッツらぶー＿H_」
	DATA 「らぶはむダイア大勝利！愛ある未来へレディ・ゴー！」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;全滅時
;--------------------------------------------------
@KOJO_DUNGEON_全滅時_2172(対象キャラ)
#DIM 対象キャラ
CALL メッセージ欄表示用関数(,,,0)
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「らぶはむダイア…完！」
	DATA 「くっ、ここまでか…」
	DATA 「認めたくないが、強い…」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)

;--------------------------------------------------
;逃走時
;--------------------------------------------------
@KOJO_DUNGEON_逃走時_2172(対象キャラ)
#DIM 対象キャラ
CALL メッセージ欄表示用関数(,,,0)
CALL 口上変数初期化
LOCAL = キャラ隊列検索(対象キャラ)

STRDATA KSTR:(K++)
	DATA 「このままでは埒が明かん、撤退だ！」
	DATA 「らぶはむダイアの次回作にご期待ください」
	DATA 「逃ーげるんだよー！」
ENDDATA

CALL メッセージ欄表示用関数(@"探索用_{LOCAL}_顔", CALLNAME:対象キャラ, , , , 対象キャラ)
