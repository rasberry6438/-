
@固有アビ_64_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
	アビ名 = 死与爱的世界+
	消費ＭＰ = 100
ELSE
	アビ名 = 死与爱的世界
	消費ＭＰ = 150
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70
			詳細文文字列受け渡し変数 = 消耗ＭＰ：{消費ＭＰ}<br>展开死与爱的世界领域（6回合）
		ELSE
			詳細文文字列受け渡し変数 = 消耗ＭＰ：{消費ＭＰ}<br>展开死与爱的世界领域（3回合）
		ENDIF
		詳細文文字列受け渡し変数 += @"<br>＞赋予敌我双方全体［20％］的攻击力提升效果。"
		詳細文文字列受け渡し変数 += @"<br>＞赋予我方全体［30％］的追击效果。"
		詳細文文字列受け渡し変数 += @"<br>使用此技能不消耗行动次数。"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:フィールド枠 = 死与爱的世界
		IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70
			アビ汎用変数:持続ターン = 6
		ELSE
			アビ汎用変数:持続ターン = 3
		ENDIF
		CALL アビテンプレート_フィールド効果セット

		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 死与爱的世界_攻撃力
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用変数:効果割合 = 20
		アビ汎用文字列:適用範囲 = 敵味方全体
		アビ汎用文字列:付随先_隊列設定 = 戦闘行動キャラ
		CALL アビテンプレート_有利効果_付随バフ効果セット("死与爱的世界")

		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 死与爱的世界_追撃
		アビ汎用文字列:バフ・デバフ対象能力 = 追撃
		アビ汎用変数:効果割合 = 30
		アビ汎用文字列:適用範囲 = 味方全体
		アビ汎用文字列:付随先_隊列設定 = 戦闘行動キャラ
		CALL アビテンプレート_有利効果_付随バフ効果セット("死与爱的世界")
		
		アビテンプレート用_行動消費無しフラグ = 1
ENDSELECT



@固有アビ_64_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 対象
#DIM 隊列番号
隊列番号 = キャラ隊列検索(キャラ番号)

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 65
	アビ名 = 所爱之人+
	消費ＭＰ = 175
ELSE
	アビ名 = 所爱之人
	消費ＭＰ = 200
ENDIF

IF 隊列番号 > -1 && 刻印現在数確認("爱的拯救", 隊列番号) < 2
	IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70 && 展開中フィールド名格納 == "死与爱的世界"
		アビテンプレート用_アビ封印用フラグ = 0
	ELSE
		アビテンプレート用_アビ封印用フラグ = 1
	ENDIF
ENDIF

SIF 隊列番号 > -1 && バフ番号取得_枠("所爱之人", 隊列番号) > -1
	アビテンプレート用_アビ封印用フラグ = 1

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消耗ＭＰ：{消費ＭＰ}<br>赋予我方单体及自身（4回合・不可驱散）的所爱之人效果。
		詳細文文字列受け渡し変数 += @"<br>使用此技能时，减少［2］层爱的拯救。"
		詳細文文字列受け渡し変数 += @"<br>若已获得爱的拯救效果，则无法使用此能力。"
		詳細文文字列受け渡し変数 += @"<br>使用此技能不消耗行动次数。"
		RETURN 消費ＭＰ
	CASE "アビ説明文_詳細"
		詳細文文字列受け渡し変数 = 消耗ＭＰ：{消費ＭＰ}<br>赋予我方单体及自身（独立槽・4回合・不可驱散）的所爱之人效果。
		詳細文文字列受け渡し変数 += @"<br>＞赋予［999％］的TA率提升效果。"
		詳細文文字列受け渡し変数 += @"<br>＞赋予［50％］的伤害减少效果。"
		詳細文文字列受け渡し変数 += @"<br>使用此技能时，减少［2］层爱的拯救。"
		詳細文文字列受け渡し変数 += @"<br>若已获得爱的拯救效果，则无法使用此能力。"
		詳細文文字列受け渡し変数 += @"<br>使用此技能不消耗行动次数。"
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_味方単体_生者のみ
		アビ汎用文字列:バフ・デバフ枠 = 所爱之人
		アビ汎用文字列:バフ・デバフ対象能力 = 所爱之人
		アビ汎用変数:持続ターン = 4
		アビ汎用変数:消去不可オプション = 1
		アビ汎用変数:特殊表示オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット

		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 所爱之人_絶対TA
		アビ汎用文字列:バフ・デバフ対象能力 = TA率
		アビ汎用変数:効果量 = 999
		CALL アビテンプレート_有利効果_付随バフ効果セット("所爱之人")

		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 所爱之人_被ダメ軽減
		アビ汎用文字列:バフ・デバフ対象能力 = 被ダメージ
		アビ汎用変数:効果割合 = 50
		CALL アビテンプレート_有利効果_付随バフ効果セット("所爱之人")
		
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 所爱之人
		アビ汎用文字列:バフ・デバフ対象能力 = 所爱之人
		アビ汎用変数:持続ターン = 4
		アビ汎用変数:消去不可オプション = 1
		アビ汎用変数:特殊表示オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット

		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 所爱之人_絶対TA
		アビ汎用文字列:バフ・デバフ対象能力 = TA率
		アビ汎用変数:効果量 = 999
		CALL アビテンプレート_有利効果_付随バフ効果セット("所爱之人")
		
		IF !(陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70 && 展開中フィールド名格納 == "死与爱的世界")
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用文字列:バフ・デバフ対象能力 = 爱的拯救
			CALL アビテンプレート_刻印減少(2)
		ENDIF
		
		アビテンプレート用_行動消費無しフラグ = 1
ENDSELECT



@固有アビ_64_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 隊列番号
隊列番号 = キャラ隊列検索(キャラ番号)

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
	アビ名 = 终焉之爱
	消費ＭＰ = 100

IF 隊列番号 > -1 && 刻印現在数確認("爱的拯救", 隊列番号) < 1
	IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70
		アビテンプレート用_アビ封印用フラグ = 0
	ELSE
		アビテンプレート用_アビ封印用フラグ = 1
	ENDIF
ENDIF

IF 隊列番号 > -1 && 刻印現在数確認("爱的拯救", 隊列番号) < 1
	IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70 && 展開中フィールド名格納 == "死与爱的世界"
		アビテンプレート用_アビ封印用フラグ = 0
	ELSE
		アビテンプレート用_アビ封印用フラグ = 1
	ENDIF
ENDIF

SIF 隊列番号 > -1 && 戦闘中カウント:隊列番号:1 == 1
	アビテンプレート用_アビ封印用フラグ = 1

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消耗ＭＰ：{消費ＭＰ}<br>赋予我方单体（常规槽・1次）的奥义再发动效果。
		詳細文文字列受け渡し変数 += @"<br>使用此技能时，减少［1］层爱的拯救。"
		詳細文文字列受け渡し変数 += @"<br>此能力每回合只能使用1次。"
		詳細文文字列受け渡し変数 += @"<br>使用此技能不消耗行动次数。"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_味方単体_生者のみ
		アビ汎用文字列:バフ・デバフ枠 = 奥義再発動
		アビ汎用文字列:バフ・デバフ対象能力 = 奥義再発動
		アビ汎用変数:持続回数 = 1
		アビ汎用変数:消去不可オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		IF !(陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70 && 展開中フィールド名格納 == "死与爱的世界")
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用文字列:バフ・デバフ対象能力 = 爱的拯救
			CALL アビテンプレート_刻印減少(1)
		ENDIF
		戦闘中カウント:戦闘行動キャラ:1 = 1
		
		アビテンプレート用_行動消費無しフラグ = 1
ENDSELECT



@固有アビ_64_4(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 隊列番号
隊列番号 = キャラ隊列検索(キャラ番号)

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 80
	アビ名 = 永久誓言
	消費ＭＰ = 300
ENDIF

IF 隊列番号 > -1 && 刻印現在数確認("爱的拯救", 隊列番号) < 4
	IF 陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70 && 展開中フィールド名格納 == "死与爱的世界"
		アビテンプレート用_アビ封印用フラグ = 0
	ELSE
		アビテンプレート用_アビ封印用フラグ = 1
	ENDIF
ENDIF

SIF 隊列番号 > -1 && 戦闘中カウント:隊列番号:2 == 1
	アビテンプレート用_アビ封印用フラグ = 1

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消耗ＭＰ：{消費ＭＰ}<br>赋予自身（独立槽・不可驱散）的永久誓言效果。
		詳細文文字列受け渡し変数 += @"<br>使用此技能时，减少［4］层爱的拯救。"
		詳細文文字列受け渡し変数 += @"<br>此技能每场战斗仅可使用一次。"
		詳細文文字列受け渡し変数 += @"<br>使用此技能不消耗行动次数。"
		RETURN 消費ＭＰ
	CASE "アビ説明文_詳細"
		詳細文文字列受け渡し変数 = 消耗ＭＰ：{消費ＭＰ}<br>赋予自身（独立槽・不可驱散）的永久誓言效果。
		詳細文文字列受け渡し変数 += @"<br>＞赋予［50％］的攻击力提升效果。"
		詳細文文字列受け渡し変数 += @"<br>＞赋予［50％］的防御力提升效果。"
		詳細文文字列受け渡し変数 += @"<br>＞赋予弱化无效效果。"
		詳細文文字列受け渡し変数 += @"<br>使用此技能时，减少［4］层爱的拯救。"
		詳細文文字列受け渡し変数 += @"<br>此技能每场战斗仅可使用一次。"
		詳細文文字列受け渡し変数 += @"<br>使用此技能不消耗行动次数。"
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 永久誓言
		アビ汎用文字列:バフ・デバフ対象能力 = 永久誓言
		アビ汎用変数:持続ターン = -1
		アビ汎用変数:消去不可オプション = 1
		アビ汎用変数:特殊表示オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット

		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 永久誓言_攻撃力
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用変数:効果割合 = 50
		CALL アビテンプレート_有利効果_付随バフ効果セット("永久誓言")

		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 永久誓言_防御力
		アビ汎用文字列:バフ・デバフ対象能力 = 防御力
		アビ汎用変数:効果割合 = 50
		CALL アビテンプレート_有利効果_付随バフ効果セット("永久誓言")

		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 永久誓言_弱体無効
		アビ汎用文字列:バフ・デバフ対象能力 = 弱体無効
		CALL アビテンプレート_有利効果_付随バフ効果セット("永久誓言")

		IF !(陥落チェック(キャラ番号) && 基礎BATTLE_STATE:キャラ番号:Lv >= 70 && 展開中フィールド名格納 == "死与爱的世界")
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用文字列:バフ・デバフ対象能力 = 爱的拯救
			CALL アビテンプレート_刻印減少(4)
		ENDIF
		
		戦闘中カウント:戦闘行動キャラ:2 = 1
		
		アビテンプレート用_行動消費無しフラグ = 1
ENDSELECT



@固有戦闘開始時処理_キャラ_64
#DIM バフ・デバフ行数
#DIM ニーア番号
#DIM 隊列番号

ニーア番号 = GETCHARA(64)
隊列番号 = キャラ隊列検索(ニーア番号)

IF 陥落チェック(ニーア番号)
	アビ汎用文字列:実行時メッセージ１ = 「无论到哪里……都要与你在一起！」
ELSE
	アビ汎用文字列:実行時メッセージ１ = 「连你也要否定我吗……？」
ENDIF

;爱的拯救再付与用
戦闘中カウント:戦闘行動キャラ:0 = 1

CALL アビ対象選択テンプレート_自己のみ

アビ汎用文字列:バフ・デバフ対象能力 = 爱的拯救
アビ汎用変数:累積上限_固定値 = 13
CALL アビテンプレート_刻印追加(13)

CALL アビ汎用変数文字列リセット
アビ汎用文字列:バフ・デバフ枠 = 爱的拯救_被ダメ軽減
アビ汎用文字列:バフ・デバフ対象能力 = 被ダメージ
アビ汎用変数:効果割合 = 90
CALL アビテンプレート_有利効果_付随バフ効果セット("爱的拯救")

アビテンプレート用_アビ名 = 恋人的正位置

CALL アビ汎用変数文字列リセット
CALL アビ対象選択テンプレート_味方全体_生者のみ
アビ汎用文字列:バフ・デバフ枠 = 渴望
アビ汎用文字列:バフ・デバフ対象能力 = 自動復活
アビ汎用変数:効果割合 = 50
アビ汎用変数:持続回数 = 1
アビ汎用変数:消去不可オプション = 1
アビ汎用変数:特殊表示オプション = 1
CALL アビテンプレート_有利効果_バフ効果セット

IF 陥落チェック(ニーア番号) && 基礎BATTLE_STATE:ニーア番号:Lv >= 75
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_味方全体_生者のみ
	アビ汎用文字列:バフ・デバフ枠 = 恋人的正位置
	アビ汎用文字列:バフ・デバフ対象能力 = 弱体無効
	アビ汎用変数:持続回数 = 1
	アビ汎用変数:消去不可オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット
ENDIF



@固有通常攻撃後処理_バフ_永久誓言(バフ・デバフ行数, 全滅フラグ, 連撃数)
#DIM 連撃数
#DIM 全滅フラグ
#DIM バフ・デバフ行数

SIF 全滅フラグ
	RETURN 0

アビテンプレート用_アビ名 = 永久誓言

CALL アビ汎用変数文字列リセット
アビ汎用変数:効果割合 = 200
FOR LOCAL, 0, 6
	CALL アビテンプレート_ダメージ処理_闇属性
NEXT


@固有ターン終了時処理_キャラ_64
;ターン終了時処理関数から呼び出し
#DIM バフ・デバフ行数
#DIM 隊列番号

IF BATTLE_STATE:戦闘行動キャラ:ＨＰ > 0
	;行動後に爱的拯救以外で倒れて自動復活なら減らない
	IF 戦闘中カウント:戦闘行動キャラ:0 == 2
		戦闘中カウント:戦闘行動キャラ:0 = 1
	ELSEIF 戦闘中カウント:戦闘行動キャラ:0
		IF 刻印現在数確認("爱的拯救", 戦闘行動キャラ) > 2
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用文字列:バフ・デバフ対象能力 = 爱的拯救
			CALL アビテンプレート_刻印減少(2)
		ELSEIF 刻印現在数確認("爱的拯救", 戦闘行動キャラ) <= 2 && BATTLE_STATE:戦闘行動キャラ:ＨＰ > 0
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用文字列:バフ・デバフ対象能力 = 爱的拯救
			CALL アビテンプレート_刻印減少(999)
			BATTLE_STATE:戦闘行動キャラ:ＨＰ = 0
			WSTR:(K++) = %CALLNAME:(BATTLE_STATE:戦闘行動キャラ:キャラ登録番号)%已倒下！
			CALL 戦闘不能者登録(戦闘行動キャラ, -1)
		ENDIF
	ELSE
		戦闘中カウント:戦闘行動キャラ:0 = 1
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ対象能力 = 爱的拯救
		アビ汎用変数:累積上限_固定値 = 13
		CALL アビテンプレート_刻印追加(13)
	ENDIF
ENDIF
戦闘中カウント:戦闘行動キャラ:1 = 0



@固有戦闘不能時処理_キャラ_64()
#DIM 対象番号
#DIM 永久誓言
#DIM 渴望
#DIM 自動復活

永久誓言 = バフ番号取得_枠("永久誓言", 戦闘行動キャラ)
自動復活 = バフ番号取得("自動復活", 戦闘行動キャラ)

IF 永久誓言 > -1
	CALL 戦闘効果削除(永久誓言)
ENDIF

IF 刻印現在数確認("爱的拯救", 戦闘行動キャラ) > 0
	CALL アビ対象選択テンプレート_味方全体_生者のみ
	アビ汎用文字列:バフ・デバフ枠 = 残执
	アビ汎用文字列:バフ・デバフ対象能力 = 残执
	アビ汎用変数:持続ターン = 4
	アビ汎用変数:消去不可オプション = 1
	アビ汎用変数:特殊表示オプション = 1
	CALL アビテンプレート_不利効果_デバフ効果セット
	
	CALL アビ対象選択テンプレート_敵全体_生者のみ
	アビ汎用文字列:バフ・デバフ枠 = 残执
	アビ汎用文字列:バフ・デバフ対象能力 = 残执
	アビ汎用変数:持続ターン = 4
	アビ汎用変数:消去不可オプション = 1
	アビ汎用変数:特殊表示オプション = 1
	CALL アビテンプレート_不利効果_デバフ効果セット

	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 残执_防御力
	アビ汎用文字列:バフ・デバフ対象能力 = 防御力
	アビ汎用変数:効果割合 = 50
	アビ汎用文字列:適用範囲 = 敵味方全体
	CALL アビテンプレート_不利効果_付随デバフ効果セット("残执")

	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 残执_連撃率
	アビ汎用文字列:バフ・デバフ対象能力 = 連続攻撃率
	アビ汎用変数:効果量 = 100
	アビ汎用文字列:適用範囲 = 敵味方全体
	CALL アビテンプレート_不利効果_付随デバフ効果セット("残执")

	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 残执_強圧
	アビ汎用文字列:バフ・デバフ対象能力 = 防御力
	アビ汎用文字列:適用範囲 = 敵味方全体
	CALL アビテンプレート_不利効果_付随デバフ効果セット("残执")
ENDIF

IF BATTLE_STATE:戦闘行動キャラ:ＨＰ > 0
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用文字列:バフ・デバフ対象能力 = 爱的拯救
	アビ汎用変数:累積上限_固定値 = 13
	CALL アビテンプレート_刻印追加(13)
	SIF BATTLE_STATE:戦闘行動キャラ:行動済みフラグ
		戦闘中カウント:戦闘行動キャラ:0 = 2
ELSE
	戦闘中カウント:戦闘行動キャラ:0 = 0
ENDIF

@探索欄表示_キャラ_64(レイヤー番号, 隊列番号)
#DIM 隊列番号
#DIM レイヤー番号

GDRAWTEXT レイヤー番号, "爱的拯救:", 120, 90
GSETBRUSH レイヤー番号, 属性数値文字色変換_透明度込(BATTLE_STATE:隊列番号:属性)
GDRAWTEXT レイヤー番号, @"♥{刻印現在数確認("爱的拯救", 隊列番号)}", 200, 90



@バフ・デバフ特殊表示_所爱之人(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 所爱之人
PRINTFORML 必定发动三重攻击，并获得的减伤状态［不可驱散］
PRINTFORML 持续回合：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "持続ターン")}



@バフ・デバフ特殊表示_永久誓言(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 永久誓言
PRINTFORML 攻击力・防御力提升/弱化效果无效化/普通攻击时附加6次暗属性追加伤害的状态［不可驱散］
PRINTFORML ◆尼娅战斗不能时，机体获得永久誓言效果
PRINTFORML 持续回合：永久



@バフ・デバフ特殊表示_爱的拯救(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 爱的拯救
PRINTFORML 每回合减少2层，层数归零的回合结束时进入战斗不能状态，但获得的减伤状态［不可消除］
PRINTFORML 当前层数：{刻印現在数確認("愛ノ救イ", 隊列番号)}



@バフ・デバフ特殊表示_渴望(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 渴望
PRINTFORML 进入战斗不能状态时，获得仅限1次复活的状态［不可驱散］
PRINTFORML 持续次数：1



@バフ・デバフ特殊表示_残执(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 残执
PRINTFORML 防御力・连击率大幅下降/无法回复HP的状态［不可解除］
PRINTFORML 持续回合：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "持続ターン")}



@フィールド説明文_死与爱的世界
#DIM 配列番号

配列番号 = バフ・デバフ効果検索("フィールド", "枠", "死与爱的世界", -1)

LOCALS = 死与爱的世界<br>
LOCALS += "敌我双方攻击力上升/全体队友普通攻击时追加追击的状态<br>"
LOCALS += @"效果回合：{DT_CELL_GET("戦闘効果データベース", 配列番号, "持続ターン")}回合<br>"

詳細文文字列受け渡し変数 = %LOCALS%

;--------------------------------------------------
;戦闘能力画面に表示されるキャラごとの固有処理説明
;--------------------------------------------------
;・使い方
;「XXXX」をキャラクター番号に置換し、それぞれの関数に処理を入れる
;　口上と同じ感覚で使う為に書式を統一しているが、ステータス画面で表示されるので
;　基本的にWAIT系列は使わないことを推奨
;--------------------------------------------------
@口上_ステータス画面_固有特性解説_64(対象キャラ)
#DIM 対象キャラ
CALL 口上変数初期化

KSTR:(K++) = □ 特性：『渴望爱的意志』 □-----------------------------------------------------------------
KSTR:(K++) = 　战斗开始时，自身获得爱的拯救效果［永久/不可驱散］
KSTR:(K++) = 　◆非因爱之救赎效果进入战斗不能时，敌我全体附加残执效果［不可解除］
KSTR:(K++) = 　
IF 陥落チェック(対象キャラ) && 基礎BATTLE_STATE:対象キャラ:Lv >= 70
	KSTR:(K++) = 　
	KSTR:(K++) = □ 特性：『死之抱拥』 □-----------------------------------------------------------------
	KSTR:(K++) = 　死与爱的世界的持续时间延长［3回合］
	KSTR:(K++) = 　死与爱的世界持续期间，发动能力时爱的拯救层数不减少
	KSTR:(K++) = 　
ENDIF
KSTR:(K++) = □ 特性：『恋人的正位置』 □----------------------------------------------------------
IF 陥落チェック(対象キャラ) && 基礎BATTLE_STATE:対象キャラ:Lv >= 75
	KSTR:(K++) = 　编入主力成员时，战斗开始时全体队友附加渴望效果［永久/不可驱散］/弱化无效效果［1次］
ELSE
	KSTR:(K++) = 　编入主力成员时，战斗开始时全体队友附加渴望效果［永久/不可驱散］
ENDIF
KSTR:(K++) = 　◆不可重复发动
KSTR:(K++) = 　
;保留中
;IF 基礎BATTLE_STATE:対象キャラ:Lv >= 70
;	KSTR:(K++) = □ 特性：『至賢の領域・恋人と死』 □--------------------------------------------------
;	KSTR:(K++) = 　搭載兵器『ペイン・オブ・デス』使用時、爱的拯救が6上昇
;	KSTR:(K++) = 　
;ENDIF

CALL 口上変数表示(対象キャラ, 1)


