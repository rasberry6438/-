
@固有アビ_414_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 効果数値, 1

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 25
	アビ名 = 雪氷の叡智+
	消費ＭＰ = 30
ELSE
	アビ名 = 雪氷の叡智
	消費ＭＰ = 40
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に［累積10％最大40％］（累積枠・4ターン）の攻撃力減少効果を与える。
		詳細文文字列受け渡し変数 += @"<br>［累積10％最大40％］（累積枠・4ターン）の防御力減少効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>［攻撃力✕100％］（通常枠・3ターン）の氷結効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>対象に氷結効果が存在する時、［1］のバフ消去を与える。"
		;これでふぃるちゃんのサポアビを発動させて遊ぶ
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_敵単体
		アビ汎用文字列:バフ・デバフ枠 = 攻撃力累積
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用変数:効果割合 = 10
		アビ汎用変数:累積上限_割合 = 40
		アビ汎用変数:持続ターン = 4
		アビ汎用変数:基礎成功確率 = 100
		CALL アビテンプレート_不利効果_デバフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 防御力累積
		アビ汎用文字列:バフ・デバフ対象能力 = 防御力
		アビ汎用変数:効果割合 = 10
		アビ汎用変数:累積上限_割合 = 40
		アビ汎用変数:持続ターン = 4
		アビ汎用変数:基礎成功確率 = 100
		CALL アビテンプレート_不利効果_デバフ効果セット
		
		FOR LOCAL, 10, 20
			IF デバフ番号取得_枠("氷結", LOCAL) > -1
				CALL アビ汎用変数文字列リセット
				アビ汎用変数:効果量 = 1
				CALL アビテンプレート_不利効果_バフ消去
			ENDIF
		NEXT
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 氷結
		アビ汎用文字列:バフ・デバフ対象能力 = 氷結
		CALL バフ込み数値算出("攻撃力")
		アビ汎用変数:効果量 = RESULT
		アビ汎用変数:持続ターン = 3
		アビ汎用変数:基礎成功確率 = 100
		CALL アビテンプレート_不利効果_デバフ効果セット
ENDSELECT




@固有アビ_414_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名


;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 35
	アビ名 = 氷雪の庇護+
	消費ＭＰ = 100
ELSE
	アビ名 = 氷雪の庇護
	消費ＭＰ = 150
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>味方全体に［20％］（通常枠・3ターン）の被ダメージ減少効果を与える。
		詳細文文字列受け渡し変数 += @"<br>［100％］（Ａ枠・3ターン）の弱体耐性上昇効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>［10％］（通常枠・3ターン）の高揚効果を与える。"
		;焔の魔物の攻撃を防いだやつの再現。でもこれ改めて確認したら氷雪の盾出したのふぃるちゃんだったわ。…………まあいっか。
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_味方全体_生者のみ
		アビ汎用変数:効果割合 = 20
		アビ汎用文字列:バフ・デバフ枠 = 被ダメージ減少
		アビ汎用文字列:バフ・デバフ対象能力 = 被ダメージ
		アビ汎用変数:持続ターン = 3
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ対象選択テンプレート_味方全体_生者のみ
		アビ汎用変数:効果割合 = 100
		アビ汎用文字列:バフ・デバフ枠 = 弱体耐性A
		アビ汎用文字列:バフ・デバフ対象能力 = 弱体耐性
		アビ汎用変数:持続ターン = 3
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ対象選択テンプレート_味方全体_生者のみ
		アビ汎用変数:効果量 = 10
		アビ汎用文字列:バフ・デバフ枠 = 高揚
		アビ汎用文字列:バフ・デバフ対象能力 = 高揚
		アビ汎用変数:持続ターン = 3
		CALL アビテンプレート_有利効果_バフ効果セット
ENDSELECT




@固有アビ_414_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 隊列番号
#DIM クールタイム
#DIM バフ行数
隊列番号 = キャラ隊列検索(キャラ番号)


;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 45
	アビ名 = 白銀の威光
	消費ＭＰ = 200
ENDIF

IF INRANGE(隊列番号, 0, 3) && 戦闘中カウント:隊列番号:4
	クールタイム = MAX(0, 10 + 戦闘中カウント:隊列番号:4 - 現在ターン数)
	SIF クールタイム > 0
		アビテンプレート用_アビ封印用フラグ = 1
ELSE
	クールタイム = 0
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}
		詳細文文字列受け渡し変数 += @"<br>自身に（4ターン・消去不可）の白銀の威光効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>このアビリティは［10ターン］のＣＴが発生する。"
		SIF クールタイム > 0
			詳細文文字列受け渡し変数 += @"（残り{クールタイム}ターン）"
		詳細文文字列受け渡し変数 += @"<br>このアビリティを10ターン目以降に使用した時、自身にウェポンバースト効果を与える。"
		;氷龍さまの力を使う感じ+ふぃるちゃんが奥義撃ってアビダメ撃ちまくったら楽しいだろうなあの気持ち。
		;バフ部分は最初威光の方にまとめようとしたけれど、何故か("白銀の威光")ってやると機能しなかったのでこういうちょっと歪な説明文になってしまった
		RETURN 消費ＭＰ
	CASE "アビ説明文_詳細"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}
		詳細文文字列受け渡し変数 += @"<br>自身に（4ターン・消去不可）の白銀の威光効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞味方全体に［100％］のDA率上昇効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞［20％］のTA率上昇効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞［20％］のゲージ上昇効率上昇効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞［20％］の奥義ダメージ上昇効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>このアビリティは［10ターン］のＣＴが発生する。"
		SIF クールタイム > 0
			詳細文文字列受け渡し変数 += @"（残り{クールタイム}ターン）"
		詳細文文字列受け渡し変数 += @"<br>このアビリティを10ターン目以降に使用した時、自身にウェポンバースト効果を与える。"
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 白銀の威光
		アビ汎用文字列:バフ・デバフ対象能力 = 白銀の威光
		アビ汎用変数:持続ターン = 4
		アビ汎用変数:消去不可オプション = 1
		アビ汎用変数:特殊表示オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = DA率_白銀の威光
		アビ汎用文字列:バフ・デバフ対象能力 = DA率
		アビ汎用変数:効果量 = 100
		アビ汎用変数:持続ターン = 4
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:適用範囲 = 味方全体
		CALL アビテンプレート_有利効果_付随バフ効果セット("白銀の威光")
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = TA率_白銀の威光
		アビ汎用文字列:バフ・デバフ対象能力 = TA率
		アビ汎用変数:効果量 = 20
		アビ汎用変数:持続ターン = 4
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:適用範囲 = 味方全体
		CALL アビテンプレート_有利効果_付随バフ効果セット("白銀の威光")
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = ゲージ上昇効率_白銀の威光
		アビ汎用文字列:バフ・デバフ対象能力 = ゲージ上昇効率
		アビ汎用変数:効果量 = 20
		アビ汎用変数:持続ターン = 4
		アビ汎用文字列:適用範囲 = 味方全体
		CALL アビテンプレート_有利効果_付随バフ効果セット("白銀の威光")
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 奥義与ダメ_白銀の威光
		アビ汎用文字列:バフ・デバフ対象能力 = ダメージ補正_奥義ダメージ
		アビ汎用変数:効果量 = 20
		アビ汎用変数:持続ターン = 4
		アビ汎用変数:消去不可オプション = 1
		アビ汎用文字列:適用範囲 = 味方全体
		CALL アビテンプレート_有利効果_付随バフ効果セット("白銀の威光")
		
		IF 現在ターン数 > 9
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			CALL アビテンプレート_有利効果_ウェポンバースト
		ENDIF
		
		戦闘中カウント:戦闘行動キャラ:4 = 現在ターン数
ENDSELECT




@バフ・デバフ特殊表示_白銀の威光(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 白銀の威光
PRINTFORML 奥義が2回発動する状態［消去不可］
PRINTFORML 持続ターン：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "持続ターン")}




;--------------------------------------------------
;戦闘能力の固有処理説明
;--------------------------------------------------
@口上_ステータス画面_固有特性解説_414(対象キャラ)
#DIM 対象キャラ
CALL 口上変数初期化

;口上と同じ感覚で使う為に書式を統一しているが、ステータス画面で表示されるので
;基本的にWAIT系列は使わないことを推奨

KSTR:(K++) = □ 特性 □-------------------------------------------------------------------------------
KSTR:(K++) = 　
KSTR:(K++) = 　
KSTR:(K++) = 　
KSTR:(K++) = 　

CALL 口上変数表示(対象キャラ, 1)










;----------------------------------------------------------------------------------------------------

;本家でこういう感じの性能で実装されたら嬉しいな～～～～の気持ちで作りました。
;いや、本当はもっと強い性能にして欲しい。ルシ天元をふぃるちゃんと一緒に破壊して欲しい。
;
;本当はそのターンに付与された弱体数が10個以上だとなんかするみたいなサポアビも作りたかったけど(泳装ユリウスみたいな)、
;全然上手く出来なくて…どうせ自己満足だし人にわざわざ質問してまで実装するものでも無いかなと思ってやらなかったという言い訳があります。
;
;あとこれはふぃるちゃんの方のことなのですが、
;氷結に反応してアビダメを飛ばすふぃるちゃんのとても重要なサポアビを作ってくださったリゾート管理者様にはお礼申し上げます。
;
;----------------------------------------------------------------------------------------------------
