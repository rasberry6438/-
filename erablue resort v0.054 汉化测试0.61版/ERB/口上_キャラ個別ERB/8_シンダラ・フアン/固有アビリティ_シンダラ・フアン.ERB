
@固有アビ_8_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM シンダラ隊列
#DIM 双虎乱舞
#DIM 虎帯
#DIM 攻撃対象

シンダラ隊列 = キャラ隊列検索(GETCHARA(8))
双虎乱舞 = バフ番号取得_枠("双虎乱舞", シンダラ隊列)

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
	アビ名 = 悪運散虎+
	IF バフ番号取得_枠("双虎乱舞", シンダラ隊列) > -1
		消費ＭＰ = 0
	ELSE
		消費ＭＰ = 100
	ENDIF
ELSE
	アビ名 = 悪運散虎
	IF バフ番号取得_枠("双虎乱舞", シンダラ隊列) > -1
		消費ＭＰ = 0
	ELSE
		消費ＭＰ = 100
	ENDIF
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に［攻撃力✕200％］の土属性ダメージを与える。
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
			詳細文文字列受け渡し変数 += @"<br>［累積10％最大40％］（5ターン）の攻撃力減少効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>［累積10％最大40％］（5ターン）の防御力減少効果を与える。"
		ELSE
			詳細文文字列受け渡し変数 += @"<br>［累積10％最大30％］（5ターン）の攻撃力減少効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>［累積10％最大30％］（5ターン）の防御力減少効果を与える。"
		ENDIF
		詳細文文字列受け渡し変数 += @"<br>◆攻撃対象の虎帯Lvに応じて、自身に強化効果を付与"
		RETURN 消費ＭＰ
	CASE "アビ説明文_詳細"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に［攻撃力✕200％］の土属性ダメージを与える。
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
			詳細文文字列受け渡し変数 += @"<br>［累積10％最大40％］（5ターン）の攻撃力減少効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>［累積10％最大40％］（5ターン）の防御力減少効果を与える。"
		ELSE
			詳細文文字列受け渡し変数 += @"<br>［累積10％最大30％］（5ターン）の攻撃力減少効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>［累積10％最大30％］（5ターン）の防御力減少効果を与える。"
		ENDIF
		詳細文文字列受け渡し変数 += @"<br>以下のうちから、［攻撃対象が持つ虎帯Lv］個のランダムな効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞［20］（通常枠・5ターン）の水属性攻撃減少効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞［20］（通常枠・5ターン）の土属性耐性減少効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞［20％］（通常枠・5ターン）の弱体耐性減少効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞［50％］（通常枠・3ターン）の暗闇効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞［1］のバフ消去を与える。"
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_敵単体
		アビ汎用変数:効果割合 = 200
		CALL アビテンプレート_ダメージ処理_土属性
		
		攻撃対象 = アビテンプレート用_対象保存:0
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 攻撃力_累積枠
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用変数:効果割合 = 10
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
			アビ汎用変数:累積上限_割合 = 40
		ELSE
			アビ汎用変数:累積上限_割合 = 30
		ENDIF
		アビ汎用変数:持続ターン = 5
		CALL アビテンプレート_不利効果_累積デバフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 防御力_累積枠
		アビ汎用文字列:バフ・デバフ対象能力 = 防御力
		アビ汎用変数:効果割合 = 10
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
			アビ汎用変数:累積上限_割合 = 40
		ELSE
			アビ汎用変数:累積上限_割合 = 30
		ENDIF
		アビ汎用変数:持続ターン = 5
		CALL アビテンプレート_不利効果_累積デバフ効果セット
		
		虎帯 = DT_CELL_GET("戦闘効果データベース", デバフ番号取得_枠("虎帯", 攻撃対象), "効果量_固定値")
		IF 虎帯 > 0
			IF 虎帯 < 5
				FOR LOCAL, 0, 虎帯
					$REDRAW1
					SELECTCASE RAND:5
						CASE 0
							IF 戦闘中カウント:戦闘行動キャラ:0 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:0 = 1
						CASE 1
							IF 戦闘中カウント:戦闘行動キャラ:1 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:1 = 1
						CASE 2
							IF 戦闘中カウント:戦闘行動キャラ:2 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:2 = 1
						CASE 3
							IF 戦闘中カウント:戦闘行動キャラ:3 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:3 = 1
						CASE 4
							IF 戦闘中カウント:戦闘行動キャラ:4 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:4 = 1
					ENDSELECT
				NEXT
			ELSEIF 虎帯 == 5
				戦闘中カウント:戦闘行動キャラ:0 = 1
				戦闘中カウント:戦闘行動キャラ:1 = 1
				戦闘中カウント:戦闘行動キャラ:2 = 1
				戦闘中カウント:戦闘行動キャラ:3 = 1
				戦闘中カウント:戦闘行動キャラ:4 = 1 
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:0 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = 属性与ダメージ_水
				アビ汎用文字列:バフ・デバフ対象能力 = 属性与ダメージ_水
				アビ汎用変数:効果割合 = 20
				アビ汎用変数:持続ターン = 5
				CALL アビテンプレート_不利効果_デバフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:1 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = 属性被ダメージ_土
				アビ汎用文字列:バフ・デバフ対象能力 = 属性被ダメージ_土
				アビ汎用変数:効果割合 = 20
				アビ汎用変数:持続ターン = 5
				CALL アビテンプレート_不利効果_デバフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:2 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = 弱体耐性A
				アビ汎用文字列:バフ・デバフ対象能力 = 弱体耐性
				アビ汎用変数:効果割合 = 20
				アビ汎用変数:持続ターン = 5
				CALL アビテンプレート_不利効果_デバフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:3 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = 暗闇
				アビ汎用文字列:バフ・デバフ対象能力 = 暗闇
				アビ汎用変数:効果割合 = 50
				アビ汎用変数:持続ターン = 3
				CALL アビテンプレート_不利効果_デバフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:4 == 1
				CALL アビ汎用変数文字列リセット
				CALL アビテンプレート_不利効果_バフ消去
			ENDIF
			
			戦闘中カウント:戦闘行動キャラ:0 = 0
			戦闘中カウント:戦闘行動キャラ:1 = 0
			戦闘中カウント:戦闘行動キャラ:2 = 0
			戦闘中カウント:戦闘行動キャラ:3 = 0
			戦闘中カウント:戦闘行動キャラ:4 = 0
		ENDIF
		
		IF バフ番号取得_枠("双虎乱舞", シンダラ隊列) > -1
			
			CALL アビ汎用変数文字列リセット
			アビ汎用変数:効果割合 = 200
			CALL アビテンプレート_ダメージ処理_土属性
			
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用文字列:バフ・デバフ枠 = 攻撃力_別枠累積A枠
			アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
			アビ汎用変数:効果割合 = 10
			IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
				アビ汎用変数:累積上限_割合 = 40
			ELSE
				アビ汎用変数:累積上限_割合 = 30
			ENDIF
			アビ汎用変数:持続ターン = -1
			CALL アビテンプレート_有利効果_累積バフ効果セット
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 防御力_累積A枠
			アビ汎用文字列:バフ・デバフ対象能力 = 防御力
			アビ汎用変数:効果割合 = 10
			IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
				アビ汎用変数:累積上限_割合 = 40
			ELSE
				アビ汎用変数:累積上限_割合 = 30
			ENDIF
			アビ汎用変数:持続ターン = -1
			CALL アビテンプレート_有利効果_累積バフ効果セット
			
			虎帯 = DT_CELL_GET("戦闘効果データベース", デバフ番号取得_枠("虎帯", 攻撃対象), "効果量_固定値")
			IF 虎帯 > 0
				IF 虎帯 < 5
					FOR LOCAL, 0, 虎帯
						$REDRAW2
						SELECTCASE RAND:5
							CASE 0
								IF 戦闘中カウント:戦闘行動キャラ:0 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:0 = 1
							CASE 1
								IF 戦闘中カウント:戦闘行動キャラ:1 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:1 = 1
							CASE 2
								IF 戦闘中カウント:戦闘行動キャラ:2 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:2 = 1
							CASE 3
								IF 戦闘中カウント:戦闘行動キャラ:3 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:3 = 1
							CASE 4
								IF 戦闘中カウント:戦闘行動キャラ:4 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:4 = 1
						ENDSELECT
					NEXT
				ELSEIF 虎帯 == 5
					戦闘中カウント:戦闘行動キャラ:0 = 1
					戦闘中カウント:戦闘行動キャラ:1 = 1
					戦闘中カウント:戦闘行動キャラ:2 = 1
					戦闘中カウント:戦闘行動キャラ:3 = 1
					戦闘中カウント:戦闘行動キャラ:4 = 1 
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:0 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用変数:効果量 = 15
					CALL アビテンプレート_有利効果_奥義ゲージUP
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:1 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用文字列:バフ・デバフ枠 = ディスペルガード
					アビ汎用文字列:バフ・デバフ対象能力 = ディスペルガード
					アビ汎用変数:持続回数 = 1
					CALL アビテンプレート_有利効果_バフ効果セット
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:2 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用文字列:バフ・デバフ枠 = 幻影
					アビ汎用文字列:バフ・デバフ対象能力 = 幻影
					アビ汎用変数:持続回数 = 1
					CALL アビテンプレート_有利効果_バフ効果セット
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:3 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用文字列:バフ・デバフ枠 = バリア
					アビ汎用文字列:バフ・デバフ対象能力 = バリア
					アビ汎用変数:効果量 = 300
					アビ汎用変数:持続ターン = -1
					CALL アビテンプレート_不利効果_デバフ効果セット
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:4 == 1
					アビ汎用文字列:バフ・デバフ枠 = 奥義再発動
					アビ汎用文字列:バフ・デバフ対象能力 = 奥義再発動
					アビ汎用変数:持続回数 = 1
					CALL アビテンプレート_有利効果_バフ効果セット
				ENDIF
				
				戦闘中カウント:戦闘行動キャラ:0 = 0
				戦闘中カウント:戦闘行動キャラ:1 = 0
				戦闘中カウント:戦闘行動キャラ:2 = 0
				戦闘中カウント:戦闘行動キャラ:3 = 0
				戦闘中カウント:戦闘行動キャラ:4 = 0
			ENDIF
				
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用変数:消去不可バフデバフ削除オプション = 1
			CALL アビテンプレート_不利効果_バフ消去("双虎乱舞")
			
			アビテンプレート用_行動消費無しフラグ = 1
		ENDIF
ENDSELECT



@固有アビ_8_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM シンダラ隊列
#DIM 双虎乱舞
#DIM 虎帯
#DIM 攻撃対象

シンダラ隊列 = キャラ隊列検索(GETCHARA(8))
;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 65
	アビ名 = 良運散虎+
	IF バフ番号取得_枠("双虎乱舞", シンダラ隊列) > -1
		消費ＭＰ = 0
	ELSE
		消費ＭＰ = 100
	ENDIF
ELSE
	アビ名 = 良運散虎
	IF バフ番号取得_枠("双虎乱舞", シンダラ隊列) > -1
		消費ＭＰ = 0
	ELSE
		消費ＭＰ = 100
	ENDIF
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に［攻撃力✕200％］の土属性ダメージを与える。
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
			詳細文文字列受け渡し変数 += @"<br>自身に［累積10％最大40％］（5ターン）の攻撃力増加効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>［累積10％最大40％］（5ターン）の防御力増加効果を与える。"
		ELSE
			詳細文文字列受け渡し変数 += @"<br>自身に［累積10％最大30％］（5ターン）の攻撃力増加効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>［累積10％最大30％］（5ターン）の防御力増加効果を与える。"
		ENDIF
		詳細文文字列受け渡し変数 += @"<br>◆攻撃対象の虎帯Lvに応じて、自身に強化効果を付与"
		RETURN 消費ＭＰ
	CASE "アビ説明文_詳細"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に［攻撃力✕200％］の土属性ダメージを与える。
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
			詳細文文字列受け渡し変数 += @"<br>自身に［累積10％最大40％］（5ターン）の攻撃力増加効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>［累積10％最大40％］（5ターン）の防御力増加効果を与える。"
		ELSE
			詳細文文字列受け渡し変数 += @"<br>自身に［累積10％最大30％］（5ターン）の攻撃力増加効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>［累積10％最大30％］（5ターン）の防御力増加効果を与える。"
		ENDIF
		詳細文文字列受け渡し変数 += @"<br>以下のうちから、自身に［攻撃対象が持つ虎帯Lv］個のランダムな効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞［15％］の奥義ゲージ増加を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞（通常枠・1回）のディスペルガード効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞（通常枠・1回）の幻影効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞［300］（通常枠）のバリア効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞（通常枠・1回）の奥義再発動効果を与える。"
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_敵単体
		アビ汎用変数:効果割合 = 200
		CALL アビテンプレート_ダメージ処理_土属性
		
		攻撃対象 = アビテンプレート用_対象保存:0
		
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 攻撃力累積
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用変数:効果割合 = 10
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
			アビ汎用変数:累積上限_割合 = 40
		ELSE
			アビ汎用変数:累積上限_割合 = 30
		ENDIF
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_累積バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 防御力累積
		アビ汎用文字列:バフ・デバフ対象能力 = 防御力
		アビ汎用変数:効果割合 = 10
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
			アビ汎用変数:累積上限_割合 = 40
		ELSE
			アビ汎用変数:累積上限_割合 = 30
		ENDIF
		アビ汎用変数:持続ターン = -1
		CALL アビテンプレート_有利効果_累積バフ効果セット
		
		虎帯 = DT_CELL_GET("戦闘効果データベース", デバフ番号取得_枠("虎帯", 攻撃対象), "効果量_固定値")
		IF 虎帯 > 0
			IF 虎帯 < 5
				FOR LOCAL, 0, 虎帯
					$REDRAW1
					SELECTCASE RAND:5
						CASE 0
							IF 戦闘中カウント:戦闘行動キャラ:0 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:0 = 1
						CASE 1
							IF 戦闘中カウント:戦闘行動キャラ:1 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:1 = 1
						CASE 2
							IF 戦闘中カウント:戦闘行動キャラ:2 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:2 = 1
						CASE 3
							IF 戦闘中カウント:戦闘行動キャラ:3 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:3 = 1
						CASE 4
							IF 戦闘中カウント:戦闘行動キャラ:4 == 1
								GOTO REDRAW1
							ENDIF
							戦闘中カウント:戦闘行動キャラ:4 = 1
					ENDSELECT
				NEXT
			ELSEIF 虎帯 == 5
				戦闘中カウント:戦闘行動キャラ:0 = 1
				戦闘中カウント:戦闘行動キャラ:1 = 1
				戦闘中カウント:戦闘行動キャラ:2 = 1
				戦闘中カウント:戦闘行動キャラ:3 = 1
				戦闘中カウント:戦闘行動キャラ:4 = 1 
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:0 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用変数:効果量 = 15
				CALL アビテンプレート_有利効果_奥義ゲージUP
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:1 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = ディスペルガード
				アビ汎用文字列:バフ・デバフ対象能力 = ディスペルガード
				アビ汎用変数:持続回数 = 1
				CALL アビテンプレート_有利効果_バフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:2 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = 幻影
				アビ汎用文字列:バフ・デバフ対象能力 = 幻影
				アビ汎用変数:持続回数 = 1
				CALL アビテンプレート_有利効果_バフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:3 == 1
				CALL アビ汎用変数文字列リセット
				アビ汎用文字列:バフ・デバフ枠 = バリア
				アビ汎用文字列:バフ・デバフ対象能力 = バリア
				アビ汎用変数:効果量 = 300
				アビ汎用変数:持続ターン = -1
				CALL アビテンプレート_不利効果_デバフ効果セット
			ENDIF
			
			IF 戦闘中カウント:戦闘行動キャラ:4 == 1
				アビ汎用文字列:バフ・デバフ枠 = 奥義再発動
				アビ汎用文字列:バフ・デバフ対象能力 = 奥義再発動
				アビ汎用変数:持続回数 = 1
				CALL アビテンプレート_有利効果_バフ効果セット
			ENDIF
			
			戦闘中カウント:戦闘行動キャラ:0 = 0
			戦闘中カウント:戦闘行動キャラ:1 = 0
			戦闘中カウント:戦闘行動キャラ:2 = 0
			戦闘中カウント:戦闘行動キャラ:3 = 0
			戦闘中カウント:戦闘行動キャラ:4 = 0
		ENDIF
		
		IF バフ番号取得_枠("双虎乱舞", シンダラ隊列) > -1
			
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_指定(攻撃対象)
			アビ汎用変数:効果割合 = 200
			CALL アビテンプレート_ダメージ処理_土属性
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 攻撃力_累積枠
			アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
			アビ汎用変数:効果割合 = 10
			IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
				アビ汎用変数:累積上限_割合 = 40
			ELSE
				アビ汎用変数:累積上限_割合 = 30
			ENDIF
			アビ汎用変数:持続ターン = 5
			CALL アビテンプレート_不利効果_累積デバフ効果セット
			
			CALL アビ汎用変数文字列リセット
			アビ汎用文字列:バフ・デバフ枠 = 防御力_累積枠
			アビ汎用文字列:バフ・デバフ対象能力 = 防御力
			アビ汎用変数:効果割合 = 10
			IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
				アビ汎用変数:累積上限_割合 = 40
			ELSE
				アビ汎用変数:累積上限_割合 = 30
			ENDIF
			アビ汎用変数:持続ターン = 5
			CALL アビテンプレート_不利効果_累積デバフ効果セット
			
			攻撃対象 = アビテンプレート用_対象保存:0
			
			虎帯 = DT_CELL_GET("戦闘効果データベース", デバフ番号取得_枠("虎帯", 攻撃対象), "効果量_固定値")
			IF 虎帯 > 0
				IF 虎帯 < 5
					FOR LOCAL, 0, 虎帯
						$REDRAW2
						SELECTCASE RAND:5
							CASE 0
								IF 戦闘中カウント:戦闘行動キャラ:0 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:0 = 1
							CASE 1
								IF 戦闘中カウント:戦闘行動キャラ:1 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:1 = 1
							CASE 2
								IF 戦闘中カウント:戦闘行動キャラ:2 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:2 = 1
							CASE 3
								IF 戦闘中カウント:戦闘行動キャラ:3 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:3 = 1
							CASE 4
								IF 戦闘中カウント:戦闘行動キャラ:4 == 1
									GOTO REDRAW2
								ENDIF
								戦闘中カウント:戦闘行動キャラ:4 = 1
						ENDSELECT
					NEXT
				ELSEIF 虎帯 == 5
					戦闘中カウント:戦闘行動キャラ:0 = 1
					戦闘中カウント:戦闘行動キャラ:1 = 1
					戦闘中カウント:戦闘行動キャラ:2 = 1
					戦闘中カウント:戦闘行動キャラ:3 = 1
					戦闘中カウント:戦闘行動キャラ:4 = 1 
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:0 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用文字列:バフ・デバフ枠 = 属性与ダメージ_水
					アビ汎用文字列:バフ・デバフ対象能力 = 属性与ダメージ_水
					アビ汎用変数:効果割合 = 20
					アビ汎用変数:持続ターン = 5
					CALL アビテンプレート_不利効果_デバフ効果セット
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:1 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用文字列:バフ・デバフ枠 = 属性被ダメージ_土
					アビ汎用文字列:バフ・デバフ対象能力 = 属性被ダメージ_土
					アビ汎用変数:効果割合 = 20
					アビ汎用変数:持続ターン = 5
					CALL アビテンプレート_不利効果_デバフ効果セット
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:2 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用文字列:バフ・デバフ枠 = 弱体耐性A
					アビ汎用文字列:バフ・デバフ対象能力 = 弱体耐性
					アビ汎用変数:効果割合 = 20
					アビ汎用変数:持続ターン = 5
					CALL アビテンプレート_不利効果_デバフ効果セット
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:3 == 1
					CALL アビ汎用変数文字列リセット
					アビ汎用文字列:バフ・デバフ枠 = 暗闇_個人枠
					アビ汎用文字列:バフ・デバフ対象能力 = 暗闇
					アビ汎用変数:効果割合 = 50
					アビ汎用変数:持続ターン = 3
					CALL アビテンプレート_不利効果_デバフ効果セット
				ENDIF
				
				IF 戦闘中カウント:戦闘行動キャラ:4 == 1
					CALL アビ汎用変数文字列リセット
					CALL アビテンプレート_不利効果_バフ消去
				ENDIF
				
				戦闘中カウント:戦闘行動キャラ:0 = 0
				戦闘中カウント:戦闘行動キャラ:1 = 0
				戦闘中カウント:戦闘行動キャラ:2 = 0
				戦闘中カウント:戦闘行動キャラ:3 = 0
				戦闘中カウント:戦闘行動キャラ:4 = 0
			ENDIF
			
				
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用変数:消去不可バフデバフ削除オプション = 1
			CALL アビテンプレート_不利効果_バフ消去("双虎乱舞")

			アビテンプレート用_行動消費無しフラグ = 1
		ENDIF
ENDSELECT



@固有アビ_8_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 対象番号

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 45
	アビ名 = 双虎風水
	消費ＭＰ = 500
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自身に（独自枠・1ターン・消去不可）の双虎風水効果を与える。
		詳細文文字列受け渡し変数 += @"<br>＞［100％］の被ダメージ減少効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞全体かばう効果を与える。"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 双虎風水
		アビ汎用文字列:バフ・デバフ対象能力 = 双虎風水
		アビ汎用変数:持続ターン = 1
		アビ汎用変数:消去不可オプション = 1
		アビ汎用変数:特殊表示オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 双虎風水_完全回避
		アビ汎用文字列:バフ・デバフ対象能力 = 被ダメージ
		アビ汎用変数:効果割合 = 100
		CALL アビテンプレート_有利効果_付随バフ効果セット("双虎風水")
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 双虎風水_全体かばう
		アビ汎用文字列:バフ・デバフ対象能力 = 全体かばう
		CALL アビテンプレート_有利効果_付随バフ効果セット("双虎風水")
ENDSELECT



@固有戦闘開始時処理_キャラ_8

CALL アビ対象選択テンプレート_自己のみ
アビ汎用文字列:バフ・デバフ枠 = 寅神宮の主
アビ汎用文字列:バフ・デバフ対象能力 = 寅神宮の主
アビ汎用変数:持続ターン = -1
アビ汎用変数:消去不可オプション = 1
アビ汎用変数:特殊表示オプション = 1
CALL アビテンプレート_有利効果_パッシブバフ効果セット

CALL アビ汎用変数文字列リセット
アビ汎用文字列:バフ・デバフ枠 = 寅神宮の主_敵対心
アビ汎用文字列:バフ・デバフ対象能力 = 敵対心
アビ汎用変数:効果量 = 100
CALL アビテンプレート_有利効果_付随バフ効果セット("寅神宮の主")

CALL アビ汎用変数文字列リセット
アビ汎用文字列:バフ・デバフ枠 = 寅神宮の主_弱体耐性
アビ汎用文字列:バフ・デバフ対象能力 = 弱体耐性
アビ汎用変数:効果量 = 20
CALL アビテンプレート_不利効果_付随デバフ効果セット("寅神宮の主")

CALL アビ汎用変数文字列リセット
アビ汎用文字列:バフ・デバフ枠 = 寅神宮の主_攻撃力
アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
アビ汎用変数:効果量 = 30
CALL アビテンプレート_有利効果_付随バフ効果セット("寅神宮の主")

CALL アビ汎用変数文字列リセット
アビ汎用文字列:バフ・デバフ枠 = 寅神宮の主_絶対DA
アビ汎用文字列:バフ・デバフ対象能力 = DA率
アビ汎用変数:効果量 = 1000
CALL アビテンプレート_有利効果_付随バフ効果セット("寅神宮の主")

CALL アビテンプレ変数リセット


@固有行動開始時処理_キャラ_8
#DIM シンダラ隊列

シンダラ隊列 = キャラ隊列検索(GETCHARA(8))

IF 行動不能フラグ == 1
	WSTR:(K++) = シンダラの災転福為！
	
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:効果量 = 222
	CALL アビテンプレート_回復処理_MAXでも回復
	
	CALL アビテンプレート_有利効果_デバフ全て消去()
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 再行動
	アビ汎用文字列:バフ・デバフ対象能力 = 再行動
	アビ汎用変数:効果量 = 1
	アビ汎用変数:持続ターン = 2
	アビ汎用変数:消去不可オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 追撃B
	アビ汎用文字列:バフ・デバフ対象能力 = 追撃
	アビ汎用変数:効果割合 = 40
	アビ汎用変数:持続ターン = 2
	アビ汎用変数:消去不可オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット
ENDIF



@固有通常攻撃後処理_キャラ_8(全滅フラグ, 連撃数)
#DIM 連撃数
#DIM 全滅フラグ
#DIM 攻撃対象
#DIM 虎帯攻撃
#DIM 虎帯防御
#DIM 効果倍率

SIF 全滅フラグ
	RETURN 0

IF 連撃数 == 3
	ARRAYCOPY "アビテンプレート用_通常攻撃使用先保存", "アビテンプレート用_対象保存"

	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 虎帯
	アビ汎用文字列:バフ・デバフ対象能力 = 虎帯
	アビ汎用変数:効果量 = 1
	アビ汎用変数:累積上限_固定値 = 5
	アビ汎用変数:持続ターン = -1
	アビ汎用変数:消去不可オプション = 1
	アビ汎用変数:特殊表示オプション = 1
	CALL アビテンプレート_不利効果_累積デバフ効果セット

	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 虎帯_攻撃力
	アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
	アビ汎用変数:付随割合 = 3
	CALL アビテンプレート_不利効果_付随デバフ効果セット("虎帯")

	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 虎帯_防御力
	アビ汎用文字列:バフ・デバフ対象能力 = 防御力
	アビ汎用変数:付随割合 = 3
	CALL アビテンプレート_不利効果_付随デバフ効果セット("虎帯")
ENDIF



@固有ターン終了時処理_キャラ_8
#DIM シンダラ隊列

シンダラ隊列 = キャラ隊列検索(GETCHARA(8))

IF バフ番号取得_枠("双虎風水", シンダラ隊列) > -1
	WSTR:(K++) = シンダラの双虎風水！
	
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用文字列:バフ・デバフ枠 = 与ダメ増加_固有枠
	アビ汎用文字列:バフ・デバフ対象能力 = 与ダメージ
	アビ汎用変数:効果割合 = 25
	アビ汎用変数:持続ターン = 2
	アビ汎用変数:消去不可オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 絶対TA_単体枠
	アビ汎用文字列:バフ・デバフ対象能力 = TA率
	アビ汎用変数:効果量 = 1000
	アビ汎用変数:持続ターン = 2
	アビ汎用変数:消去不可オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット
ENDIF

IF バフ番号取得_枠("双虎風水", シンダラ隊列) > -1
	WSTR:(K++) = シンダラの災転福為！
	
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:効果量 = 222
	CALL アビテンプレート_回復処理_MAXでも回復
	
	CALL アビテンプレート_有利効果_デバフ全て消去()
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 再行動
	アビ汎用文字列:バフ・デバフ対象能力 = 再行動
	アビ汎用変数:効果量 = 1
	アビ汎用変数:持続ターン = 2
	アビ汎用変数:消去不可オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット
	
	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 追撃B
	アビ汎用文字列:バフ・デバフ対象能力 = 追撃
	アビ汎用変数:効果割合 = 40
	アビ汎用変数:持続ターン = 2
	アビ汎用変数:消去不可オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット
ENDIF



@バフ・デバフ特殊表示_寅神宮の主(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 寅神宮の主
PRINTFORML 敵のターゲットにされやすく弱体耐性が低いが、攻撃力が上昇/必ず連続攻撃/トリプルアタック時、敵に虎帯効果を与える状態［消去不可］
PRINTFORML 持続ターン：永続



@バフ・デバフ特殊表示_双虎乱舞(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 双虎乱舞
PRINTFORML 次の悪運散虎・良運招虎が両方発動し、MP・行動回数を消費しない状態［消去不可］
PRINTFORML 持続回数：1



@バフ・デバフ特殊表示_双虎風水(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 双虎風水
PRINTFORML 全ての攻撃を回避/攻撃を味方の代わりに受ける/攻撃行動を行わないが、次のターンに与えるダメージが上昇し必ずトリプルアタックを行う状態［消去不可］
PRINTFORML 持続ターン：1



@バフ・デバフ特殊表示_虎帯(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 虎帯
PRINTFORML Lvに応じて攻撃力・防御力が減少/シンダラの悪運散虎・良運招虎に追加効果が発生する状態［回復不可］
PRINTFORML Lv：{DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "効果量_固定値")}　　　　　持続ターン：永続

