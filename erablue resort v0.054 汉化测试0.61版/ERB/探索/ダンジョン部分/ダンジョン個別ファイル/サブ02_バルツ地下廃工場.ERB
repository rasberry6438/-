

@ダンジョン初期処理_バルツ地下廃工場
;ダンジョン構造の読み込み
;0でない時、そのマスは存在する
#DIM 深度
#DIM 分岐

ダンジョンサブタイトル = AVANDONED FACTORY
ダンジョンマス画像URL_伏せ状態 = 壁_工場
ダンジョン現在位置:0 = 3
ダンジョン現在位置:1 = 8
ダンジョン背景画像 = 背景_工場

;スタート地点は必ず存在
;初期からオープン済みなので3を入れる
;ビット0：存在するか　ビット1：移動できるか　ビット2：マスをオープンするか（ビット１をONにしないと無意味）　ビット3：入れないがオープンする場合に使用
;ビット4以降：自由枠。主に宝箱の開閉やイベント達成フラグなどに使用
IF GETVAR(@"ダンジョン構造配列_%ダンジョン名%:{ダンジョン現在位置:0}:{ダンジョン現在位置:1}") == 0
	SETVAR @"ダンジョン構造配列_%ダンジョン名%:{ダンジョン現在位置:0}:{ダンジョン現在位置:1}", 3
ENDIF

FOR 深度, 1, 100
	LOCAL = 0
	FOR 分岐, 0, 9
		IF GETVAR(@"ダンジョン構造配列_%ダンジョン名%:{深度}:{分岐}")
			;既にマス情報が入ってるなら飛ばす
			LOCAL = 1
			CONTINUE
		ELSEIF ENUMFUNCBEGINSWITH(@"ダンジョンマス情報_%ダンジョン名%_{深度}_{分岐}")
			LOCAL = 1
			SETVAR @"ダンジョン構造配列_%ダンジョン名%:深度:分岐", 1
		ENDIF
	NEXT
	IF LOCAL
		ダンジョン最大深度 = 深度
	ENDIF
NEXT

@ダンジョン解説文_バルツ地下廃工場

詳細文文字列受け渡し変数 = 
詳細文文字列受け渡し変数 += "巴鲁慈地下存在的废弃工厂。偶尔会出现科罗萨斯的同型机。<br>"
詳細文文字列受け渡し変数 += "内部栖息着火属性魔物，若非实力过硬的骑空士进入将十分危险。<br>"
詳細文文字列受け渡し変数 += "但残留着许多未被回收的古代零件等有用素材。<br>"

;推奨レベルを返す
RETURN 12



@敵討伐後処理_ダンジョン固有_バルツ地下廃工場(討伐エネミー数)
;ダンジョン内で戦闘した後に呼ばれる関数、主にダンジョンごとのドロップアイテム取得に使用
;まだ敵データはリセットしていないので敵BATTLE_STATEで色々情報は取得可能
#DIM 討伐エネミー数
#DIM ドロップ確率
#DIMS ドロップアイテム

ドロップ確率 = 10 * 討伐エネミー数
ドロップアイテム = 铁矿石
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

ドロップ確率 = 5 * 討伐エネミー数
ドロップアイテム = 赤热矿
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

ドロップ確率 = 10 * 討伐エネミー数
ドロップアイテム = 陈旧齿轮
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

ドロップ確率 = 5 * 討伐エネミー数
ドロップアイテム = 星晶碎片
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

ドロップ確率 = 1 * 討伐エネミー数
ドロップアイテム = 赤铜古纹
CALL ドロップ判定処理(ドロップ確率, ドロップアイテム)

;---------------------------------------------------------------------
;マップ構造
;---------------------------------------------------------------------
;右ルートと左ルートに分岐するが、右ルートは封印してあり左ルートを進まないと解除されない
;解除するとそのまま奥に進んでコロッサスがいる
;クリアすると乗機システムが開放される。落ちてるアイテムだけで最初の乗機は作成可能。
;（铁矿石６，赤热矿５，古い歯車３）
;---------------------------------------------------------------------
@ダンジョンマス情報_バルツ地下廃工場_0_2(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 0
マス分岐 = 2

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 偏离主道后，发现了散落着各类矿石的房间。
			WSTR:(K++) = 或许是用于分拣资材的场所，给人形状杂乱且不标准的印象。
			WSTR:(K++) = 大部分已氧化风化无法使用……但可以带走几件完好的。
			WSTR:(K++) = %CALLNAME:PLAYER%获得了３个铁矿石！
			CALL 素材入手処理("铁矿石", 3)
		ELSE
			KSTR:(K++) = 已无值得注意的东西。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_0_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 0
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		SIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			ダンジョンマス画像URL_重ね表示 = 会話アイコン
	CASE "接続先"
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4)
			KSTR:(K++) = 机械持续向工厂内输送冷气。
		ELSE
			;最初に訪れた時
			WSTR:(K++) = 房间中央矗立着大型机械。
			WSTR:(K++) = 覆盖整面墙壁并延伸出无数管道的机械似乎处于断电状态。_PAGE
			KSTR:(K++) = 要启动机械电源吗？
			KSTR:(K++) = BUTTON_[启动]
			KSTR:(K++) = BUTTON_[不启动]
			CALL 知識技能所持者検索("機械知識", 1)
			LOCAL:1 = RESULT
			SIF LOCAL:1 > -1
				KSTR:(K++) = BUTTON_[窥探内部]
			$LOOP_MESSAGE
			CALL メッセージ欄表示用関数(,,,0)
			BINPUTS
			SELECTCASE RESULTS
				CASE "[启动]"
					CALL 口上変数初期化
					WSTR:(K++) = %CALLNAME:PLAYER%启动开关后，机械伴随轰鸣声开始运转。
					WSTR:(K++) = 强烈冷气从机械中喷涌而出直击众人！
					WSTR:(K++) = 全员ＭＰ减少５０点！
					CALL メッセージ欄表示用関数(,,,0)
					CALL 口上変数初期化
					FOR LOCAL, 0, 4
						SIF BATTLE_STATE:LOCAL:キャラ登録番号 < 1
							CONTINUE
						BATTLE_STATE:LOCAL:ＭＰ = MAX(BATTLE_STATE:LOCAL:ＭＰ - 50, 0)
					NEXT
					WSTR:(K++) = 在足以冻毙的严寒中，众人慌忙逃出房间。
					WSTR:(K++) = 看来机械的设定出现了异常。
					WSTR:(K++) = 若具备机械知识或许能正确操作……总之这样应该能扩展可移动范围了。
					SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
				CASE "[不启动]"
					CALL 口上変数初期化
					WSTR:(K++) = 暂时先保持原状吧。
				CASE "[窥探内部]"
					WSTR:(K++) = 窥探机械构造。
					WSTR:(K++) = 似乎通过重组内部齿轮可设定冷气喷射方向。
					WSTR:(K++) = 当前设定下冷气会直接喷向这个房间。
					WSTR:(K++) = %CALLNAME:(LOCAL:1)%重组齿轮，将本房间排除在喷射范围外后启动了机械。_PAGE
					WSTR:(K++) = …………看来运转正常了。
					WSTR:(K++) = 这样应该能扩展移动范围了。去探索之前无法通行的区域吧。
					SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
				CASEELSE
					CLEARLINE 1
					REUSELASTLINE  
					GOTO LOOP_MESSAGE
			ENDSELECT
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_1_0(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 1
マス分岐 = 0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 上アイコン
	CASE "接続先"
	CASE "マスイベント"
		;13_8へ
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 传送带向着深处延伸。
			WSTR:(K++) = 远处传来深处金属物体的移动声……
			WSTR:(K++) = 似乎仍有失控机械出没，小心前进吧。
			;移動直後はマスイベント発動しないので、移動先のルート開放をここで行う
			CALL 接続ルート全開放処理(13, 8)
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
		ENDIF
		ダンジョン現在位置:0 = 13
		ダンジョン現在位置:1 = 8
		;移動直後はマスイベント発動しないので、移動先のマス開放をここで行う
		CALL 踏破マス開放処理
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_1_2(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 1
マス分岐 = 2

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "0_2")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "1_0")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 传送带尽头处，机械们正将货物从左到右、从右到左反复搬运。
			WSTR:(K++) = 看来它们已失控，持续进行着无意义的循环作业。
			WSTR:(K++) = 当众人现身时，失控机械们如同发现新任务般袭来！
			CALL メッセージ欄表示用関数(,,,0)
			敵BATTLE_STATE_STR:0:エネミー名 = Lv12_失控机器B
			敵BATTLE_STATE_STR:2:エネミー名 = Lv12_失控机器B
			敵BATTLE_STATE_STR:4:エネミー名 = Lv12_失控机器B
			敵BATTLE_STATE_STR:3:エネミー名 = Lv12_失控机器A
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = %CALLNAME:PLAYER%一行镇压了失控机械。
				WSTR:(K++) = 搬运的货物只是普通瓦砾，没有什么特别有用的东西。
				WSTR:(K++) = 从失控的机器中剥离铁矿石和赤热矿会更有用。
				WSTR:(K++) = 击倒时若发现完好矿石就回收吧。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			ENDIF
		ELSE
			敵BATTLE_STATE_STR:0:エネミー名 = Lv12_失控机器B
			敵BATTLE_STATE_STR:2:エネミー名 = Lv12_失控机器B
			敵BATTLE_STATE_STR:4:エネミー名 = Lv12_失控机器B
			敵BATTLE_STATE_STR:3:エネミー名 = Lv12_失控机器A
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_1_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 1
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "1_2")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 沿着通道前进，发现了破损的传送带。
			WSTR:(K++) = 看来深处是资材分拣场所，原本通过这条传送带运输资材。
			WSTR:(K++) = 继续前进或许能拾取残留的矿石。
			WSTR:(K++) = 仔细搜索可用物品继续前行吧。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 破损的传送带连绵不绝。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_2_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 2
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 魔力不断聚集形成星晶，在房间墙壁上结晶化。
			WSTR:(K++) = 这在魔力浓郁地带偶有发生，但能找到未经开采的实属罕见。
			WSTR:(K++) = 取走几块较大的星晶碎块吧。_PAGE
			WSTR:(K++) = %CALLNAME:PLAYER%获得了１块星晶碎块！
			CALL 素材入手処理("星晶碎块", 1)
		ELSE
			KSTR:(K++) = 墙壁被结晶化的星晶薄薄覆盖。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_2_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 2
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		SIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			ダンジョンマス画像URL_重ね表示 = 会話アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "0_7")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0 && GETBIT(ダンジョン構造配列_バルツ地下廃工場:10:7, 4)
			;開くパターン
			WSTR:(K++) = %CALLNAME:PLAYER%用获得的卡片钥匙打开了门。
			SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSEIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4)
			KSTR:(K++) = 卡片钥匙对应的门已经开启。
		ELSEIF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 道路尽头，光滑的门扉阻挡了去路。
			WSTR:(K++) = 门扉没有把手，纹丝不动。
			WSTR:(K++) = 门侧有一道细长的凹槽。
			WSTR:(K++) = 这应该是钥匙孔吧？若找到板状物品不妨试试。
		ELSE
			KSTR:(K++) = 门扉毫无开启迹象。
			KSTR:(K++) = 门侧有一道细长的凹槽。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_3_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 3
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "1_5")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "5_5")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 这座工厂似乎是古代星之民建造，后被多拉夫族叛乱夺取的设施。
			WSTR:(K++) = 历经岁月却无明显老化痕迹，不愧是星之民的手笔。
			WSTR:(K++) = 但纸质物品显然无法幸免。
			WSTR:(K++) = 墙上刻有「工厂设施图」字样，但下方张贴的纸张已碎成齑粉。
			WSTR:(K++) = 无法辨识内容，只能亲自探索了。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 工厂地图已碎成粉末。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_3_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 3
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "2_7")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "3_5")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "4_7")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 踏入工厂瞬间，刺耳警报响彻空间！
			WSTR:(K++) = 看来工厂机械将%CALLNAME:PLAYER%一行判定为入侵者。
			WSTR:(K++) = 失控机械不由分说袭来！
			CALL メッセージ欄表示用関数(,,,0)
			敵BATTLE_STATE_STR:0:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:2:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:5:エネミー名 = Lv12_失控机器B
			敵BATTLE_STATE_STR:7:エネミー名 = Lv12_失控机器B
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = %CALLNAME:PLAYER%一行镇压了失控机械。
				WSTR:(K++) = 虽惊叹于经年运转的机械仍具威胁，但尚可应对。
				WSTR:(K++) = 仍不可掉以轻心，保持警戒前进吧。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			ENDIF
		ELSE
			敵BATTLE_STATE_STR:0:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:2:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:5:エネミー名 = Lv12_失控机器B
			敵BATTLE_STATE_STR:7:エネミー名 = Lv12_失控机器B
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_3_8(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 3
マス分岐 = 8

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "3_7")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = %CALLNAME:PLAYER%踏入巴鲁慈地下废弃工厂。
			WSTR:(K++) = 自先前事件后，此处时有失控机械型星晶兽出没。
			WSTR:(K++) = 通常委托精锐骑空士处理，此次通过万事屋渠道承接了委托。_PAGE
			IF 鍛冶場作成許可フラグ
				WSTR:(K++) = 听闻此处星晶兽乃古代多拉夫族研发。
				WSTR:(K++) = 或许残留着对机体开发有益的知识与素材。
				WSTR:(K++) = 仔细搜索不放过任何线索吧。
			ELSE
				WSTR:(K++) = 听闻此处星晶兽乃古代多拉夫族研发。
				WSTR:(K++) = 与锻造・开发理念极为契合，实为打造锻造场的绝佳素材。
			ENDIF
			WSTR:(K++) = %CALLNAME:PLAYER%踏入被粗犷钢铁与火焰包围的工厂。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 粗犷钢铁与炽焰构成醒目的废弃工厂景象。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_4_0(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 4
マス分岐 = 0

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 上アイコン
	CASE "接続先"
	CASE "マスイベント"
		;17_8へ
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 通道部分区域熔化的通路仍在向前延伸。
			WSTR:(K++) = 火属性魔力依然浓密地充斥四周。
			WSTR:(K++) = 前方果然会出现大量火精灵，小心前进吧。
			;移動直後はマスイベント発動しないので、移動先のルート開放をここで行う
			CALL 接続ルート全開放処理(17, 8)
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
		ENDIF
		ダンジョン現在位置:0 = 17
		ダンジョン現在位置:1 = 8
		;移動直後はマスイベント発動しないので、移動先のマス開放をここで行う
		CALL 踏破マス開放処理
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_4_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 4
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "4_0")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "2_3")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 通道前方可见移动的光点。
			WSTR:(K++) = 那红光如摇曳火焰，却似拥有自主意识般游走。
			WSTR:(K++) = …………那是火精灵！向着侵入领地的%CALLNAME:PLAYER%一行袭来！
			CALL メッセージ欄表示用関数(,,,0)
			敵BATTLE_STATE_STR:0:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:3:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:4:エネミー名 = Lv13_火元素
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = 成功击退了火精灵群。
				WSTR:(K++) = 此类精灵虽防御薄弱但攻击力出众。
				WSTR:(K++) = 准备防御、恢复或攻击弱化手段能更安全作战。
				WSTR:(K++) = %CALLNAME:PLAYER%一行继续向深处进发。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			ENDIF
		ELSE
			敵BATTLE_STATE_STR:0:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:3:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:4:エネミー名 = Lv13_火元素
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_4_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 4
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "6_7")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 进入通道旁的房间，发现类似更衣室的场所。
			WSTR:(K++) = 似乎是昔日工厂作业人员更衣之处。
			WSTR:(K++) = 调查时发现了职业证。_PAGE
			WSTR:(K++) = 这应该也是星之民技术产物吧，虽经年累月却毫无损伤。
			WSTR:(K++) = 佩戴后似乎能提升机械知识。对探索迷宫大有裨益。
			WSTR:(K++) = 获得职业证「机工士之证」！
			CALL 汎用証取得処理("机工士之证")
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 已无值得注意的东西。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_5_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 5
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "4_3")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "6_3")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 继续前行时，隐约感觉气温有所上升。
			CALL 知識技能所持者検索("機械知識", 1)
			LOCAL = RESULT
			IF LOCAL < 0
				CALL 知識技能所持者検索("魔法知識", 1)
				LOCAL = RESULT
			ENDIF
			IF LOCAL > -1
				WSTR:(K++) = %CALLNAME:LOCAL%察觉前方天花板有异常。
				WSTR:(K++) = 天花板上排列着条状缝隙的通风口。
				KSTR:(K++) = 试着投掷石块后，通风口猛然喷出狂暴热风！！_PAGE
				WSTR:(K++) = 似乎是火属性魔力聚集在管道中，受刺激后喷发。
				WSTR:(K++) = %CALLNAME:PLAYER%一行意识到不可松懈，绷紧神经继续探索。
			ELSE
				WSTR:(K++) = %CALLNAME:PLAYER%一行疑惑前行时，天花板突然喷出灼热气流！
				WSTR:(K++) = 全员ＨＰ减少１5０点！
				CALL メッセージ欄表示用関数(,,,0)
				CALL 口上変数初期化
				FOR LOCAL, 0, 4
					SIF BATTLE_STATE:LOCAL:キャラ登録番号 < 1
						CONTINUE
					BATTLE_STATE:LOCAL:ＨＰ = MAX(BATTLE_STATE:LOCAL:ＨＰ - 150, 0)
				NEXT
				WSTR:(K++) = 推测是火魔力聚集在通风管深处，因通行震动触发喷发。
				WSTR:(K++) = 若有机械或魔法知识或许能预防……
				WSTR:(K++) = %CALLNAME:PLAYER%一行进行烧伤应急处理后继续探索。
			ENDIF
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 热风似乎不再喷发了。
			CALL メッセージ欄表示用関数(,,,0)
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_5_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 5
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "5_3")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 继续前进，发现墙壁与地面呈现扭曲变形。
			WSTR:(K++) = 本应坚固的门扉也熔化成粘稠状凝固物。
			WSTR:(K++) = 显然曾暴露在超乎设计的高温中……_PAGE
			WSTR:(K++) = 或许是古代事故的痕迹？总之前方火魔力形成强烈漩涡。
			WSTR:(K++) = 可能出现大量火精灵，准备水属性耳饰会更轻松。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 墙壁与地面呈现扭曲变形。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_6_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 6
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		IF ダンジョン内一時変数:1 == 0
			ダンジョンマス画像URL_重ね表示 = えっちハート
		ENDIF
	CASE "接続先"
	CASE "マスイベント"
		;えっちイベ
		IF ダンジョン内一時変数:1
		ELSE
			CALL ダンジョンハプニング基本処理()
			IF RESULT
				ダンジョン内一時変数:1 = 1
			ENDIF
			CALL 口上変数初期化
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_6_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 6
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "6_1")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 熔融状的墙壁与地面持续延伸。
			WSTR:(K++) = 虽已凝固不妨碍通行，但何等火力才能造成这般破坏？
			WSTR:(K++) = 虽说工厂动力早已切断不会重演事故……
			WSTR:(K++) = %CALLNAME:PLAYER%仍觉得此地不宜久留。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 熔融状的墙壁与地面持续延伸。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_6_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 6
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		IF ダンジョン内一時変数:0 == 0
			ダンジョンマス画像URL_重ね表示 = 回復アビ
		ENDIF
	CASE "接続先"
	CASE "マスイベント"
		IF ダンジョン内一時変数:0
		ELSE
			KSTR:(K++) = 更衣室深处设有带锁的休息室，似乎很安全。
			KSTR:(K++) = 要稍作休整吗？
			KSTR:(K++) = （全队状态恢复・效果持续至离开迷宫）
			KSTR:(K++) = BUTTON_[确定]
			KSTR:(K++) = BUTTON_[取消]
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			$LOOP_MESSAGE
			INPUTS
			SELECTCASE RESULTS
				CASE "[确定]"
					KSTR:(K++) = 众人在休息室充分休整恢复了体力！
					CALL メッセージ欄表示用関数()
					ダンジョン内一時変数:0 = 1
					FOR LOCAL, 0, 4
						IF BATTLE_STATE:LOCAL:キャラ登録番号 < 1
							BREAK
						ENDIF
						BATTLE_STATE:LOCAL:ＨＰ = BATTLE_STATE:LOCAL:最大ＨＰ
						BATTLE_STATE:LOCAL:ＭＰ = BATTLE_STATE:LOCAL:最大ＭＰ
					NEXT
				CASE "[取消]"
					KSTR:(K++) = 尚未疲惫到需要休息，继续前进吧。
					CALL メッセージ欄表示用関数()
				CASEELSE
					CLEARLINE 1
					REUSELASTLINE  
					GOTO LOOP_MESSAGE
			ENDSELECT
		ENDIF
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_バルツ地下廃工場_8_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 8
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 进入布满监控屏、仪表盘与操作按钮的房间。
			WSTR:(K++) = 似乎是工厂监控设施，但设备均已损坏……
			WSTR:(K++) = ……在周围搜索时发现了金属板。_PAGE
			WSTR:(K++) = 金属板上刻着「冷却装置操作守则」。
			WSTR:(K++) = 「・工厂异常过热时，请启动入口左侧冷却装置。
			WSTR:(K++) = 　・操作需由具备机械知识的职员设定冷却区域。
			WSTR:(K++) = 　・严禁因贪凉擅自使用冷却装置」
			WSTR:(K++) = 写着上述文字……
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 刻有「冷却装置操作守则」的金属板。
			KSTR:(K++) = 「・工厂异常过热时，请启动入口左侧冷却装置。
			KSTR:(K++) = 　・操作需由具备机械知识的职员设定冷却区域。
			KSTR:(K++) = 　・严禁因贪凉擅自使用冷却装置」
			KSTR:(K++) = 写着上述文字……
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_8_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 8
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		SIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			ダンジョンマス画像URL_重ね表示 = 会話アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "8_5")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0 && GETBIT(ダンジョン構造配列_バルツ地下廃工場:10:7, 4)
			;開くパターン
			WSTR:(K++) = %CALLNAME:PLAYER%用获得的卡片钥匙打开了门。
			SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSEIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4)
			KSTR:(K++) = 卡片钥匙对应的门已经开启。
		ELSEIF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 道路尽头，光滑的门扉阻挡了去路。
			WSTR:(K++) = 门扉没有把手，纹丝不动。
			WSTR:(K++) = 门侧有一道细长的凹槽。
			WSTR:(K++) = 这应该是钥匙孔吧？若找到板状物品不妨试试。
		ELSE
			KSTR:(K++) = 门扉毫无开启迹象。
			KSTR:(K++) = 门侧有一道细长的凹槽。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_バルツ地下廃工場_10_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 10
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 会話アイコン
	CASE "接続先"
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			;アイテムあるパターン
			WSTR:(K++) = %CALLNAME:PLAYER%在房间深处发现大型操作杆。
			WSTR:(K++) = 杆体附有金属铭牌，刻着「传送带启动开关」。
			KSTR:(K++) = 要拉下操作杆吗？
			KSTR:(K++) = BUTTON_[确定]
			KSTR:(K++) = BUTTON_[取消]
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			$LOOP_MESSAGE
			INPUTS
			SELECTCASE RESULTS
				CASE "[确定]"
					IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:13:5, 4)
						WSTR:(K++) = 拉下操作杆后，传送带在轰鸣声中开始运转。
						WSTR:(K++) = 周围环境可能发生了变化。重新探索试试吧。
						CALL メッセージ欄表示用関数(,,,0)
						SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
					ELSE
						WSTR:(K++) = 试图拉杆时遇到锁定。
						WSTR:(K++) = 似乎是传送带中途的门扉未开启所致。
						WSTR:(K++) = 记得哪里有类似的门吗？去找找看吧。
						CALL メッセージ欄表示用関数(,,,0)
					ENDIF
				CASE "[取消]"
					WSTR:(K++) = 暂时不碰，先保持原状。
					CALL メッセージ欄表示用関数(,,,0)
				CASEELSE
					CLEARLINE 1
					REUSELASTLINE  
					GOTO LOOP_MESSAGE
			ENDSELECT
		ELSE
			KSTR:(K++) = 传送带已在运转中。
			CALL メッセージ欄表示用関数(,,,0)
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_10_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 10
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		SIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:10:1, 4)
			ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱
		SIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4)
			ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "11_3")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "10_5")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "10_1")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0 && GETBIT(ダンジョン構造配列_バルツ地下廃工場:10:1, 4)
			;アイテムあるパターン
			WSTR:(K++) = %CALLNAME:PLAYER%发现传送带上流动的魔晶石堆。
			WSTR:(K++) = 或许是作为机械动力源保存的资材。
			WSTR:(K++) = 幸运的是仍残留许多可用魔石，心怀感激地收下吧。
			WSTR:(K++) = %CALLNAME:PLAYER%获得了１０颗魔石！
			SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			CALL アイテム増減汎用処理("魔石", 10)
		ELSEIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4)
			KSTR:(K++) = 已无值得注意的物件。
		ELSEIF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 传送带上空无一物。
			WSTR:(K++) = 周围也没有异常之处。
		ELSE
			KSTR:(K++) = 传送带上空无一物。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 接続ルート全開放処理(マス深度, マス分岐)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_10_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 10
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		SIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:10:1, 4)
			ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱
		SIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4)
			ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "10_3")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "10_7")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0 && GETBIT(ダンジョン構造配列_バルツ地下廃工場:10:1, 4)
			;アイテムあるパターン
			WSTR:(K++) = %CALLNAME:PLAYER%发现传送带上的纸质文件束。
			WSTR:(K++) = ……似乎是星晶兽科罗萨斯降级版的设计图。
			IF 鍛冶場作成許可フラグ
				WSTR:(K++) = 凭借此物或许能生产新式机体！
			ELSE
				WSTR:(K++) = 可能派上用场，收下吧。
			ENDIF
			WSTR:(K++) = %CALLNAME:PLAYER%获得了「科罗萨斯・复制品的设计图」！
			CALL 乗機取得処理_設計図("科罗萨斯复制品")
			SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
		ELSEIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4)
			KSTR:(K++) = 已无值得注意的物件。
		ELSEIF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 传送带上空无一物。
			WSTR:(K++) = 周围也没有异常之处。
		ELSE
			KSTR:(K++) = 传送带上空无一物。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 接続ルート全開放処理(マス深度, マス分岐)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_10_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 10
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン_赤
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "10_5")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "12_7")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "8_7")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 传送带上方盘踞着与先前失控机械截然不同的巨型机械。
			WSTR:(K++) = 动作紊乱，远观便知已失控……但显然是个强敌。
			WSTR:(K++) = 不过因体型巨大存在多处死角，或许无需击败也能深入。_PAGE
			KSTR:(K++) = 要与巨型机械交战吗？
			KSTR:(K++) = BUTTON_[确定]
			KSTR:(K++) = BUTTON_[取消]
			CALL メッセージ欄表示用関数(,,,0)
			$LOOP_MESSAGE
			INPUTS
			SELECTCASE RESULTS
				CASE "[确定]"
					CALL 口上変数初期化
					WSTR:(K++) = %CALLNAME:PLAYER%一行摆开阵势向巨型机械发起挑战！
					CALL メッセージ欄表示用関数(,,,0)
					敵BATTLE_STATE_STR:0:エネミー名 = Lv16_巨型管理机器
					CALL 雑魚敵遭遇汎用処理
					IF RESULT == 0
						;勝利時のみ先へ進む
						CALL 口上変数初期化
						WSTR:(K++) = %CALLNAME:PLAYER%一行成功镇压了巨型机械！
						WSTR:(K++) = 战斗冲击震开机械背部的护甲，露出嵌在内部的板状零件。
						WSTR:(K++) = 其尺寸与先前「无法开启的门」侧面的细长凹槽完全吻合。
						WSTR:(K++) = 或许能用此物开启那扇门，试试看吧。
						WSTR:(K++) = %CALLNAME:PLAYER%获得了卡片钥匙！
						CALL メッセージ欄表示用関数(,,,0)
						SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
					ENDIF
				CASE "[取消]"
					CALL 口上変数初期化
					WSTR:(K++) = 敌方可是强敌，需做好万全准备再挑战。
					CALL メッセージ欄表示用関数(,,,0)
				CASEELSE
					CLEARLINE 1
					REUSELASTLINE  
					GOTO LOOP_MESSAGE
			ENDSELECT
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 要重新体验与巨型管理机械的战斗吗？
			KSTR:(K++) = （与中BOSS再战）
			KSTR:(K++) = BUTTON_[确定]
			KSTR:(K++) = BUTTON_[取消]
			CALL メッセージ欄表示用関数(,,,0)
			$LOOP_MESSAGE2
			INPUTS
			SELECTCASE RESULTS
				CASE "[确定]"
					敵BATTLE_STATE_STR:0:エネミー名 = Lv16_巨型管理机器
					CALL 雑魚敵遭遇汎用処理
				CASE "[取消]"
					CALL 口上変数初期化
				CASEELSE
					CLEARLINE 1
					REUSELASTLINE  
					GOTO LOOP_MESSAGE2
			ENDSELECT
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_11_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 11
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		SIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:10:1, 4)
			ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "13_3")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "10_3")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0 && GETBIT(ダンジョン構造配列_バルツ地下廃工場:10:1, 4)
			;敵がいるパターン
			WSTR:(K++) = 传送带在轰鸣声中持续运转。
			WSTR:(K++) = ……竟将失控机械运送了过来！
			CALL メッセージ欄表示用関数(,,,0)
			敵BATTLE_STATE_STR:1:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:5:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:2:エネミー名 = Lv12_失控机器B
			敵BATTLE_STATE_STR:4:エネミー名 = Lv12_失控机器B
			敵BATTLE_STATE_STR:6:エネミー名 = Lv12_失控机器B
			CALL 雑魚敵遭遇汎用処理

			WSTR:(K++) = 传送带可能继续运送新敌人。
			WSTR:(K++) = %CALLNAME:PLAYER%一行迅速撤离了现场。
			CALL メッセージ欄表示用関数(,,,0)
			SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
		ELSEIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4)
			敵BATTLE_STATE_STR:1:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:5:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:2:エネミー名 = Lv12_失控机器B
			敵BATTLE_STATE_STR:4:エネミー名 = Lv12_失控机器B
			敵BATTLE_STATE_STR:6:エネミー名 = Lv12_失控机器B
			CALL 雑魚敵繰り返し戦闘処理
		ELSEIF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 传送带上空无一物。
			WSTR:(K++) = 周围也没有异常之处。
			CALL メッセージ欄表示用関数(,,,0)
		ELSE
			KSTR:(K++) = 传送带上空无一物。
			CALL メッセージ欄表示用関数(,,,0)
		ENDIF
		CALL 接続ルート全開放処理(マス深度, マス分岐)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_12_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 12
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "10_7")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 破损传送带两侧排列着装配大型机械臂的装置。
			WSTR:(K++) = 看似用于分拣传送带资材的机械……
			WSTR:(K++) = ……当众人靠近时，突然开始大幅度挥舞机械臂！果然已失控！
			CALL メッセージ欄表示用関数(,,,0)
			敵BATTLE_STATE_STR:1:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:3:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:4:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:6:エネミー名 = Lv12_失控机器B
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = %CALLNAME:PLAYER%一行镇压了失控机械。
				WSTR:(K++) = 机械臂内部闪烁着微光的零件……
				WSTR:(K++) = 似乎是完好的齿轮，不客气地收下了。
				WSTR:(K++) = %CALLNAME:PLAYER%获得了３个陈旧齿轮！
				CALL 素材入手処理("陈旧齿轮", 3)
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			ENDIF
		ELSE
			敵BATTLE_STATE_STR:1:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:3:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:4:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:6:エネミー名 = Lv12_失控机器B
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_13_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 13
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "11_3")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "13_5")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0 && GETBIT(ダンジョン構造配列_バルツ地下廃工場:10:1, 4)
			;アイテムあるパターン
			WSTR:(K++) = %CALLNAME:PLAYER%发现传送带上的纸质文件束。
			WSTR:(K++) = ……但所有文件都焦黑碳化无法辨识。
			WSTR:(K++) = 试着用手触碰，结果瞬间碎成炭渣。
			WSTR:(K++) = 去别处探索吧。
			SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
		ELSEIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4)
			KSTR:(K++) = 只剩炭渣堆积成山。
		ELSEIF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 传送带上空无一物。
			WSTR:(K++) = 周围也没有异常之处。
		ELSE
			KSTR:(K++) = 传送带上空无一物。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 接続ルート全開放処理(マス深度, マス分岐)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_13_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 13
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		SIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			ダンジョンマス画像URL_重ね表示 = 会話アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "15_5")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "13_3")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0 && GETBIT(ダンジョン構造配列_バルツ地下廃工場:10:7, 4)
			;開くパターン
			WSTR:(K++) = %CALLNAME:PLAYER%用获得的卡片钥匙打开了门。
			SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSEIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4)
			KSTR:(K++) = 卡片钥匙对应的门已经开启。
		ELSEIF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 道路尽头，光滑的门扉阻挡了去路。
			WSTR:(K++) = 门扉没有把手，纹丝不动。
			WSTR:(K++) = 门侧有一道细长的凹槽。
			WSTR:(K++) = 这应该是钥匙孔吧？若找到板状物品不妨试试。
		ELSE
			KSTR:(K++) = 门扉毫无开启迹象。
			KSTR:(K++) = 门侧有一道细长的凹槽。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_13_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 13
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "13_5")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "12_7")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 传送带在前方分岔为正面与左侧通道。
			WSTR:(K++) = 但正面通道被厚重门扉封锁。
			SIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:2:7, 2)
				WSTR:(K++) = 结构与入口附近的门扉相同。
			WSTR:(K++) = 目前似乎无法开启，改道左侧吧。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 传送带在前方分岔为正面与左侧通道。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_13_8(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 13
マス分岐 = 8

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 下アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "13_7")
	CASE "マスイベント"
		;1_0へ
		ダンジョン現在位置:0 = 1
		ダンジョン現在位置:1 = 0
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_バルツ地下廃工場_15_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 15
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 卡片钥匙门后的通道堆积着大量矿石。
			WSTR:(K++) = 虽然通道坍塌无法通行，但残留许多可用矿石。
			WSTR:(K++) = 根据契约，废弃工厂内获取物资均可带回。
			WSTR:(K++) = 无需客气尽数收取。
			WSTR:(K++) = %CALLNAME:PLAYER%获得了３个铁矿石、５个赤热矿！
			CALL 素材入手処理("铁矿石", 3)
			CALL 素材入手処理("赤热矿", 5)
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 已无可用矿石残留。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_16_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 16
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 看似通道的区域因瓦砾坍塌无法通行。
			WSTR:(K++) = 从位置判断，可能是接收对面传送带矿石的通道？
			WSTR:(K++) = 但此侧残留矿石均已风化失效。
			IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:15:5, 2) == 0
				WSTR:(K++) = 或许对面通道仍有可用矿石。
			ENDIF
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 因瓦砾坍塌无法通行。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_17_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 17
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "18_1")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 击退火精灵继续深入，后方袭来强烈威压！
			WSTR:(K++) = 似乎有高阶精灵盘踞于此……
			WSTR:(K++) = 其强度与工厂内其他敌人有天壤之别。
			WSTR:(K++) = 恐怕需要_COLOR_%カラーパレット_HTML("真っ赤")%_Lv35左右_方能应对。
			WSTR:(K++) = 或许该先探索其他路线。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSEIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:18:1, 4)
			;強敵撃破後
			KSTR:(K++) = 强敌已被讨伐。
		ELSE
			KSTR:(K++) = 感知到强敌气息……若无_COLOR_%カラーパレット_HTML("真っ赤")%_Lv35左右_的实力，最好莫要接近。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_17_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 17
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "17_1")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = %CALLNAME:PLAYER%一行前行时，火精灵群聚拢阻截去路！
			CALL メッセージ欄表示用関数(,,,0)
			敵BATTLE_STATE_STR:0:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:5:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:2:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:6:エネミー名 = Lv13_火元素
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = 虽成功击退精灵，但觉其行动蹊跷。
				WSTR:(K++) = 普通精灵仅会攻击靠近者，方才精灵却似在阻止深入。
				WSTR:(K++) = 莫非深处藏有什么东西？
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			ENDIF
		ELSE
			敵BATTLE_STATE_STR:0:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:5:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:2:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:6:エネミー名 = Lv13_火元素
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_17_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 17
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 会話アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "17_3")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "20_5")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "16_5")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0 && GETBIT(ダンジョン構造配列_バルツ地下廃工場:0:7, 4)
			;進めるパターン
			WSTR:(K++) = 冷却装置运转中，持续降低工厂温度。
			IF 初来訪マス判定用フラグ
				WSTR:(K++) = 此区域曾因高温无法通行。
			ENDIF
			WSTR:(K++) = 现已可安全通行，%CALLNAME:PLAYER%一行继续前进。
			SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSEIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4)
			KSTR:(K++) = 冷却装置运转中，持续降低工厂温度。
		ELSEIF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 前行时热浪愈发强烈。
			WSTR:(K++) = 徒手触碰墙壁恐将灼伤。
			WSTR:(K++) = 贸然前进等同自杀，必须设法降温。
			WSTR:(K++) = %CALLNAME:PLAYER%一行决定暂时折返……
		ELSE
			KSTR:(K++) = 未找到降温手段前无法深入。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_17_8(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 17
マス分岐 = 8

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 下アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "17_5")
	CASE "マスイベント"
		;4_0へ
		ダンジョン現在位置:0 = 4
		ダンジョン現在位置:1 = 0
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_18_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 18
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン_赤
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "18_4")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			CALL 強敵マス確認
			SIF RESULT == 1
				RETURN 0
			;最初に訪れた時
			WSTR:(K++) = 火系上位精灵显现在%CALLNAME:PLAYER%一行面前。
			WSTR:(K++) = 挥舞喷涌烈焰的巨臂释放灼热气浪。
			WSTR:(K++) = 精灵剧烈震颤身躯，向%CALLNAME:PLAYER%一行袭来！
			CALL メッセージ欄表示用関数(,,,0)
			敵BATTLE_STATE_STR:0:エネミー名 = Lv35_火灵巴塞洛缪斯
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時
				SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
				WSTR:(K++) = %CALLNAME:PLAYER%一行成功讨伐了强敌！
				WSTR:(K++) = 从强敌处获得若干饰品与财宝。
				WSTR:(K++) = 从火灵巴塞洛缪斯处获得戒指「精灵之戒・火」！
				WSTR:(K++) = 从火灵巴塞洛缪斯处获得戒指「精灵耳饰・火」！
				WSTR:(K++) = 从火灵巴塞洛缪斯处获得100,000卢比！
				MONEY += 100000
				CALL 汎用指輪取得処理("精灵之戒・火", 3)
				CALL 汎用耳飾り取得処理("精灵耳饰・火")
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				CALL 口上変数初期化
			ELSEIF RESULT == -1
				;逃走時
				WSTR:(K++) = %CALLNAME:PLAYER%一行勉强从强敌手中逃脱。
				WSTR:(K++) = 下次变强些再来挑战吧…
				CALL メッセージ欄表示用関数(,,,0)
				CALL 口上変数初期化
			ENDIF
		ELSE
			KSTR:(K++) = 强敌早已被讨伐。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
			CALL メッセージ欄表示用関数(,,,0)
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_18_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 18
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 会話アイコン
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;立ち絵リソース記録に必要な画像のリソースを生成する
			CALLF 顔グラ表示用文字列関数(キャラ検索("[绯红焰影]玛尔斯"),100,,,1,1)
			LOCALS = %立ち絵リソース記録%
			;最初に訪れた時
			WSTR:(K++) = 击退火系上位精灵后，发现高挑的美女正在沉睡。
			WSTR:(K++) = 感知到强烈的火属性与光属性魔力……她绝非空之民，应是星晶兽。
			WSTR:(K++) = %CALLNAME:PLAYER%靠近时，她缓缓睁眼。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「────正想着上位精灵是被何方神圣击溃」
			WSTR:(K++) = 「没想到是带着异样气息的人类啊」
			WSTR:(K++) = 美女起身，仔细端详着%CALLNAME:PLAYER%。
			CALL メッセージ欄表示用関数(LOCALS,"神秘美女",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 此处不该是机械型星晶兽的巢穴吗？%CALLNAME:PLAYER%问道。
			WSTR:(K++) = 从未听闻有她这般存在潜伏于此。
			WSTR:(K++) = 为何能在此长眠而不被察觉？
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「啊，很简单」
			WSTR:(K++) = 「我在等待强者，能击溃上位精灵的战士」
			WSTR:(K++) = 「足以与我展开炽热对决的对手……！」
			CALL メッセージ欄表示用関数(LOCALS,"神秘美女",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 强烈杀气扑面而来，%CALLNAME:PLAYER%们瞬间摆出战斗姿态。
			WSTR:(K++) = 感知其威压，竟比先前上位精灵强横数倍！
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 星晶兽见%CALLNAME:PLAYER%一行戒备，却收敛了杀气。
			WSTR:(K++) = 「不错的反应。虽可即刻享用……」
			WSTR:(K++) = 「……但你们还能更强。等待成熟之刻亦无妨」
			WSTR:(K++) = 「毕竟已沉眠至今。多等些时日也无妨」
			CALL メッセージ欄表示用関数(LOCALS,"神秘美女",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 虽逻辑牵强，%CALLNAME:PLAYER%仍庆幸免于连续对抗上位精灵与星晶兽。
			WSTR:(K++) = 不过放任此等星晶兽自由行动终非良策。
			WSTR:(K++) = 虽无把握，%CALLNAME:PLAYER%仍尝试介绍度假岛情况。
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「嚯……？ 度假无所谓，但强者云集倒是不错」
			WSTR:(K++) = 「权当消遣亦可。兴致来时定会造访」
			CALL メッセージ欄表示用関数(LOCALS,"神秘美女",,0)
			CALL 口上変数初期化
			WSTR:(K++) = 「吾乃星晶兽玛尔斯」
			WSTR:(K++) = 「在你让我热血沸腾之前，我会耐心等待」
			CALL メッセージ欄表示用関数(LOCALS,"星晶兽玛尔斯",,0)
			CALL 口上変数初期化
			WSTR:(K++) = [绯红焰影]玛尔斯开始造访度假村了！
			LOCAL = GETCHARA(138)
			CFLAG:LOCAL:招待不可フラグ = 0
		ELSE
			KSTR:(K++) = 已空无一人。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_バルツ地下廃工場_20_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 20
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "22_1")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 继续探索时进入非常广阔的空间。
			WSTR:(K++) = 虽为通道，宽度却足以容纳两三栋房屋并列。
			WSTR:(K++) = 想必是为机械型星晶兽通行设计的规格。
			WSTR:(K++) = 目标星晶兽必在前方无疑。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 延伸着供星晶兽通行的宽阔通道。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_20_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 20
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "20_1")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 通道深处，失控机械与火精灵群聚共生。
			WSTR:(K++) = 并非敌对，而是被机械动力源散发的火魔力吸引。
			WSTR:(K++) = 形成奇特的共生关系。
			WSTR:(K++) = 印证此推测般，察觉%CALLNAME:PLAYER%们的机械群协同袭来！
			CALL メッセージ欄表示用関数(,,,0)
			敵BATTLE_STATE_STR:0:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:4:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:3:エネミー名 = Lv12_失控机器B
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = 击溃精灵与机械的联合作战。
				WSTR:(K++) = 需避免被高火力精灵吸引注意时遭受机械大招突袭。
				WSTR:(K++) = 选择速战速决或干扰敌方攻击。
				WSTR:(K++) = 必须制定相应战术应对。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			ENDIF
		ELSE
			敵BATTLE_STATE_STR:0:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:4:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:3:エネミー名 = Lv12_失控机器B
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_20_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 20
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "20_3")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "20_7")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 通道墙壁与地面仍有余温。
			WSTR:(K++) = 虽然冷却装置降低了气温，但结构体内部仍积蓄着热量。
			WSTR:(K++) = 或许是深处机械型星晶兽的影响……
			WSTR:(K++) = ……但未曾听闻先前讨伐引发过此类现象。
			WSTR:(K++) = 可能正发生某种异常，谨慎前进吧。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 通道墙壁与地面仍有余温。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_20_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 20
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "22_7")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 探索岔路时感到些许凉意。
			WSTR:(K++) = 此区域热浪影响较弱。
			WSTR:(K++) = 门扉上方金属铭牌刻着「设计室」。
			WSTR:(K++) = 或许残留着有用资料？继续探索吧。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 门扉上方金属铭牌刻着「设计室」。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_バルツ地下廃工場_22_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 22
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 会話アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "22_3")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "23_1")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 通道旁延伸的管道传出异响.……
			CALL 知識技能所持者検索("機械知識", 1)
			LOCAL = RESULT
			IF LOCAL > -1
				WSTR:(K++) = %CALLNAME:LOCAL%迅速靠近管道转动阀门。
				WSTR:(K++) = 释放内部压力后异响即刻消失。
				WSTR:(K++) = 若放任不管恐将引发管道爆裂，那真是惊险万分。
				WSTR:(K++) = 确认其他管道安全后，%CALLNAME:PLAYER%一行继续前进。
			ELSE
				WSTR:(K++) = 看起来很危险所以不要靠近。
				WSTR:(K++) = %CALLNAME:PLAYER%一行做出判断选择远离时，突然管道爆炸了！ ！
				WSTR:(K++) = 全员ＨＰ减少２００点！
				CALL メッセージ欄表示用関数(,,,0)
				CALL 口上変数初期化
				FOR LOCAL, 0, 4
					SIF BATTLE_STATE:LOCAL:キャラ登録番号 < 1
						CONTINUE
					BATTLE_STATE:LOCAL:ＨＰ = MAX(BATTLE_STATE:LOCAL:ＨＰ - 200, 0)
				NEXT
				WSTR:(K++) = 管道耐久已达极限，必须及时减压。
				WSTR:(K++) = 若有机械知识或能正确处置……
				WSTR:(K++) = 确认其他管道安全后，%CALLNAME:PLAYER%一行继续前进。
			ENDIF
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 已无危险管道。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_22_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 22
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "23_3")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 通道中央失控机械与火精灵如舞蹈般游走。
			WSTR:(K++) = 视野开阔处难以潜行。
			WSTR:(K++) = %CALLNAME:PLAYER%一行握紧武器投入战斗。
			CALL メッセージ欄表示用関数(,,,0)
			敵BATTLE_STATE_STR:2:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:1:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:4:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:3:エネミー名 = Lv12_失控机器A
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = 镇压机械确保周边安全。
				WSTR:(K++) = 不久新机械涌现时精灵亦将回归。
				WSTR:(K++) = 需在此之前推进。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			ENDIF
		ELSE
			敵BATTLE_STATE_STR:2:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:1:エネミー名 = Lv12_失控机器A
			敵BATTLE_STATE_STR:4:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:3:エネミー名 = Lv12_失控机器A
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_22_6(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 22
マス分岐 = 6

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		IF ダンジョン内一時変数:2 == 0
			ダンジョンマス画像URL_重ね表示 = えっちハート
		ENDIF
	CASE "接続先"
	CASE "マスイベント"
		;えっちイベ
		IF ダンジョン内一時変数:2
		ELSE
			CALL ダンジョンハプニング基本処理()
			IF RESULT
				ダンジョン内一時変数:2 = 1
			ENDIF
			CALL 口上変数初期化
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_22_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 22
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "22_6")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "23_7")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 设计室残留着若干古老资料。
			WSTR:(K++) = 或因保存良好，仍可辨识内容。
			WSTR:(K++) = 具有历史价值的文献，报告给巴鲁慈大公可获收购。
			WSTR:(K++) = %CALLNAME:PLAYER%获得了50,000卢比！
			MONEY += 50000
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 已无有价值资料。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_23_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 23
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 右アイコン
	CASE "接続先"
	CASE "マスイベント"
		;24_1へ
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 一块巨大的隔墙倒塌，挡住了宽阔的走廊。
			WSTR:(K++) = 然而由于暴露在高温下，隔墙也已经融化。
			WSTR:(K++) = 能熔穿厚重隔墙的火力，果然源自星晶兽？
			WSTR:(K++) = 既有冷却装置运作应无大碍……但仍需小心前行。
			;移動直後はマスイベント発動しないので、移動先のルート開放をここで行う
			CALL 接続ルート全開放処理(24, 1)
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
		ENDIF
		ダンジョン現在位置:0 = 24
		ダンジョン現在位置:1 = 1
		;移動直後はマスイベント発動しないので、移動先のマス開放をここで行う
		CALL 踏破マス開放処理
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_23_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 23
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 发现了被泥沙掩埋的入口。
			WSTR:(K++) = 从结构来看似乎通向地面，但要挖掘这里需要耗费漫长岁月。
			WSTR:(K++) = 或许这里原本是机械型星晶兽出击的通道。
			WSTR:(K++) = 但现在派不上用场，探索其他场所吧。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 入口被泥沙掩埋。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_23_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 23
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 在设计室深处发现了一堆有趣的设计图。
			WSTR:(K++) = 记载着搭载于载具使用的通用型武器制作方法。
			IF 鍛冶場作成許可フラグ
				WSTR:(K++) = 凭借此物或许能生产新式机体武器！
			ELSE
				WSTR:(K++) = 可能派上用场，收下吧。
			ENDIF
			WSTR:(K++) = %CALLNAME:PLAYER%获得了多种搭载兵器的设计图！
			CALL 汎用搭載兵器取得処理_設計図("10mm火神炮")
			CALL 汎用搭載兵器取得処理_設計図("19mm狙击炮")
			CALL 汎用搭載兵器取得処理_設計図("30mm榴弹炮")
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 已无值得注意的东西。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_24_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 24
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 左アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "26_1")
	CASE "マスイベント"
		;23_1へ
		ダンジョン現在位置:0 = 23
		ダンジョン現在位置:1 = 1
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_25_5(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 25
マス分岐 = 5

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン_赤
	CASE "接続先"
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			CALL 強敵マス確認
			SIF RESULT == 1
				RETURN 0
			;最初に訪れた時
			WSTR:(K++) = %CALLNAME:PLAYER%一行抵达废弃工厂最深处。
			WSTR:(K++) = 形似机库的空间里伫立着黑钢铸造的巨人。
			WSTR:(K++) = 但正如委托情报所述，巨人显然处于失控状态。
			WSTR:(K++) = 发现%CALLNAME:PLAYER%一行身影的瞬间便启动袭来！！
			CALL メッセージ欄表示用関数(,,,0)
			敵BATTLE_STATE_STR:0:エネミー名 = Lv18_科罗萨斯
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;立ち絵リソース記録に必要な画像のリソースを生成する
				CALLF 顔グラ表示用文字列関数(キャラ検索("[钢铁巨人]科罗萨斯"),100,,,1,1)
				LOCALS = %立ち絵リソース記録%
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = %CALLNAME:PLAYER%一行成功讨伐科罗萨斯。
				WSTR:(K++) = 随着失控状态解除，科罗萨斯收敛敌意恢复平静。
				WSTR:(K++) = 赤红的眼部指示灯转为黄色，仿佛正注视着众人。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 口上変数初期化
				WSTR:(K++) = 「────」
				CALL メッセージ欄表示用関数(LOCALS,"星晶兽科罗萨斯",,0)
				CALL 口上変数初期化
				WSTR:(K++) = 科罗萨斯微微颤动机体发出声响。
				WSTR:(K++) = 虽是普通驱动音，%CALLNAME:PLAYER%却莫名理解其意图……
				WSTR:(K++) = 难道这也是和星晶兽艾拉契约的效果……？
				CALL メッセージ欄表示用関数(LOCALS,"星晶兽科罗萨斯",,0)
				CALL 口上変数初期化
				WSTR:(K++) = 科罗萨斯似乎因停止失控向%CALLNAME:PLAYER%一行表达感谢。
				WSTR:(K++) = 更能感受到它想要回馈恩情的心意。
				CALL メッセージ欄表示用関数(LOCALS,"星晶兽科罗萨斯",,0)
				IF 鍛冶場作成許可フラグ == 0
					CALL 口上変数初期化
					WSTR:(K++) = %CALLNAME:PLAYER%顺势邀请其造访度假岛。
					WSTR:(K++) = 说明需要协助建造锻造强力装备的设施。
					CALL メッセージ欄表示用関数(,,,0)
					CALL 口上変数初期化
					WSTR:(K++) = 「────」
					WSTR:(K++) = 科罗萨斯以驱动音表示应允。
					WSTR:(K++) = 随即运用星晶兽之力，在%CALLNAME:PLAYER%眼前凝聚光芒────
					CALL メッセージ欄表示用関数(LOCALS,"星晶兽科罗萨斯",,0)
				ELSE
					CALL 口上変数初期化
					WSTR:(K++) = %CALLNAME:PLAYER%向星晶兽说明原委。
					WSTR:(K++) = 坦言为筹建锻造设施前来取经。
					CALL メッセージ欄表示用関数(,,,0)
					CALL 口上変数初期化
					WSTR:(K++) = 「────」
					WSTR:(K++) = 科罗萨斯提议运用力量改良锻造设施。
					WSTR:(K++) = 称若将自身力量注入设施，效率将不逊于巴鲁慈的工坊。
					CALL メッセージ欄表示用関数(LOCALS,"星晶兽科罗萨斯",,0)
					CALL 口上変数初期化
					WSTR:(K++) = %CALLNAME:PLAYER%顺势邀请科罗萨斯同行。
					WSTR:(K++) = 科罗萨斯便运用星晶兽之力，在%CALLNAME:PLAYER%眼前凝聚光芒────
					CALL メッセージ欄表示用関数(,,,0)
				ENDIF
				$選択肢ラベル
				CALL 口上変数初期化
				KSTR:(K++) = ※关于星晶兽科罗萨斯的形态可选择。
				KSTR:(K++) = 　请选择任意选项。
				KSTR:(K++) = BUTTON_[科罗萨斯以人类大小的形态活动]
				KSTR:(K++) = BUTTON_[以科罗玛格酱形态活动]
				KSTR:(K++) = BUTTON_[科罗玛格酱是什么？]_（显示说明。选择此项不会推进剧情）
				CALL メッセージ欄表示用関数(,,,0)
				$LOOP_MESSAGE
				INPUTS
				SELECTCASE RESULTS
					CASE "[科罗萨斯以人类大小的形态活动]"
						CALL 口上変数初期化
						WSTR:(K++) = 光芒收敛后，%CALLNAME:PLAYER%面前矗立着超过2米的钢甲巨人。
						WSTR:(K++) = 似乎是制造了适合在人类设施活动的小型分身。
						WSTR:(K++) = 能获得协助自是越快越好。
						WSTR:(K++) = %CALLNAME:PLAYER%即刻带领星晶兽科罗萨斯返回度假村。_PAGE
						WSTR:(K++) = [钢铁巨人]科罗萨斯开始造访度假村了！
						IF 鍛冶場作成許可フラグ == 0
							WSTR:(K++) = 解锁设施改造「锻造设施」！
							WSTR:(K++) = 道具店新增「火之魔石」！
						ELSE
							WSTR:(K++) = 锻造设施消耗卢比减少１０％！
						ENDIF
						LOCAL = GETCHARA(136)
					CASE "[以科罗玛格酱形态活动]"
						;立ち絵リソース記録に必要な画像のリソースを生成する
						CALLF 顔グラ表示用文字列関数(キャラ検索("[钢铁小巨人]科罗玛格酱"),100,,,1,1)
						LOCALS = %立ち絵リソース記録%
						CALL 口上変数初期化
						WSTR:(K++) = 光芒收敛后，%CALLNAME:PLAYER%面前站着约120厘米高的多拉夫族少女。
						WSTR:(K++) = 似乎是制造了适合在人类设施活动的小型分身。
						WSTR:(K++) = 能获得协助自是越快越好。
						WSTR:(K++) = %CALLNAME:PLAYER%即刻带领星晶兽科罗玛格酱返回度假村。
						CALL メッセージ欄表示用関数(LOCALS,"科罗玛格酱",,0)
						CALL 口上変数初期化
						WSTR:(K++) = [钢铁小巨人]科罗玛格酱开始造访度假村了！
						IF 鍛冶場作成許可フラグ == 0
							WSTR:(K++) = 解锁设施改造「锻造设施」！
							WSTR:(K++) = 道具店新增「火之魔石」！
						ELSE
							WSTR:(K++) = 锻造设施消耗卢比减少１０％！
						ENDIF
						LOCAL = GETCHARA(137)
					CASE "[科罗玛格酱是什么？]"
						CALL 口上変数初期化
						WSTR:(K++) = ■科罗玛格酱
						WSTR:(K++) = 　二次创作诞生的角色。
						KSTR:(K++) = 　设定为「从被击破的科罗萨斯・玛格纳驾驶舱中发现，
						WSTR:(K++) = 　　随后被骑空团保护并共同行动的１０岁左右多拉夫族少女」。
						WSTR:(K++) = 　头上巨角带有科罗萨斯风格纹样，白发飘扬的无口无表情少女。
						WSTR:(K++) = 　真实身份不明，在碧蓝度假村中作为「科罗萨斯精神拟人化存在」处理。
						CALL メッセージ欄表示用関数(,,,0)
						GOTO 選択肢ラベル
					CASEELSE
						CLEARLINE 1
					REUSELASTLINE  
						GOTO LOOP_MESSAGE
				ENDSELECT
				WSTR:(K++) = 获得了「科罗萨斯之戒」！
				WSTR:(K++) = 获得搭载兵器「金属毁灭者」！
				WSTR:(K++) = 已通关巴鲁慈地下废弃工厂区域，即将返回。
				CALL 汎用指輪取得処理("科罗萨斯之戒", 1)
				CALL 汎用搭載兵器取得処理("金属毁灭者")
				CALL メッセージ欄表示用関数(,,,0)
				鍛冶場作成許可フラグ = 1
				SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
				CALL イベント完了フラグ汎用処理("【条件確認】強い装備が作れないか？")
				CFLAG:LOCAL:招待不可フラグ = 0
				CFLAG:LOCAL:信頼度 = 2000
				CALL FAVOR_LvUPCheck(LOCAL)
				CALL 口上変数初期化
				ダンジョン終了状況 = 討伐達成
				ダンジョンクリアフラグ_バルツ地下廃工場 = 1
			ENDIF
		ELSE
			KSTR:(K++) = 要重新体验与科罗萨斯的战斗吗？
			KSTR:(K++) = （与BOSS再战）
			KSTR:(K++) = BUTTON_[确定]
			KSTR:(K++) = BUTTON_[取消]
			CALL メッセージ欄表示用関数(,,,0)
			$LOOP_MESSAGE2
			INPUTS
			SELECTCASE RESULTS
				CASE "[确定]"
					敵BATTLE_STATE_STR:0:エネミー名 = Lv18_科罗萨斯
					CALL 雑魚敵遭遇汎用処理
					IF RESULT == 0
						CALL 口上変数初期化
						WSTR:(K++) = 获得了「科罗萨斯之戒」！
						CALL 汎用指輪取得処理("科罗萨斯之戒", 1)
						CALL メッセージ欄表示用関数(,,,0)
					ENDIF
				CASE "[取消]"
					CALL 口上変数初期化
				CASEELSE
					CLEARLINE 1
					REUSELASTLINE  
					GOTO LOOP_MESSAGE2
			ENDSELECT
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_25_8(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 25
マス分岐 = 8

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "25_5")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = ……！
			WSTR:(K++) = %CALLNAME:PLAYER%一行深入工厂时热浪愈发强烈。
			WSTR:(K++) = 更感知到深处传来强大魔力。
			WSTR:(K++) = 恐怕前方存在着「机械型星晶兽」。
			WSTR:(K++) = 若要交战最好现在做好准备。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 机械型星晶兽就在前方。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_26_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 26
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "26_4")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "28_1")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 通道旁散落着看似组装中的机械型星晶兽部件。
			WSTR:(K++) = 火精灵们似乎被部件散发的火魔力吸引而聚集在此。
			WSTR:(K++) = 所幸它们正专注于部件，未察觉%CALLNAME:PLAYER%一行。继续前进吧。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 通道旁散落着看似组装中的机械型星晶兽部件。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_26_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 26
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "28_4")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 转过通道拐角，大量火精灵充斥道路。
			WSTR:(K++) = 与先前精灵相似，正被未组装的部件吸引。
			WSTR:(K++) = 但此处难以潜行通过。必须战斗突破。
			CALL メッセージ欄表示用関数(,,,0)
			敵BATTLE_STATE_STR:0:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:3:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:4:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:7:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:8:エネミー名 = Lv13_火元素
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = 驱散精灵确保道路畅通。
				WSTR:(K++) = 聚集精灵的部件似乎是武器组件。
				WSTR:(K++) = 罕见地完整保留着包装，附带武器设计图。
				IF 鍛冶場作成許可フラグ
					WSTR:(K++) = 或许能装备在机体的空余插槽，收下吧。
				ELSE
					WSTR:(K++) = 可能派上用场，收下吧。
				ENDIF
				WSTR:(K++) = %CALLNAME:PLAYER%获得搭载兵器「近战用剑刃」及其设计图！
				CALL 汎用搭載兵器取得処理("近战用剑刃")
				CALL 汎用搭載兵器取得処理_設計図("近战用剑刃")
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			ENDIF
		ELSE
			敵BATTLE_STATE_STR:0:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:3:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:4:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:7:エネミー名 = Lv13_火元素
			敵BATTLE_STATE_STR:8:エネミー名 = Lv13_火元素
			CALL 雑魚敵繰り返し戦闘処理
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ENDIF
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_27_6(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 27
マス分岐 = 6

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "27_7")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 搜索仓库发现所有兵器均已损坏。
			WSTR:(K++) = 再往深处探索看看吧。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 没有完好的兵器残留。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_27_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 27
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 依旧满地破损兵器。
			WSTR:(K++) = 试图寻找可用之物时，发现墙面显眼处的红色箱子。
			WSTR:(K++) = 箱体标注「紧急用复活药剂」。
			WSTR:(K++) = 开启后发现两瓶仍可使用的复活药剂。
			WSTR:(K++) = 或许是事故应急储备，留在此处也无用，心怀感激收下吧。
			WSTR:(K++) = %CALLNAME:PLAYER%获得了２瓶「复活药剂」！
			CALL アイテム増減汎用処理("复活药剂", 2)
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 已无值得注意的东西。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_28_1(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 28
マス分岐 = 1

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 会話アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "28_3")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 大量机械型星晶兽呈损毁状态散落。
			WSTR:(K++) = 此废弃工厂因古代事故封锁，近期应随机械型星晶兽启动解除封锁……
			WSTR:(K++) = 但作为事故现场，损毁机体未免过多。
			WSTR:(K++) = 总之目前暂无危险。
			WSTR:(K++) = 详细调查交由巴鲁慈专家处理，我们继续前进。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 大量机械型星晶兽呈损毁状态散落。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_28_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 28
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "31_3")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 试图绕过损毁机体时，旁侧坠落的兵器部件突然悬浮！
			WSTR:(K++) = 似乎是精灵附身于兵器内部操控。
			WSTR:(K++) = 被附体的兵器径直袭向%CALLNAME:PLAYER%一行！
			CALL メッセージ欄表示用関数(,,,0)
			敵BATTLE_STATE_STR:1:エネミー名 = Lv14_精灵附体武器部件
			敵BATTLE_STATE_STR:5:エネミー名 = Lv14_精灵附体武器部件
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = 击退兵器后精灵逃逸。
				WSTR:(K++) = 所幸附身的是兵器而非机体实属万幸。
				WSTR:(K++) = 若面对那些厚重装甲的机体定会更棘手。
				WSTR:(K++) = 将残骸推到一旁，%CALLNAME:PLAYER%一行继续前进。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			ENDIF
		ELSE
			敵BATTLE_STATE_STR:1:エネミー名 = Lv14_精灵附体武器部件
			敵BATTLE_STATE_STR:5:エネミー名 = Lv14_精灵附体武器部件
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_28_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 28
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "28_6")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "30_4")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 越是深入内部，热浪愈发强烈。存在超越冷却装置的热源吧。
			WSTR:(K++) = 目前尚可承受，但_COLOR_%カラーパレット_HTML("黄")%_工厂最深处可能每回合承受伤害_。
			WSTR:(K++) = 要预防需具备自我冷却能力。
			WSTR:(K++) = _COLOR_%カラーパレット_HTML("黄")%_转为水属性可无效化回合伤害_。
			WSTR:(K++) = 或许该准备水属性耳饰。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = _COLOR_%カラーパレット_HTML("黄")%_工厂最深处可能每回合承受伤害_。
			KSTR:(K++) = _COLOR_%カラーパレット_HTML("黄")%_转为水属性可无效化回合伤害_。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_28_6(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 28
マス分岐 = 6

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "27_6")
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "30_6")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 通道旁发现大型门扉。
			WSTR:(K++) = 门扉上方金属铭牌刻着「兵器管理库」。
			WSTR:(K++) = 或许残留有用之物。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 门扉上方金属铭牌刻着「兵器管理库」。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT



@ダンジョンマス情報_バルツ地下廃工場_30_4(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 30
マス分岐 = 4

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		SIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4)
			ダンジョンマス画像URL_重ね表示 = 会話アイコン
	CASE "接続先"
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			WSTR:(K++) = 通道尽头设有大型按钮。
			IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:31:3, 2)
				WSTR:(K++) = 或是其他区域封闭闸门的开启按钮？
			ENDIF
			WSTR:(K++) = 按钮上方金属铭牌刻着「闸门开关」。_PAGE
			KSTR:(K++) = 要按下按钮吗？
			KSTR:(K++) = BUTTON_[确定]
			KSTR:(K++) = BUTTON_[取消]
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			$LOOP_MESSAGE
			INPUTS
			SELECTCASE RESULTS
				CASE "[确定]"
					WSTR:(K++) = 按下按钮后传来机械运转的轰鸣声。
					IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:31:3, 2)
						WSTR:(K++) = 去查看开启的闸门吧。
					ENDIF
					CALL メッセージ欄表示用関数(,,,0)
					SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
				CASE "[取消]"
					WSTR:(K++) = 再探索其他区域看看。
					CALL メッセージ欄表示用関数(,,,0)
				CASEELSE
					CLEARLINE 1
					REUSELASTLINE  
					GOTO LOOP_MESSAGE
			ENDSELECT
		ELSE
			KSTR:(K++) = 按钮已处于按下状态。
			CALL メッセージ欄表示用関数(,,,0)
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_30_6(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 30
マス分岐 = 6

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = エネミーアイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "30_7")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			;最初に訪れた時
			WSTR:(K++) = 仓库中发现现存兵器。
			WSTR:(K++) = ……岂料兵器突然自行启动！
			WSTR:(K++) = 火精灵附身其中，操控兵器整体袭来！
			CALL メッセージ欄表示用関数(,,,0)
			敵BATTLE_STATE_STR:3:エネミー名 = Lv14_精灵附体武器部件
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利時のみ先へ進む
				CALL 口上変数初期化
				WSTR:(K++) = 击退兵器后精灵逃逸。
				WSTR:(K++) = 受浓厚魔力侵蚀的内部零件严重劣化……
				WSTR:(K++) = ……简单零件尚有若干可用！
				KSTR:(K++) = %CALLNAME:PLAYER%获得了３个陈旧齿轮！_PAGE
				WSTR:(K++) = 将残骸推到一旁，%CALLNAME:PLAYER%一行继续前进。
				CALL 素材入手処理("陈旧齿轮", 3)
				CALL メッセージ欄表示用関数(,,,0)
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			ENDIF
		ELSE
			敵BATTLE_STATE_STR:3:エネミー名 = Lv14_精灵附体武器部件
			CALL 雑魚敵繰り返し戦闘処理
		ENDIF
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_30_7(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 30
マス分岐 = 7

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		ダンジョンマス画像URL_重ね表示 = 宝箱アイコン_木箱_開
	CASE "接続先"
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 仓库深处发现赤红魔力宝珠。
			WSTR:(K++) = 收纳箱标注「大型机械动力源・蕴含高浓度魔力」。
			WSTR:(K++) = 幸因保存完好未见劣化，心怀感激收下吧。
			WSTR:(K++) = %CALLNAME:PLAYER%获得了１颗「红莲宝珠」！
			CALL 素材入手処理("红莲宝珠", 1)
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 已无值得注意的东西。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT


@ダンジョンマス情報_バルツ地下廃工場_31_3(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 31
マス分岐 = 3

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
		SIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
			ダンジョンマス画像URL_重ね表示 = 会話アイコン
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "31_8")
	CASE "マスイベント"
		IF GETBIT(ダンジョン構造配列_バルツ地下廃工場:30:4, 4)
			;開いてる
			IF 初来訪マス判定用フラグ
				;最初に訪れた時
				WSTR:(K++) = 通道中途发现损毁机体消失的区域。
				WSTR:(K++) = 此前散落着大量部件，但此处往前空无一物。
				WSTR:(K++) = 取而代之的是愈发强烈的热浪。_PAGE
				WSTR:(K++) = 抬头可见闸门处于开启状态。
				WSTR:(K++) = 或许是其他区域发现的开关控制此处闸门。
				WSTR:(K++) = 总之通行无碍，%CALLNAME:PLAYER%一行继续前进。
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			ELSEIF GETBIT(ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4) == 0
				WSTR:(K++) = 封闭的耐火闸门已开启。
				WSTR:(K++) = 此前散落的部件与零件在此处前方绝迹。
				WSTR:(K++) = 取而代之的是愈发强烈的热浪。
				WSTR:(K++) = 总之通行无碍，%CALLNAME:PLAYER%一行继续前进。
				CALL 接続ルート全開放処理(マス深度, マス分岐)
				SETBIT ダンジョン構造配列_バルツ地下廃工場:マス深度:マス分岐, 4
			ELSE
				KSTR:(K++) = 闸门已处于开启状态。
			ENDIF
		ELSE
			;閉まってる
			IF 初来訪マス判定用フラグ
				;最初に訪れた時
				WSTR:(K++) = 通道中途设有闭合的耐火闸门。
				WSTR:(K++) = 厚重程度难以暴力突破。
				WSTR:(K++) = 寻找开启装置吧。
			ELSE
				KSTR:(K++) = 通道中途设有闭合的耐火闸门。
				KSTR:(K++) = 寻找开启装置吧。
			ENDIF
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT

@ダンジョンマス情報_バルツ地下廃工場_31_8(ARGS)
#DIM マス深度
#DIM マス分岐
マス深度 = 31
マス分岐 = 8

SELECTCASE ARGS
	CASE "マス画像"
		ダンジョンマス画像URL = 床_工場
	CASE "接続先"
		CALL ダンジョン分岐線描画(@"{マス深度}_{マス分岐}", "25_8")
	CASE "マスイベント"
		IF 初来訪マス判定用フラグ
			;最初に訪れた時
			WSTR:(K++) = 穿越闸门后，不仅零件散落绝迹，连精灵与失控机械也不见踪影。
			WSTR:(K++) = 虽无阻碍却更觉异常……
			WSTR:(K++) = 比起平和更像是「暴风雨前的宁静」。
			WSTR:(K++) = 谨慎前行吧。
			CALL 接続ルート全開放処理(マス深度, マス分岐)
		ELSE
			KSTR:(K++) = 此区域空无一物。
		ENDIF
		CALL メッセージ欄表示用関数(,,,0)
		CALL 画面再描画
ENDSELECT




