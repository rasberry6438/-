
@イベント_リゾート島開拓作業_ランダム_不意の地崩れ
#DIM ダメージ量

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 周围没有异常状况。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%一行正在探索时，脚下地面突然崩塌坠落！
	WSTR:(K++) = 看来是地下水侵蚀等原因导致地下形成了空洞。
	WSTR:(K++) = 所幸坑洞并不算深，但%CALLNAME:MASTER%一行仍受了些轻伤……
	ダメージ量 = ダンジョン階層記録 * 30
	KSTR:(K++) = 全体的ＨＰ减少了{ダメージ量, 4}。
	;HPバーの表示タイミングを調整するためここで一旦メッセージ表示
	CALL メッセージ欄表示用関数()
	CALL 口上変数初期化
	
	CALL 探索中全体ダメージ_ＨＰ_非致死(ダメージ量)
	WSTR:(K++) = %CALLNAME:MASTER%一行从坑洞中爬出，重整旗鼓继续探索。
	CALL メッセージ欄表示用関数(,,,0)
	
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_魔物の不意打ち
#DIM ダメージ対象
#DIM ダメージ量

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 周围没有异常状况。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%一行正在探索时，遭到了魔物奇袭！
	ダメージ対象 = 味方ランダム選出_前衛のみ()
	ダメージ量 = BATTLE_STATE:ダメージ対象:ＨＰ - MAX(1, (BATTLE_STATE:ダメージ対象:ＨＰ * (100 - 60) / 100))
	WSTR:(K++) = 虽然成功击退了敌人，但首轮偷袭导致%CALLNAME:(BATTLE_STATE:ダメージ対象:0)%身负重伤……
	KSTR:(K++) = %CALLNAME:(BATTLE_STATE:ダメージ対象:0)%的ＨＰ减少了{ダメージ量, 4}。
	;HPバーの表示タイミングを調整するためここで一旦メッセージ表示
	CALL メッセージ欄表示用関数()
	CALL 口上変数初期化
	
	BATTLE_STATE:ダメージ対象:ＨＰ = MAX(1, (BATTLE_STATE:ダメージ対象:ＨＰ * (100 - 60) / 100))
	WSTR:(K++) = 尽管遭遇突袭，%CALLNAME:MASTER%一行仍顽强歼灭了来袭魔物。
	WSTR:(K++) = %CALLNAME:MASTER%一行加强警戒环顾四周，重新投入探索。
	CALL メッセージ欄表示用関数(,,,0)
	
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画


@イベント_リゾート島開拓作業_ランダム_魔力災害
#DIM ダメージ量

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 周围没有异常状况。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%一行正在探索时，感应到附近有强烈魔力波动！
	WSTR:(K++) = 自然生成的精灵过度聚集，似乎即将融合为一体！
	WSTR:(K++) = 若放任不管必将诞生强力魔物。%CALLNAME:MASTER%一行释放魔力，分头驱散精灵群。
	ダメージ量 = ダンジョン階層記録 * 15
	KSTR:(K++) = 全体的ＭＰ减少了{ダメージ量, 4}。
	;HPバーの表示タイミングを調整するためここで一旦メッセージ表示
	CALL メッセージ欄表示用関数()
	CALL 口上変数初期化
	
	CALL 探索中全体ダメージ_ＭＰ(ダメージ量)
	WSTR:(K++) = 总算成功驱散了精灵群，周遭的魔力浓度也恢复了正常。
	WSTR:(K++) = %CALLNAME:MASTER%一行松了口气，重新投入探索。
	CALL メッセージ欄表示用関数(,,,0)
	
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画
