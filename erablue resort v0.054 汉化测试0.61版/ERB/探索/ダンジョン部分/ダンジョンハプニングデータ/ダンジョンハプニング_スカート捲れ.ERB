@ダンジョンハプニング_スカート捲れ(対象キャラ番号)
#DIM 対象キャラ番号
#DIM 選定用配列, 10

WSTR:(K++) = 突然刮起强风！
KSTR:(K++) = %CALLNAME:対象キャラ番号%的衣摆被掀起，
NSTR:(K++) = 近在咫尺的%CALLNAME:PLAYER%
IF TEQUIP:対象キャラ番号:下タイツあり
	IF TEQUIP:対象キャラ番号:下タイツ破れ
		NSTR:(K++) = 透过破损处
	ENDIF
	NSTR:(K++) = 透过紧身衣
ENDIF
SELECTCASE TEQUIP:対象キャラ番号:下半身下着あり
	CASE 1
		KSTR:(K++) = 将%CALLNAME:対象キャラ番号%的内裤尽收眼底。_PAGE
	CASE 2
		KSTR:(K++) = 看到%CALLNAME:対象キャラ番号%仅着纤薄布料的重要部位。_PAGE
	CASE 3
		KSTR:(K++) = 清楚看到%CALLNAME:対象キャラ番号%的兜裆布。_PAGE
	CASEELSE
		KSTR:(K++) = 完全目睹%CALLNAME:対象キャラ番号%未着寸缕的私密部位。_PAGE
ENDSELECT

CALL メッセージ欄表示用関数()
CALL 口上変数初期化

CALL セクハラ反応タイプ判定(対象キャラ番号)
TRYCALLFORM KOJO_ハプニング_スカート捲れ_{NO:対象キャラ番号}(対象キャラ番号)
IF 口上有無確認(0, 1) == 0
	SELECTCASE RFLAG:コマンド結果受渡し変数２
		CASE 1
			;無知
			KSTR:(K++) = 然而%CALLNAME:対象キャラ番号%似乎并未在意。
		CASE 2
			;無反応
			KSTR:(K++) = 然而%CALLNAME:対象キャラ番号%若无其事地继续探索。
		CASE 6
			;羞恥
			SELECTCASE RFLAG:コマンド結果受渡し変数
				CASE 1
					;拒絶
					KSTR:(K++) = %CALLNAME:対象キャラ番号%涨红着脸发出小声惊叫。
				CASE 2
					;受入れ
					KSTR:(K++) = %CALLNAME:対象キャラ番号%满脸通红地按住衣服。
				CASE 3
					;喜び
					KSTR:(K++) = %CALLNAME:対象キャラ番号%染红双颊凝视着这边……
			ENDSELECT
		CASEELSE
			;汎用
			SELECTCASE RFLAG:コマンド結果受渡し変数
				CASE 1
					;拒絶
					KSTR:(K++) = %CALLNAME:対象キャラ番号%露出稍显不快的表情继续探索。
				CASE 2
					;受入れ
					KSTR:(K++) = %CALLNAME:対象キャラ番号%边抱怨大风边整理衣着。
				CASE 3
					;喜び
					KSTR:(K++) = %CALLNAME:対象キャラ番号%笑着调侃%CALLNAME:PLAYER%。
			ENDSELECT
	ENDSELECT
	CALL メッセージ欄表示用関数()
ENDIF

;ソース増減部分
SELECTCASE RFLAG:コマンド結果受渡し変数
	CASE 1
		;拒絶
		CALL SOURCE_CALC_不快(対象キャラ番号, PLAYER, 50)
		CALL SOURCE_CALC_反感(対象キャラ番号, PLAYER, 50)
		CALL SOURCE_CALC_露出(対象キャラ番号, PLAYER, 200)
	CASE 2
		;受け入れ
		CALL SOURCE_CALC_露出(対象キャラ番号, PLAYER, 100)
		CALL SOURCE_CALC_好感度要素_恋心度UP(対象キャラ番号, PLAYER, 50)
		CALL SOURCE_CALC_好感度要素_性愛度UP(対象キャラ番号, PLAYER, 100)
	CASE 3
		;喜び
		CALL SOURCE_CALC_露出(対象キャラ番号, PLAYER, 70)
		CALL SOURCE_CALC_歓楽(対象キャラ番号, PLAYER, 70)
		CALL SOURCE_CALC_好感度要素_恋心度UP(対象キャラ番号, PLAYER, 100)
		CALL SOURCE_CALC_好感度要素_性愛度UP(対象キャラ番号, PLAYER, 100)
ENDSELECT





@ダンジョンハプニング_ABLE_スカート捲れ(判定キャラ番号)
#DIM 判定キャラ番号

SIF TEQUIP:判定キャラ番号:スカートめくり可 == 0
	RETURN 0

RETURN 1
