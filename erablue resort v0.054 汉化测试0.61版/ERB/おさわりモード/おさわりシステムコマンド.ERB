@おさわりシステムコマンド(システムコマンド更新タイプ, システムコマンド展開フラグ, システムコマンド種類, システムコマンドチェックボックスあり, システムコマンドチェック状態, システムコマンド格納, システムコマンド位置基準, システムコマンドサイズ, システムコマンド間隔, 表示レイヤー層)
#DIMS REF システムコマンド更新タイプ
#DIM REF システムコマンド展開フラグ
#DIM レイヤー番号 = 50
#DIM カラーマトリクス, 5, 5
#DIMS REF システムコマンド種類,0
#DIM REF システムコマンドチェックボックスあり,0
#DIM REF システムコマンドチェック状態,0
#DIM REF システムコマンド格納,0
#DIM システムコマンド表示数
#DIM REF システムコマンド位置基準,0
#DIM REF システムコマンドサイズ,0
#DIM REF システムコマンド間隔

#DIM 表示レイヤー層
#DIM コマンド枠幅 = 4

SELECTCASE システムコマンド更新タイプ
CASE "初期化"
CASE "作成"
	GOTO 作成
CASE "描画"
	GOTO 描画
CASEELSE
ENDSELECT

$作成
システムコマンド表示数 = FINDELEMENT(システムコマンド格納, 0)

;システムコマンドグラフィックリソース
GDISPOSE レイヤー番号 + 10 ,
GCREATE レイヤー番号 + 10 , システムコマンドサイズ:0 * 4, システムコマンドサイズ:1 * システムコマンド表示数
GSETBRUSH レイヤー番号 + 10 , 0xFF101010
GFILLRECTANGLE レイヤー番号 + 10 , 0, 0, システムコマンドサイズ:0, システムコマンドサイズ:1 * システムコマンド表示数
GSETFONT レイヤー番号 + 10 , GETFONT(), 18
FOR LOCAL, 0, システムコマンド表示数
	GSETBRUSH レイヤー番号 + 10 , 0xFFC0C0C0
	GFILLRECTANGLE レイヤー番号 + 10 , 0, システムコマンドサイズ:1 * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1
	GSETBRUSH レイヤー番号 + 10 , 0xFF101010
	GFILLRECTANGLE レイヤー番号 + 10 , 0 + コマンド枠幅, システムコマンドサイズ:1 * LOCAL + コマンド枠幅, システムコマンドサイズ:0 - コマンド枠幅 * 2, システムコマンドサイズ:1 - コマンド枠幅 * 2
	GSETBRUSH レイヤー番号 + 10 , 0xFFC0C0C0
	GSETPEN レイヤー番号 + 10 , 0xFFC0C0C0, 1
	GDRAWTEXT レイヤー番号 + 10 ,  "[" + TOSTR(LOCAL + 1) + "] " + システムコマンド種類:(システムコマンド格納:LOCAL), 10, 10 + システムコマンドサイズ:1 * LOCAL
	;チェックボックスがないときは次へ
	SIF !システムコマンドチェックボックスあり:(システムコマンド格納:LOCAL)
		CONTINUE
	GDRAWTEXT レイヤー番号 + 10 , "□", 370, 10 + システムコマンドサイズ:1 * LOCAL
	;チェックボックスごとコピーしてチェックを入れる
	GDRAWG レイヤー番号 + 10 , レイヤー番号 + 10 , システムコマンドサイズ:0 * 2, システムコマンドサイズ:1 * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1, 0, システムコマンドサイズ:1 * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1, 
	GDRAWTEXT レイヤー番号 + 10 , "×", 370 + システムコマンドサイズ:0 * 2, 10 + システムコマンドサイズ:1 * LOCAL
	GDRAWTEXT レイヤー番号 + 10 , "×", 370 + システムコマンドサイズ:0 * 3, 10 + システムコマンドサイズ:1 * LOCAL
NEXT

;大して変わらないのでアクセスと揃える
; GSETBRUSH レイヤー番号 + 10 , 0xFFC0C0C0
; FOR LOCAL, 0, システムコマンド表示数
;     GFILLRECTANGLE レイヤー番号 + 10 , 0, システムコマンドサイズ:1 * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1
; NEXT
; GSETBRUSH レイヤー番号 + 10 , 0xFF101010
; FOR LOCAL, 0, システムコマンド表示数
;     GFILLRECTANGLE レイヤー番号 + 10 , 0 + コマンド枠幅, システムコマンドサイズ:1 * LOCAL + コマンド枠幅, システムコマンドサイズ:0 - コマンド枠幅 * 2, システムコマンドサイズ:1 - コマンド枠幅 * 2
; NEXT
; GSETBRUSH レイヤー番号 + 10 , 0xFFC0C0C0
; GSETPEN レイヤー番号 + 10 , 0xFFC0C0C0, 1
; FOR LOCAL, 0, システムコマンド表示数
;     GDRAWTEXT レイヤー番号 + 10 ,  "[" + TOSTR(LOCAL + 1) + "] " + システムコマンド種類:(システムコマンド格納:LOCAL), 10, 10 + システムコマンドサイズ:1 * LOCAL
;     ;チェックボックスがないときは次へ
;     SIF !システムコマンドチェックボックスあり:(システムコマンド格納:LOCAL)
;         CONTINUE
;     GDRAWTEXT レイヤー番号 + 10 , "□", 370, 10 + システムコマンドサイズ:1 * LOCAL
;     ;チェックボックスごとコピーしてチェックを入れる
;     GDRAWG レイヤー番号 + 10 , レイヤー番号 + 10 , システムコマンドサイズ:0 * 2, システムコマンドサイズ:1 * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1, 0, システムコマンドサイズ:1 * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1, 
;     GDRAWTEXT レイヤー番号 + 10 , "×", 370 + システムコマンドサイズ:0 * 2, 10 + システムコマンドサイズ:1 * LOCAL
;     GDRAWTEXT レイヤー番号 + 10 , "×", 370 + システムコマンドサイズ:0 * 3, 10 + システムコマンドサイズ:1 * LOCAL
; NEXT

;選択時ボタンを作る
カラーマトリクス:0:0 = 256,   0,   0,   0,   0
カラーマトリクス:1:0 =   0, 256,   0,   0,   0
カラーマトリクス:2:0 =   0,   0, 256,   0,   0
カラーマトリクス:3:0 =   0,   0,   0, 256,   0
カラーマトリクス:4:0 = 100, 100, 100,   0, 256
GDRAWG レイヤー番号 + 10 , レイヤー番号 + 10 , システムコマンドサイズ:0, 0, システムコマンドサイズ:0 * 3, システムコマンドサイズ:1 * システムコマンド表示数, 0, 0, システムコマンドサイズ * 3, システムコマンドサイズ:1 * システムコマンド表示数, カラーマトリクス:0:0

;システムメニューベース
GDISPOSE レイヤー番号 + 11 
GCREATE レイヤー番号 + 11 , システムコマンドサイズ:0 * 2 + コマンド枠幅 * 4, (システムコマンドサイズ:1 + システムコマンド間隔) * システムコマンド表示数 + コマンド枠幅 * 4
GSETBRUSH レイヤー番号 + 11 , 0xFFC0C0C0
GFILLRECTANGLE レイヤー番号 + 11 , 0, 0, システムコマンドサイズ:0 + コマンド枠幅 * 4, (システムコマンドサイズ:1 + システムコマンド間隔) * システムコマンド表示数 + コマンド枠幅 * 4
GFILLRECTANGLE レイヤー番号 + 11 , システムコマンドサイズ:0 + コマンド枠幅 * 4, 0, システムコマンドサイズ:0 / 2, システムコマンドサイズ:1
GSETBRUSH レイヤー番号 + 11 , 0xFF101010
GFILLRECTANGLE レイヤー番号 + 11 , 0 + コマンド枠幅, コマンド枠幅, システムコマンドサイズ:0 + コマンド枠幅 * 2, (システムコマンドサイズ:1 + システムコマンド間隔) * システムコマンド表示数 + コマンド枠幅 * 2
GFILLRECTANGLE レイヤー番号 + 11 , システムコマンドサイズ:0 + コマンド枠幅 * 4, コマンド枠幅, システムコマンドサイズ:0 / 2 - コマンド枠幅, システムコマンドサイズ:1 - コマンド枠幅 * 2
GSETBRUSH レイヤー番号 + 11 , 0xFFC0C0C0
GSETFONT レイヤー番号 + 11 , GETFONT(), 18
GSETPEN レイヤー番号 + 11 , 0xFFC0C0C0, 1
GDRAWTEXT レイヤー番号 + 11 ,  "[0] システムメニュー", 5 + システムコマンドサイズ:0 + コマンド枠幅 * 4, 10

GDISPOSE レイヤー番号 + 12 
GCREATE レイヤー番号 + 12 , GWIDTH(レイヤー番号 + 11 ), GHEIGHT(レイヤー番号 + 11 )
GDRAWG レイヤー番号 + 12 , レイヤー番号 + 11 , 0, 0, GWIDTH(レイヤー番号 + 11 ), GHEIGHT(レイヤー番号 + 11 ), 0, 0, GWIDTH(レイヤー番号 + 11 ), GHEIGHT(レイヤー番号 + 11 ), カラーマトリクス:0:0

$描画

CBGREMOVERANGE 表示レイヤー層 , 表示レイヤー層 + 1

;展開アニメーションがある
IF システムコマンド展開フラグ == 1 || システムコマンド展開フラグ == 3
	GDISPOSE レイヤー番号 + 13 
	GCREATE レイヤー番号 + 13 , GWIDTH(レイヤー番号 + 11 ), GHEIGHT(レイヤー番号 + 11 )
	GDRAWG レイヤー番号 + 13 , レイヤー番号 + 11 , 0, 0, GWIDTH(レイヤー番号 + 11 ), GHEIGHT(レイヤー番号 + 11 ), 0, 0, GWIDTH(レイヤー番号 + 11 ), GHEIGHT(レイヤー番号 + 11 )
	FOR LOCAL, 0, システムコマンド表示数
		IF システムコマンドチェック状態:(システムコマンド格納:LOCAL)
			GDRAWG レイヤー番号 + 13 , レイヤー番号 + 10 , システムコマンド位置基準:0 + コマンド枠幅 * 2, システムコマンド位置基準:1 + コマンド枠幅 * 2 + (システムコマンドサイズ:1 + システムコマンド間隔) * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1, システムコマンドサイズ:0 * 2, システムコマンドサイズ:1 * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1
		ELSE
			GDRAWG レイヤー番号 + 13 , レイヤー番号 + 10 , システムコマンド位置基準:0 + コマンド枠幅 * 2, システムコマンド位置基準:1 + コマンド枠幅 * 2 + (システムコマンドサイズ:1 + システムコマンド間隔) * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1, システムコマンドサイズ:0 * 0, システムコマンドサイズ:1 * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1
		ENDIF
	NEXT

	;開くのアニメーション
	IF システムコマンド展開フラグ == 1
		システムコマンド展開フラグ = 2
		GDISPOSE レイヤー番号 + 14 
		GCREATE レイヤー番号 + 14 , CLIENTWIDTH(), CLIENTHEIGHT()
		GSETBRUSH レイヤー番号 + 14 , 0x80101010
		GFILLRECTANGLE レイヤー番号 + 14, 0, 0, CLIENTWIDTH(), CLIENTHEIGHT()
		CBGSETG レイヤー番号 + 14, 0, 0, 表示レイヤー層 + 3
		FOR LOCAL, 0, 10
		CBGREMOVERANGE 表示レイヤー層 + 2, 表示レイヤー層 + 2
		CBGSETG レイヤー番号 + 13 , -400 + SQRT(LOCAL * 16000) ,システムコマンド位置基準:1 + (システムコマンドサイズ:1 + システムコマンド間隔) * システムコマンド表示数 + コマンド枠幅 * 4 - CLIENTHEIGHT() + システムコマンド間隔, 表示レイヤー層 + 2
		AWAIT 1
		NEXT
		CBGREMOVERANGE 表示レイヤー層 + 2, 表示レイヤー層 + 2
	;閉じるのアニメーション
	ELSE ;3
		システムコマンド展開フラグ = 0
		FOR LOCAL, 0, 10
		CBGREMOVERANGE 表示レイヤー層 + 2, 表示レイヤー層 + 2
		CBGSETG レイヤー番号 + 13 , 0 - SQRT(LOCAL * 16000) ,システムコマンド位置基準:1 + (システムコマンドサイズ:1 + システムコマンド間隔) * システムコマンド表示数 + コマンド枠幅 * 4 - CLIENTHEIGHT() + システムコマンド間隔, 表示レイヤー層 + 2
		AWAIT 1
		NEXT
		CBGREMOVERANGE 表示レイヤー層 + 2, 表示レイヤー層 + 3
	ENDIF
ENDIF

GDISPOSE レイヤー番号 + 23 
GCREATE レイヤー番号 + 23 , CLIENTWIDTH(), CLIENTHEIGHT()

IF システムコマンド展開フラグ ;1=ON
	CBGSETG レイヤー番号 + 11 , システムコマンド位置基準:0,  システムコマンド位置基準:1 + (システムコマンドサイズ:1 + システムコマンド間隔) * システムコマンド表示数 + コマンド枠幅 * 4 - CLIENTHEIGHT() + システムコマンド間隔, 表示レイヤー層 + 1
	FOR LOCAL, 0, システムコマンド表示数
		GSETBRUSH レイヤー番号 + 23 , 0xFF010000 + 0x00000001 * LOCAL
		GFILLRECTANGLE レイヤー番号 + 23 , システムコマンド位置基準:0, システムコマンド位置基準:1 + (システムコマンドサイズ:1 + システムコマンド間隔) * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1
		SPRITEDISPOSE "システムコマンド" + TOSTR(LOCAL) + "A"
		SPRITEDISPOSE "システムコマンド" + TOSTR(LOCAL) + "B"
		;チェック付きの時を抽出
		IF システムコマンドチェック状態:(システムコマンド格納:LOCAL)
			SPRITECREATE "システムコマンド" + TOSTR(LOCAL) + "A", レイヤー番号 + 10 , システムコマンドサイズ:0 * 2, システムコマンドサイズ:1 * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1
			SPRITECREATE "システムコマンド" + TOSTR(LOCAL) + "B", レイヤー番号 + 10 , システムコマンドサイズ:0 * 3, システムコマンドサイズ:1 * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1
			CBGSETBUTTONSPRITE 0x010000 + 0x000001 * LOCAL, "システムコマンド" + TOSTR(LOCAL) + "A", "システムコマンド" + TOSTR(LOCAL) + "B", システムコマンド位置基準:0 + コマンド枠幅 * 2, システムコマンド位置基準:1 + コマンド枠幅 * 2 + (システムコマンドサイズ:1 + システムコマンド間隔) * (LOCAL + 1) - CLIENTHEIGHT(), 表示レイヤー層
		ELSE
			SPRITECREATE "システムコマンド" + TOSTR(LOCAL) + "A", レイヤー番号 + 10 , システムコマンドサイズ:0 * 0, システムコマンドサイズ:1 * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1
			SPRITECREATE "システムコマンド" + TOSTR(LOCAL) + "B", レイヤー番号 + 10 , システムコマンドサイズ:0 * 1, システムコマンドサイズ:1 * LOCAL, システムコマンドサイズ:0, システムコマンドサイズ:1
			CBGSETBUTTONSPRITE 0x010000 + 0x000001 * LOCAL, "システムコマンド" + TOSTR(LOCAL) + "A", "システムコマンド" + TOSTR(LOCAL) + "B", システムコマンド位置基準:0 + コマンド枠幅 * 2, システムコマンド位置基準:1 + コマンド枠幅 * 2 + (システムコマンドサイズ:1 + システムコマンド間隔) * (LOCAL + 1) - CLIENTHEIGHT(), 表示レイヤー層
		ENDIF
	NEXT
	LOCAL = 10
	GSETBRUSH レイヤー番号 + 23 , 0xFF010000 + 0x00000001 * LOCAL
	GFILLRECTANGLE レイヤー番号 + 23 , システムコマンド位置基準:0 + システムコマンドサイズ:0 + コマンド枠幅, システムコマンド位置基準:1, システムコマンドサイズ:0 / 2, システムコマンドサイズ:1
ELSE
	LOCAL = 10
	;閉じてる
	GSETBRUSH レイヤー番号 + 23 , 0xFF010000 + 0x00000001 * LOCAL
	GFILLRECTANGLE レイヤー番号 + 23 , システムコマンド位置基準:0, システムコマンド位置基準:1, システムコマンドサイズ:0 / 2, システムコマンドサイズ:1
	SPRITEDISPOSE "システムコマンド" + TOSTR(LOCAL) + "A"
	SPRITEDISPOSE "システムコマンド" + TOSTR(LOCAL) + "B"
	SPRITECREATE "システムコマンド" + TOSTR(LOCAL) + "A", レイヤー番号 + 11 , 0, 0, GWIDTH(レイヤー番号 + 11 ), GHEIGHT(レイヤー番号 + 11 )
	SPRITECREATE "システムコマンド" + TOSTR(LOCAL) + "B", レイヤー番号 + 12 , 0, 0, GWIDTH(レイヤー番号 + 11 ), GHEIGHT(レイヤー番号 + 11 )
	CBGSETBUTTONSPRITE 0x010000 + 0x000001 * LOCAL, "システムコマンド" + TOSTR(LOCAL) + "A", "システムコマンド" + TOSTR(LOCAL) + "B", - (システムコマンドサイズ:0 + コマンド枠幅 * 4), システムコマンド位置基準:1 + (システムコマンドサイズ:1 + システムコマンド間隔) * システムコマンド表示数 + コマンド枠幅 * 4 - CLIENTHEIGHT() + システムコマンド間隔, 表示レイヤー層
ENDIF

システムコマンド更新タイプ '= "描画"

RETURN
