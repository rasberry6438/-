@COM175
;換装
CALL PRINT_TRAIN_NAME(SELECTCOM)

;-------------------------------------------------
;実行できるかの判定
;-------------------------------------------------
;判定が要らない状態
IF TEQUIP:推倒 || TEQUIP:拘束

ELSEIF CHECK_PANTIES("不可移開") == 0
	CALL SHOW_COM_ORDER_COM, 175

	;実行できない
	SIF TCVAR:干劲 == 0
		RETURN 0
ENDIF
;-------------------------------------------------
;換装のフラグ、ス阴蒂プト、説明等
;-------------------------------------------------
CALL TRAIN_MESSAGE_B

SIF REFUSE_CHECK()
	RETURN 0

STR:前回指令 = %STR:今回指令%

RETURN 1

@FLAG_COM175, ARG

@SOURCE_COM175, ARG
CALL VARSET_COMF

SOURCE:0:情愛 = 100

;ABL:露出癖をみる
SELECTCASE ABL:露出癖
CASE 0
	SOURCE:0:露出 += 100
	SOURCE:0:屈従 += 100
CASE 1
	SOURCE:0:露出 += 500
	SOURCE:0:屈従 += 300
CASE 2
	SOURCE:0:露出 += 100
	SOURCE:0:屈従 += 50
CASE 3
	SOURCE:0:露出 += 50
CASE 4

CASEELSE

ENDSELECT
;ABL:信頼をみる
SELECTCASE ABL:信頼
CASE 0
CASE 1
	TIMES SOURCE:0:情愛, 1.20
CASE 2
	TIMES SOURCE:0:情愛, 1.40
CASE 3
	TIMES SOURCE:0:情愛, 1.50
CASE 4
	TIMES SOURCE:0:情愛, 2.10
CASEELSE
	TIMES SOURCE:0:情愛, 3.00
ENDSELECT

CALL CALC, "調教ソース", ARG


@TRAIN_MESSAGE_COM175
IF TEQUIP:推倒 || ( (TEQUIP:拘束 || TEQUIP:室内露出PLAY || TEQUIP:野外PLAY) && (ABL:信頼 >= 4 || ABL:露出癖 >= 3) )
	IF EQUIP:胖次 && EQUIP:贴身制服 + EQUIP:下身衣装 == 0 && CHECK_CLO("胖次露出")
		PRINTFORMW %CALLNAME:TARGET%慢慢地脫下了內褲……
		CALL SET_PANTIES, ""
	ELSEIF CHECK_CLO("裸体") == 0
		PRINTFORMW %CALLNAME:TARGET%慢慢地脫下衣服、將赤裸的嬌軀展示出來……
		CALL SETFLAG, "扒成裸体", TARGET
	ENDIF
ELSEIF CHECK_PANTIES("不可移開")
	SELECTCASE PANTIES(TARGET, "略")
	CASE "前貼"
		PRINTFORMW %CALLNAME:PLAYER%は%CALLNAME:TARGET%の前貼を剥がした…
	CASE "貞操帯"
		PRINTFORMW %CALLNAME:PLAYER%は%CALLNAME:TARGET%の貞操帯を外した…
	CASEELSE
		PRINTFORMW %CALLNAME:PLAYER%は%CALLNAME:TARGET%の%PANTIES(TARGET, "略")%を脱がした…
	ENDSELECT
	CALL SET_PANTIES, ""
ELSEIF TEQUIP:拘束 || TEQUIP:室内露出PLAY || TEQUIP:野外PLAY
	IF EQUIP:胖次 && EQUIP:贴身制服 + EQUIP:下身衣装 == 0 && CHECK_CLO("胖次露出")
		PRINTFORMW %CALLNAME:PLAYER%將%CALLNAME:TARGET%的內褲利索的脫下了……
		CALL SET_PANTIES, ""
	ELSEIF CHECK_CLO("裸体") == 0
		PRINTFORMW %CALLNAME:PLAYER%將%CALLNAME:TARGET%的衣服強硬的剝下、肆無忌憚的觀賞著赤裸的嬌軀……
		CALL SETFLAG, "扒成裸体", TARGET
	ENDIF
ELSEIF TCVAR:干劲 == 0 && CHECK_CLO("下身衣装露出") && CHECK_CLO("Ｖ露出可") == 0
	PRINTFORMW %CALLNAME:TARGET%將%BOTTOM(TARGET)%脫下了。
	CALL SET_BOTTOM, ""
ELSE
	CALL KISEKAE
ENDIF


@COM_ORDER_COM175, ARG
VARSET LOCAL
LOCALS = 

;すべての命令に共通の要素を考慮
;(信頼が高いと命令に従いやすいなど)
CALL COM_ORDER, ARG

LOCAL = RESULT

;ABL:露出癖
IF ABL:露出癖
	LOCAL += MIN(ABL:露出癖, 10) * 5
	LOCALS = %LOCALS% + 露出癖LV{ABL:露出癖}({MIN(ABL:露出癖, 10) * 5})
ENDIF
;害羞
IF TALENT:害羞
	LOCAL -= 10
	LOCALS = %LOCALS% - 害羞(10)
ENDIF
;不知羞恥
IF TALENT:不知羞恥
	LOCAL += 5
	LOCALS = %LOCALS% + 不知羞恥(5)
ENDIF

;拘束中
IF TEQUIP:拘束
	LOCAL += 30
	LOCALS = %LOCALS% + 拘束中(30)
ENDIF
;视频拍摄
IF TEQUIP:攝像機
	LOCAL -= 10
	LOCALS = %LOCALS% - 撮影中(10)
ENDIF
;野外or室内露出
IF TEQUIP:野外PLAY
	LOCAL -= 10
	LOCALS = %LOCALS% - 野外PLAY(10)
ELSEIF TEQUIP:室内露出PLAY
	LOCAL -= 10
	LOCALS = %LOCALS% - 室内露出(10)
ENDIF

;合計を表示(35以上で実行)
CALL PRINT_COM_ORDER_COM, LOCALS, ARG, LOCAL, 35

RETURN RESULT
