@尿道射精
IF !TCVAR:MASTER:要去了
	IF BASE:MASTER:射精 > MAXBASE:MASTER:射精
		IF BASE:MASTER:勃起 < 1000
			BASE:MASTER:射精 = MAXBASE:MASTER:射精 - 1
		ELSE
			TCVAR:MASTER:要去了 = 1
		ENDIF
	ELSE
		CALL 尿道射精处理
	ENDIF
ELSE
	CALL 尿道射精处理
ENDIF
RETURN 1
@尿道射精处理
;尿道射精处理
#DIM 射精回数
#DIM 過剰射精
#DIM 中毒レベル
#DIM 尿道内射精補正
#DIM 尿道内射精補正常数
#DIM 欲求不満解消係数
#DIM 中毒BOUNS
VARSET 射精回数
VARSET 過剰射精
	;射精(絶頂)回数
	射精回数 = MIN(BASE:MASTER:射精 / MAXBASE:MASTER:射精, (100 + BASE:MASTER:精力) / 100)




	NOWEX:MASTER:射精量 = BASE:MASTER:射精 * 10 / (ABL:MASTER:Ｃ感覚 / 2 + 10) / 100
	NOWEX:MASTER:射精量 = NOWEX:MASTER:射精量 * 10 / (ABL:MASTER:Ｃ感覚 / 2 + 10)
	SIF NOWEX:MASTER:射精量 > 400
		NOWEX:MASTER:射精量 = 300 + (NOWEX:MASTER:射精量 - 300) * 7 / 10

	IF NOWEX:MASTER:射精量 > BASE:MASTER:精力
		NOWEX:MASTER:射精量 = (NOWEX:MASTER:射精量 - BASE:MASTER:精力) / 5 + BASE:MASTER:精力
		過剰射精 = NOWEX:MASTER:射精量 - BASE:MASTER:精力
	ENDIF

	IF 過剰射精
		DOWNBASE:MASTER:体力 += 過剰射精 * 4
	ENDIF

	BASE:MASTER:精力 = MAX(0, BASE:MASTER:精力 - NOWEX:MASTER:射精量)
	TCVAR:MASTER:要去了 = 0
	STAIN:MASTER:Ｐ |= 4

	;BASEの処理
	BASE:MASTER:射精 = 0

	CSTR:MASTER:射精後処理用 = %CSTR:MASTER:射精判定用%
	TCVAR:MASTER:已射精部位FLAG = TCVAR:MASTER:射精部位

	;異常経験、射精経験、精液経験
	;女性器がある場合？
	SIF !EXP:MASTER:射精経験 && TALENT:MASTER:性別 & 1
		EXP:MASTER:異常経験 += 1

	EXP:MASTER:絶頂経験 ++ 
	EXP:MASTER:射精経験 += 射精回数

	NOWEX:MASTER:射精 += 射精回数
	EX:MASTER:射精 += 射精回数
	SIF AT_HOME(MASTER)
		YOGORE:(CFLAG:MASTER:現在位置) += 射精回数 * 50

	DOWNBASE:MASTER:体力 += LIMIT(NOWEX:MASTER:射精量 / 8, 10, 100)
	DOWNBASE:MASTER:気力 += LIMIT(NOWEX:MASTER:射精量 / 4, 20, 200)


	IF EXP:MASTER:射精経験 < EXPLV:1
		SOURCE:MASTER:露出 += 5000 * (射精回数 + 1) / 2
		SOURCE:MASTER:屈従 += 2500 * (射精回数 + 1) / 2
		SOURCE:MASTER:不潔 += 200 * (射精回数 + 1) / 2
	ELSEIF EXP:MASTER:射精経験 < EXPLV:2
		SOURCE:MASTER:露出 += 2500 * (射精回数 + 1) / 2
		SOURCE:MASTER:屈従 += 2000 * (射精回数 + 1) / 2
		SOURCE:MASTER:不潔 += 150 * (射精回数 + 1) / 2
	ELSEIF EXP:MASTER:射精経験 < EXPLV:3
		SOURCE:MASTER:露出 += 1000 * (射精回数 + 1) / 2
		SOURCE:MASTER:屈従 += 800 * (射精回数 + 1) / 2
		SOURCE:MASTER:不潔 += 100 * (射精回数 + 1) / 2
	ELSEIF EXP:MASTER:射精経験 < EXPLV:4
		SOURCE:MASTER:露出 += 800 * (射精回数 + 1) / 2
		SOURCE:MASTER:屈従 += 600 * (射精回数 + 1) / 2
		SOURCE:MASTER:不潔 += 50 * (射精回数 + 1) / 2
	ELSEIF EXP:MASTER:射精経験 < EXPLV:5
		SOURCE:MASTER:露出 += 400 * (射精回数 + 1) / 2
		SOURCE:MASTER:屈従 += 400 * (射精回数 + 1) / 2
		SOURCE:MASTER:不潔 += 10 * (射精回数 + 1) / 2
	ELSE
		SOURCE:MASTER:露出 += 200 * (射精回数 + 1) / 2
		SOURCE:MASTER:屈従 += 250 * (射精回数 + 1) / 2
	ENDIF


	中毒BOUNS = 0
	IF CFLAG:36:诶嘿嘿 == 2
		SOURCE:36:達成 += NOWEX:MASTER:射精 * 150
		SOURCE:36:征服 += NOWEX:MASTER:射精 * 150
		SIF !(NOWEX:36:Ｃ絶頂 + NOWEX:36:Ｖ絶頂 + NOWEX:36:Ａ絶頂 + NOWEX:36:Ｂ絶頂 + NOWEX:36:Ｍ絶頂)
			SOURCE:36:征服 += NOWEX:MASTER:射精 * 100
	ENDIF


	IF TEQUIP:MASTER:避孕套
		;ゴムを外す
		TEQUIP:MASTER:避孕套 = 0
		IF CFLAG:36:1017
			CFLAG:36:积攒度 += CFLAG:36:1018 * NOWEX:MASTER:射精 * 15
		ENDIF
		;接触のリセット
		CALL 挿入解除(36)
		TFLAG:套套内 = NOWEX:MASTER:射精量
		IF CFLAG:36:自動ゴム && ITEM:避孕套
			ITEM:避孕套 --
			TEQUIP:MASTER:避孕套 = 1
		ENDIF
	ELSE
		;尿道内存在精液
		IF CFLAG:36:1017 > 0
			
			EXP:36:精液経験 += NOWEX:MASTER:射精 * 2
			;CFLAG:36:1015是尿道经验
			CFLAG:36:1015 += NOWEX:MASTER:射精 * 2
			CFLAG:36:1017 += NOWEX:MASTER:射精量
			欲求不満解消係数 = 800 / MIN(100 + CFLAG:36:1018 * 10,200)
			CFLAG:36:积攒度 -= SQRT(CFLAG:36:1017) * 欲求不満解消係数
		ENDIF
	ENDIF

	IF SHIRAHU(36)
		IF CFLAG:36:1017
			中毒レベル = CFLAG:36:1018
		ENDIF
		尿道内射精補正常数 = NOWEX:MASTER:射精量 * (10 + 中毒レベル)
		IF TALENT:MASTER:濃厚精液
			尿道内射精補正 = GET_REVISION(尿道内射精補正常数, 500, 1000)
		ELSE
			尿道内射精補正 = GET_REVISION(尿道内射精補正常数, 500, 2000)
		ENDIF
		;同時絶頂の場合増加
		SIF SYNCED_ORGASM(36)
			尿道内射精補正 = 尿道内射精補正 * 5 / 4
		SOURCE:36:情愛 += 尿道内射精補正 * 2
		SOURCE:36:欲情 += 尿道内射精補正 * 2
		SOURCE:36:恭順 += 尿道内射精補正
		SOURCE:36:屈従 += 尿道内射精補正
		尿道内射精補正常数 = 尿道内射精補正
	ENDIF

	CFLAG:36:积攒度 = LIMIT(CFLAG:36:积攒度, 0, 1000)
	CFLAG:MASTER:积攒度 = MAX(CFLAG:MASTER:积攒度 - NOWEX:MASTER:射精 * 50, 0)
	前回指令 = "尿道射精"