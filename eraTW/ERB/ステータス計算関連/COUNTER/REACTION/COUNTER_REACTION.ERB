;************************************************************************
;指令実行の際に角色側でリアクションを返す処理
;被逆推とは関係が無く、Counterと同列に扱われててややこしかったので分離
;************************************************************************
@EVENT_COUNTER_REACTION(ARG,ARG:1)
;ARG為TARGET的ID號
;ARG:1為TARGET的編號[即TARGET:(ARG:1)]
IF TALENT:MASTER:性別 == 1 || TALENT:MASTER:性別 == 3
	;被膣挿入
	;CALL TOUCH_SET(TARGETの接触部位,MASTERの接触部位,対象の角色番号,真ならリセットする)
	;TEQUIP:(対象の角色番号):TARGETの接触部位 = MASTERの接触部位
	IF MASTER_POSE(SET_P,SET_V) == ARG
		LOCAL = RAND:7 + 1
		SELECTCASE LOCAL
			CASE 1
				SIF ABL:MASTER:膣 < 2
					RETURN 0
				TCVAR:MASTER:21 = 1
			;だいしゅき大堂ド
			CASE 2
				IF TALENT:MASTER:恋人 && TALENT:ARG:恋人 && (TEQUIP:MASTER:体位 == 1 || TEQUIP:MASTER:体位 == 4)
					TCVAR:MASTER:21 = 2
				ELSE
					RETURN 0
				ENDIF
			;性交見せつけ
			CASE 3
				SIF ABL:MASTER:露出癖 < 2
					RETURN 0
				SIF TEQUIP:MASTER:体位 == 3
					TCVAR:MASTER:21 = 3
			CASE 4
				SIF EXP:MASTER:子宮口開発経験 < 50 || TEQUIP:MASTER:子宮
					RETURN 0
				SIF ABL:MASTER:膣 < 2
					RETURN 0
				TEQUIP:MASTER:子宮 = 1
				TCVAR:MASTER:21 = 4
			CASE 5
				IF TALENT:MASTER:恋人 && TALENT:ARG:恋人 && (ABL:MASTER:Ｖ感覚 >= 5)
					TCVAR:MASTER:21 = 5
				ELSE
					RETURN 0
				ENDIF
			CASE 6
				SIF EXP:MASTER:子宮口開発経験 < 100
					RETURN 0
				SIF ABL:MASTER:膣 < 3
					RETURN 0
				SIF !TEQUIP:MASTER:子宮
					RETURN 0
				TEQUIP:MASTER:子宮 = 2
				TCVAR:MASTER:21 = 6
			CASE 7
				SIF TEQUIP:MASTER:指接触部位
					RETURN 0
				SIF !TALENT:MASTER:恋人
					RETURN 0
				SIF !TALENT:ARG:恋人
					RETURN 0
				SIF TEQUIP:MASTER:体位 != 3 && TEQUIP:MASTER:体位 != 1
					RETURN 0
				TCVAR:MASTER:21 = 7
		ENDSELECT
		SIF TCVAR:MASTER:21
			TCVAR:MASTER:20 = 5001
	;被肛門挿入
	ELSEIF MASTER_POSE(SET_P,SET_A) == ARG
		LOCAL = RAND:2 + 1
		SELECTCASE LOCAL
			CASE 1
				SIF ABL:MASTER:肛門 < 2
					RETURN 0
				TCVAR:MASTER:21 = 1
			CASE 2
				SIF TEQUIP:MASTER:指接触部位
					RETURN 0
				SIF !TALENT:MASTER:恋人
					RETURN 0
				SIF !TALENT:ARG:恋人
					RETURN 0
				SIF TEQUIP:MASTER:体位 != 3 && TEQUIP:MASTER:体位 != 1
					RETURN 0
				TCVAR:MASTER:21 = 7
		ENDSELECT
		SIF TCVAR:MASTER:21
			TCVAR:MASTER:20 = 5011
	;给对方手淫
	ELSEIF MASTER_POSE(SET_P,SET_YUBI) == ARG
		LOCAL = RAND:3 + 1
		SELECTCASE LOCAL
			CASE 1
				SIF ABL:MASTER:指 < 2
						RETURN 0
				SIF BASE:ARG:勃起 < 1000
						RETURN 0
			CASE 2
				SIF ABL:MASTER:指 < 2
					RETURN 0
				SIF ABL:MASTER:奉仕精神 < 3
					RETURN 0
			CASE 3
				SIF ABL:MASTER:指 < 2
					RETURN 0
				SIF ABL:MASTER:奉仕精神 < 7
					RETURN 0
				SIF TEQUIP:MASTER:口接触部位 != 0
					RETURN 0
		ENDSELECT
		TCVAR:MASTER:21 = LOCAL
		TCVAR:MASTER:20 = 5021
	;给对方口交
	ELSEIF MASTER_POSE(SET_P,SET_M) == ARG
		LOCAL = RAND:4 + 1
		SELECTCASE LOCAL
			CASE 1
				SIF ABL:MASTER:舌 < 2
					RETURN 0
				TCVAR:MASTER:21 = 1
			;玉舐め
			CASE 2
				SIF ABL:MASTER:舌 < 2
					RETURN 0
				SIF ABL:MASTER:奉仕精神 < 5
					RETURN 0
				TCVAR:MASTER:21 = 2
			;ディープスロート
			CASE 3
				SIF ABL:MASTER:舌 < 3
					RETURN 0
				SIF BASE:ARG:勃起 < 1000
					RETURN 0
				SIF SELECTCOM == 2
					TCVAR:MASTER:21 = 3
			;口交自慰
			CASE 4
				SIF ABL:MASTER:露出癖 < 2
					RETURN 0
				TCVAR:MASTER:21 = 4
		ENDSELECT
		SIF TCVAR:MASTER:21
			TCVAR:MASTER:20 = 5031
	;给对方乳交
	ELSEIF MASTER_POSE(SET_P,SET_B) == ARG
		LOCAL = RAND:4 + 1
		SELECTCASE LOCAL
			CASE 1
				SIF ABL:MASTER:胸 < 2
					RETURN 0
				TCVAR:MASTER:21 = 1
			;縦乳交
			CASE 2
				SIF ABL:MASTER:胸 < 3
					RETURN 0
				SIF TALENT:MASTER:胸圍 < 1
					RETURN 0
					TCVAR:MASTER:21 = 2
			;頑張って谷間をつくる
			CASE 3
				SIF ABL:MASTER:胸 < 3
					RETURN 0
				SIF SELECTCOM == 96
					TCVAR:MASTER:21 = 3
			CASE 4
				SIF ABL:MASTER:胸 < 2
					RETURN 0
				SIF ABL:MASTER:奉仕精神 < 5
					RETURN 0
				TCVAR:MASTER:21 = 4
		ENDSELECT
		SIF TCVAR:MASTER:21
			TCVAR:MASTER:20 = 5041
	ELSEIF MASTER_POSE(SET_YUBI,SET_A) == ARG
		TCVAR:MASTER:20 = 601
	ELSEIF MASTER_POSE(SET_YUBI,SET_B) && !RAND:2
		IF !RAND:2
			TCVAR:MASTER:21 = 1
		ELSEIF !TEQUIP:ARG:口接触部位 && !RAND:2
			TCVAR:MASTER:21 = 2
		ENDIF
		SIF TCVAR:MASTER:21
			TCVAR:MASTER:20 = 510
	ENDIF
	;以上为MASTER为女性的时候，下面是MASTER不为女性的情况
	;-----------------------------------------------------------------------
ELSEIF TALENT:MASTER:性別 == 2 || TALENT:MASTER:性別 == 3
	IF MASTER_POSE(SET_V,SET_P) == ARG && TCVAR:ARG:强行
		LOCAL = RAND:2 + 1
		; SELECTCASE LOCAL
		; 	CASE 1
		; 		TCVAR:ARG:21 = 1
		; 	CASE 2
		; 		TCVAR:ARG:21 = 2
		; ENDSELECT
		IF CFLAG:ARG:诶嘿嘿 == 1
			TCVAR:ARG:21 = LOCAL
			TCVAR:ARG:20 = 506
		ELSEIF CFLAG:ARG:诶嘿嘿 == 2
			TCVAR:MASTER:21 = LOCAL
			TCVAR:MASTER:20 = 506
		ENDIF
	;膣挿入
	ELSEIF MASTER_POSE(SET_V,SET_P) == ARG
		LOCAL = RAND:7 + 1
		SELECTCASE LOCAL
			CASE 1
				SIF ABL:ARG:膣 < 2
					RETURN 0
				; TCVAR:ARG:21 = 1
			;だいしゅき大堂ド
			CASE 2
				SIF !TALENT:ARG:恋慕
					RETURN 0
				SIF TEQUIP:ARG:体位 != 1 && TEQUIP:ARG:体位 != 4
					RETURN 0
					; TCVAR:ARG:21 = 2
			;性交見せつけ
			CASE 3
				SIF ABL:ARG:露出癖 < 2
					RETURN 0
				SIF TEQUIP:ARG:体位 != 3
					RETURN 0
					; TCVAR:ARG:21 = 3
			CASE 4
				SIF EXP:ARG:子宮口開発経験 < 50 || TEQUIP:ARG:子宮
					RETURN 0
				SIF ABL:ARG:膣 < 2
					RETURN 0
				TEQUIP:ARG:子宮 = 1
				; TCVAR:ARG:21 = 4
			CASE 5
				SIF !TALENT:ARG:恋慕
					RETURN 0
				SIF ABL:ARG:Ｖ感覚 < 5
					RETURN 0
				; TCVAR:ARG:21 = 5
			CASE 6
				SIF EXP:ARG:子宮口開発経験 < 100
					RETURN 0
				SIF ABL:ARG:膣 < 3
					RETURN 0
				SIF !TEQUIP:ARG:子宮
					RETURN 0
				; TEQUIP:ARG:子宮 = 2
				; TCVAR:ARG:21 = 6
			CASE 7
				SIF TEQUIP:ARG:指接触部位
					RETURN 0
				SIF !TALENT:ARG:恋慕
					RETURN 0
				SIF TEQUIP:ARG:体位 != 3 && TEQUIP:ARG:体位 != 1
					RETURN 0
				; TCVAR:ARG:21 = 7
		ENDSELECT
		IF CFLAG:ARG:诶嘿嘿 == 1
			TCVAR:ARG:21 = LOCAL
			TCVAR:ARG:20 = 500
		ELSEIF CFLAG:ARG:诶嘿嘿 == 2
			TCVAR:MASTER:21 = LOCAL
			TCVAR:MASTER:20 = 500
		ENDIF
	;肛門挿入
	ELSEIF MASTER_POSE(SET_A,SET_P) == ARG
		LOCAL = RAND:2 + 1
		SELECTCASE LOCAL
			CASE 1
				SIF ABL:ARG:肛門 < 2
					RETURN 0
				;TCVAR:ARG:21 = 1
			CASE 2
				SIF TEQUIP:ARG:指接触部位
					RETURN 0
				SIF !TALENT:ARG:恋慕
					RETURN 0
				SIF TEQUIP:ARG:体位 != 3 && TEQUIP:ARG:体位 != 1
					RETURN 0
				;TCVAR:ARG:21 = 2
		ENDSELECT
		IF CFLAG:ARG:诶嘿嘿 == 1
			TCVAR:ARG:21 = LOCAL
			TCVAR:ARG:20 = 501
		ELSEIF CFLAG:ARG:诶嘿嘿 == 2
			TCVAR:MASTER:21 = LOCAL
			TCVAR:MASTER:20 = 501
		ENDIF
	;手淫
	ELSEIF MASTER_POSE(SET_YUBI, SET_P) == ARG
		LOCAL = RAND:3 + 1
		SELECTCASE LOCAL
			CASE 1
				SIF ABL:ARG:指 < 2
					RETURN 0
				;TCVAR:ARG:21 = 1
			;玉揉み
			CASE 2
				SIF ABL:ARG:指 < 2
					RETURN 0
				SIF ABL:ARG:奉仕精神 < 3
					RETURN 0
				SIF ARG != TARGET
					RETURN 0 
				SIF SELECTCOM != 80
					RETURN 0
					;TCVAR:ARG:21 = 2
			CASE 3
				SIF ABL:ARG:指 < 2
					RETURN 0
				SIF ABL:ARG:奉仕精神 < 7
					RETURN 0
				SIF TEQUIP:ARG:口接触部位 != 0
					RETURN 0
				SIF ARG != TARGET
					RETURN 0
				SIF SELECTCOM == 80
					RETURN 0
					;TCVAR:ARG:21 = 3
		ENDSELECT
		IF CFLAG:ARG:诶嘿嘿 == 1
			TCVAR:ARG:21 = LOCAL
			TCVAR:ARG:20 = 502
		ELSEIF CFLAG:ARG:诶嘿嘿 == 2
			TCVAR:MASTER:21 = LOCAL
			TCVAR:MASTER:20 = 502
		ENDIF
	;口交
	ELSEIF MASTER_POSE(SET_M,SET_P) == ARG
		LOCAL = RAND:4 + 1
		SELECTCASE LOCAL
			CASE 1
				SIF ABL:ARG:舌 < 2
					RETURN 0
				;TCVAR:ARG:21 = 1
			;玉舐め
			CASE 2
				SIF ABL:ARG:舌 < 2
					RETURN 0
				SIF ABL:ARG:奉仕精神 < 5
					RETURN 0
				SIF ARG == TARGET
					RETURN 0
				;TCVAR:ARG:21 = 2
			;ディープスロート
			CASE 3
				SIF ABL:ARG:舌 < 3
					RETURN 0
				SIF BASE:ARG:勃起 < 1000
					RETURN 0
				SIF ARG != TARGET
					RETURN 0
				SIF SELECTCOM != 81
					RETURN 0
					;TCVAR:ARG:21 = 3
			;口交自慰
			CASE 4
				SIF ABL:ARG:露出癖 < 2
					RETURN 0
				;TCVAR:ARG:21 = 4
		ENDSELECT
		IF CFLAG:ARG:诶嘿嘿 == 1
			TCVAR:ARG:21 = LOCAL
			TCVAR:ARG:20 = 503
		ELSEIF CFLAG:ARG:诶嘿嘿 == 2
			TCVAR:MASTER:21 = LOCAL
			TCVAR:MASTER:20 = 503
		ENDIF
			;TCVAR:ARG:20 = 503
	;乳交
	ELSEIF ARG == TARGET && SELECTCOM == 82
		LOCAL = RAND:4 + 1
		SELECTCASE LOCAL
			CASE 1
				SIF ARG == TARGET || SELECTCOM == 82
					RETURN 0
				SIF ABL:ARG:胸 < 2
					RETURN 0
				;TCVAR:ARG:21 = 1
			;縦乳交
			CASE 2
				SIF ABL:ARG:胸 < 3
					RETURN 0
				SIF TALENT:ARG:胸圍 < 1
					RETURN 0
				;TCVAR:ARG:21 = 2
			;頑張って谷間をつくる
			CASE 3
				SIF ABL:ARG:胸 < 3
					RETURN 0
				SIF ARG != TARGET
					RETURN 0
				SIF SELECTCOM == 82
					RETURN 0
					;TCVAR:ARG:21 = 3
			CASE 4
				SIF ABL:ARG:胸 < 2
					RETURN 0
				SIF ABL:ARG:胸 < 2
					RETURN 0
				SIF ABL:ARG:奉仕精神 < 5
					RETURN 0
				;TCVAR:ARG:21 = LOCAL
		ENDSELECT
		IF CFLAG:ARG:诶嘿嘿 == 1
			TCVAR:ARG:21 = LOCAL
			TCVAR:ARG:20 = 504
		ELSEIF CFLAG:ARG:诶嘿嘿 == 2
			TCVAR:MASTER:21 = LOCAL
			TCVAR:MASTER:20 = 504
		ENDIF
			;TCVAR:ARG:20 = 504
	;素股
	ELSEIF MASTER_POSE(SET_C,SET_P) == ARG
		LOCAL = RAND:2 + 1
		SELECTCASE LOCAL
			CASE 1
				SIF ABL:ARG:腰 < 2
					RETURN 0
				;TCVAR:ARG:21 = 1
			;手淫追加
			CASE 2
				SIF ABL:ARG:腰 < 2
					RETURN 0
				SIF ABL:ARG:指 < 2
					RETURN 0
				SIF ARG != TARGET
					RETURN 0
				SIF SELECTCOM != 83
					RETURN 0
					;TCVAR:ARG:21 = 2
		ENDSELECT
		IF CFLAG:ARG:诶嘿嘿 == 1
			TCVAR:ARG:21 = LOCAL
			TCVAR:ARG:20 = 505
		ELSEIF CFLAG:ARG:诶嘿嘿 == 2
			TCVAR:MASTER:21 = LOCAL
			TCVAR:MASTER:20 = 505
		ENDIF
			; TCVAR:ARG:20 = 505
	ELSEIF MASTER_POSE(SET_YUBI,SET_A) == ARG
		IF CFLAG:ARG:诶嘿嘿 == 1
			TCVAR:ARG:20 = 601
		ELSEIF CFLAG:ARG:诶嘿嘿 == 2
			TCVAR:MASTER:20 = 601
		ENDIF
		;TCVAR:ARG:20 = 601
	ELSEIF MASTER_POSE(SET_YUBI,SET_B) && !RAND:2
		IF CFLAG:ARG:诶嘿嘿 == 1
			IF !RAND:2
				TCVAR:ARG:21 = 1
			ELSEIF !TEQUIP:ARG:口接触部位 && !RAND:2
				TCVAR:ARG:21 = 2
			ENDIF
			SIF TCVAR:ARG:21
				TCVAR:ARG:20 = 510
		ELSEIF CFLAG:ARG:诶嘿嘿 == 2
			IF !RAND:2
				TCVAR:MASTER:21 = 1
			ELSEIF !TEQUIP:ARG:口接触部位 && !RAND:2
				TCVAR:MASTER:21 = 2
			ENDIF
			SIF TCVAR:MASTER:21
				TCVAR:MASTER:20 = 510
		ENDIF
			; IF !RAND:2
			; 	TCVAR:ARG:21 = 1
			; ELSEIF !TEQUIP:ARG:口接触部位 && !RAND:2
			; 	TCVAR:ARG:21 = 2
			; ENDIF
			; SIF TCVAR:ARG:21
			; 	TCVAR:ARG:20 = 510
	ENDIF
	;MASTERの胸がお留守の場合
	;ELSEIF !MASTER_POSE(0,SET_B)
	;	IF !TEQUIP:ARG:指接触部位
	;		TCVAR:ARG:21 = 1
	;	ELSEIF !TEQUIP:ARG:口接触部位
	;		TCVAR:ARG:21 = 2
	;	ENDIF
	;	SIF TCVAR:ARG:21
	;		TCVAR:ARG:20 = 510

ENDIF

IF TCVAR:ARG:30 == 1
	MASTER_COUNTER_RECORD:ARG:0 = TCVAR:MASTER:20
	MASTER_COUNTER_RECORD:ARG:1 = TCVAR:MASTER:21
ENDIF