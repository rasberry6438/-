;-------------------------------------------------
;祈願
;日常系指令、レベル1
;-------------------------------------------------
@COM421
PRINTL 要许什么愿呢？
$INPUT_LOOP
PRINTFORML [0] - 结缘(%金額表示(1000)%)
SIF TALENT:MASTER:2 & 2
	PRINTFORML [1] - 精力精力超群(%金額表示(3000)%)
PRINTFORML [2] - 內心平靜(%金額表示(3000)%)
PRINTFORML [3] - 胸部胸部(%金額表示(3000)%)
PRINTFORML [10] - 内裤能扫除出来！！！！(%金額表示(5000)%)
PRINTFORML [15] - 大家都更容易吊起H气氛(%金額表示(10000)%)
SIF TARGET && ABL:施虐属性 >= 1
	PRINTFORML [16] - \@ TALENT:恋人? 幻想郷第一可愛# \@%NAME_OUTPUT_TRANSLATION("CALLNAME", TARGET)%太激情了所以快想想辦法
SIF TARGET
	PRINTFORML [20] - 想讓\@ TALENT:恋人? 幻想郷第一可愛# \@%NAME_OUTPUT_TRANSLATION("CALLNAME", TARGET)%変得更加的Ｈ
IF BABYDLC == 1 && !TALENT:妊娠
	PRINTFORML [21] - 一发入魂(現在的子宝補正:{CFLAG:子宝補正})
ELSEIF TALENT:TARGET:恋慕 && !TALENT:妊娠
	PRINTFORML [21] - 子宝祈願(現在的子宝補正:{CFLAG:子宝補正})
ENDIF
PRINTFORML [30] - 被女孩子讨厌了想做点什么来挽回
;21/08/27 反発履歴削除追加
PRINTFORML [35] - 想要女孩子擺脫心事
SIF CFLAG:MASTER:魔力回収 && CFLAG:MASTER:小槌 < 6
	PRINTFORML [40] - 想消除万宝槌的副作用
SIF FLAG:開運大紋購入回数 > 10
	PRINTFORML [50] - 奸商被天谴吧
SIF CAN_DOWSING()
	PRINTFORML [60] - 想找的东西找不到
PRINTFORML [66] - 向天子祈求改变天气状况
PRINTL [999] - 還是算了
INPUT
SIF RESULT == 999
	RETURN -1

IF RESULT == 0
	IF MONEY < 1000
		PRINTL 金钱不足
		GOTO INPUT_LOOP
	ENDIF
	PRINTL 你所想的人是谁呢？
	CALL SHOW_CHALALIST
	PRINTL 
	PRINTL [999] - 還是算了
	INPUT
	IF !INRANGE(RESULT,1,CHARANUM)
		RETURN -1
	ELSE
		CALL GANKAKE_0(RESULT)
		MONEY -= 1000
	ENDIF
;精力精力超群
ELSEIF RESULT == 1
	IF MONEY < 3000
		PRINTL 金钱不足
		GOTO INPUT_LOOP
	ENDIF
	MONEY -= 3000
	FLAG:祈願内容 = 200
	IF EXP:MASTER:11 > (100 + FLAG:561 * 100) && FLAG:561 < 11
		LOCAL += 100
		FLAG:561 += 1
	ENDIF
	CALL BUFF_BASE(MASTER,BASE_精力,500)
	FLAG:71 ++
;心の平安
ELSEIF RESULT == 2
	IF MONEY < 3000
		PRINTL 金钱不足
		GOTO INPUT_LOOP
	ENDIF
	MONEY -= 3000
	CALL BUFF_BASE(MASTER,BASE_気力,500)
	FLAG:祈願内容 = 201
	FLAG:71 = 0
ELSEIF RESULT == 3
	IF MONEY < 3000
		PRINTL 金钱不足
		GOTO INPUT_LOOP
	ENDIF
	MONEY -= 3000
	PRINTFORML %NAME_OUTPUT_TRANSLATION("CALLNAME", MASTER)%双手合十、一心不乱地想着胸部的事情
	TFLAG:OPPAI = 1
ELSEIF RESULT == 10
	IF MONEY < 5000
		PRINTL 金钱不足
		GOTO INPUT_LOOP
	ELSE
		MONEY -= 5000
		FLAG:祈願内容 = 202
	ENDIF
ELSEIF RESULT == 15
	IF MONEY < 10000
		PRINTL 金钱不足
		GOTO INPUT_LOOP
	ELSE
		MONEY -= 10000
		FLAG:祈願内容 = 203
	ENDIF
ELSEIF RESULT == 16 && ABL:施虐属性
		CALL IKENIE(TARGET,7)
ELSEIF RESULT == 20 && TARGET != 0
		CALL IKENIE(TARGET,2)
ELSEIF RESULT == 21 && ((BABYDLC == 1) || TALENT:TARGET:恋慕) && !TALENT:妊娠
		CALL IKENIE(TARGET,6)
ELSEIF RESULT == 30
	PRINTL 对誰？
	DRAWLINE
	FOR LOCAL,1,CHARANUM
		SIF MARK:LOCAL:反発刻印 && !CFLAG:LOCAL:出禁
			PRINTFORMLC [{LOCAL}] %NAME_OUTPUT_TRANSLATION("CALLNAME", LOCAL),15,LEFT%
	NEXT
	PRINTL 
	DRAWLINE
	PRINTL [999] - 還是算了
	INPUT
	IF RESULT >= 1 && RESULT <= CHARANUM && MARK:RESULT:反発刻印
		CALL IKENIE(RESULT,1)
	ELSE
		RETURN -1
	ENDIF
ELSEIF RESULT == 35
	PRINTL 誰的？
	DRAWLINE
	FOR LOCAL,1,CHARANUM
		SIF !MARK:LOCAL:反発刻印 && MARK:LOCAL:反発取得履歴 && !CFLAG:LOCAL:出禁
			PRINTFORMLC [{LOCAL}] %NAME_OUTPUT_TRANSLATION("CALLNAME", LOCAL),15,LEFT%
	NEXT
	PRINTL 
	DRAWLINE
	PRINTL [999] - 還是算了
	INPUT
	IF RESULT >= 1 && RESULT <= CHARANUM && !MARK:RESULT:反発刻印 && MARK:RESULT:反発取得履歴
		CALL IKENIE(RESULT,8)
	ELSE
		RETURN -1
	ENDIF

ELSEIF RESULT == 40 && CFLAG:MASTER:魔力回収 && CFLAG:MASTER:小槌 < 6
	CALL IKENIE(71,3)
ELSEIF RESULT == 50 && FLAG:開運大紋購入回数 > 10
	CALL IKENIE(53,5)
ELSEIF RESULT == 60 && CAN_DOWSING()
	CALL DOWSING_PANTS
ELSEIF RESULT == 66
	call UNIQUE_COM_天候操作
ENDIF
DOWNBASE:MASTER:気力 = 100
TIME += 10
RETURN 1


;祈願
@COM_ABLE421
;停止中は不可
SIF FLAG:70 == 1
	RETURN 0
;掃除実行判定
SIF !TFLAG:100
	RETURN 0
;すでに今日祈願してたら弾く
SIF FLAG:祈願内容 > 0
	RETURN 0
;一括管理
SIF GLOBAL_COMABLE(421)
	RETURN RESULT
;賽銭箱
SIF !天之声可(CFLAG:MASTER:現在位置) && CFLAG:MASTER:現在位置 != 守矢神社本殿
	RETURN 0
;気力0
SIF BASE:MASTER:気力 <= 0
	RETURN 0
SIF CFLAG:诶嘿嘿 == 2
	RETURN 0
RETURN 1
